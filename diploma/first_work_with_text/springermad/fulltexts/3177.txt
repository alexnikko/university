Introduction
The pharmaceutical industry is exposed to economic pressure, which stems from increases in social health-care costs as well as escalation in research and development (R&D) competition. In Japan, the national health-care costs reached 40 trillion yen (or around 400 billion US dollars) [ ], which amounts to around 40% of the national budget. Thus, reform of the health-care system is urgently needed. One serious consequence for the pharmaceutical industry in Japan is the reduction in drug prices, which are determined by the government. Furthermore, the efficiency of drug R&D in the industry is continuously declining and the average cost for commercializing a drug product is growing [ ]. Therefore, pharmaceutical companies need to reduce their production costs and increase the efficiency of their manufacturing processes.
This work focuses in particular on sterile drug products that are represented by injectables, eye drops, and intravenous bags. Injectables and intravenous bags can be administrated to unconscious patients and are used in critical medical situations such as surgery. Eye drops are used for various symptoms of the eye, which is one of the most important organs for maintaining patient quality of life. Quality is a critical attribute for sterile drug products, and manufacturers must comply with so-called Good Manufacturing Practice (GMP) [ , ], which is an industry-specific quality standard. One of the critical GMP requirements for sterile drug products is literally sterility because the products are directly administrated to a human body. To fulfill this requirement, the manufacturing process needs a clean environment, and clean materials and equipment, which leads to high operating cost and energy consumption. Another challenge is the yield because the process can lose materials at different stages, such as sampling for quality control, the start and end of a batch production, or removal of defective products. As sterile drug products generally consist of expensive raw materials, a slight change in the yield of the process could make a significant difference in the economic performance.
Modeling is generally an effective approach for the design of rational and competitive manufacturing processes. In the community of process systems engineering (PSE) where modeling and simulation techniques are researched intensively, the continuous manufacturing technology of pharmaceutical tablets is attracting attention as a research subject as summarized by Ierapetritou et al. [ ]. As for the development of modeling techniques, an integrated approach for dynamic flowsheet modeling and sensitivity analysis [ ] or a plant-wide dynamic modeling approach [ ] has been proposed. More recently, Boukouvala et al. [ ] presented a dynamic flowsheet model for the production of pharmaceutical tablets through a continuous wet granulation. Jolliffe and Gerogiorgis presented model-based analyses, evaluation, and design of continuous manufacturing of ibuprofen and artemisinin as active pharmaceutical ingredients (APIs) [ , , ]. Also, process analytical technology (PAT), i.e., a method for process monitoring and control, is intensively studied as an essential technology in continuous manufacturing. The examples include methods for predicting the API content [ , ], mixture components [ ], or the combined effect of multiple raw materials and processing conditions on the product’s final attributes [ ]. Recently, Simon et al. [ ] presented a review on PAT from the perspective of sensor, process monitoring, and control technology. Furthermore, modeling studies cover other technologies in the area of pharmaceutical manufacturing, such as twin-screw extrusion [ ], continuous self-classifying spiral jet milling [ ], vacuum drying [ ], or the dropwise additive manufacturing system [ ].
Regarding yield, several authors tackled the issue by applying process modeling approaches. The contributions on yield enhancement are found for various processes including drug substance manufacturing [ ], batch distillation [ ], drug substance purification [ ], and sterile drug product manufacturing [ , ]. The first to the third studies [ , , ] focused on drug substances, i.e., APIs, and the fourth and the fifth studies [ , ] focused on the final form of drug products, such as injectables. Although the scope of the recent study is extending to cover different production technologies, the modeling technique is still in its infancy for sterile manufacturing in general. In particular, yield enhancement fundamental models are needed that facilitate systematic improvement rather than the case-by-case approach often observed in the industry.
In this paper, we present a mathematical process model of sterile drug product manufacturing that serves as the basis for yield enhancement. The model uses vectors and matrices as the means of describing all materials entering and exiting the entire process with guaranteeing the mass balance. The model also has a number of features for considering the generation of defects and identifying relevant root causes. A case study was used to demonstrate the developed model, where a promising improvement idea was obtained for increasing yield of a sterile drug product. In this paper, the word “defective” is used as an adjective to describe bad status of an element or an operation, whereas the word “defect” is used as a noun representing the improper property that a defective element can have.
Construction of the Process Model
Target and Requirements of the Process Model
Typically, the series of operations for manufacturing sterile drug products includes compounding, filtration, filling, and inspection. In the compounding operation, API, water for injection (WFI), and other raw materials such as excipients are mixed to obtain a homogeneous drug solution. A part of the solution is taken as a sample for quality control. The solution is transferred to the subsequent filtration operation for sterilization, where the solution that was introduced first into the filter system is discharged as preflush. Preflush is a common practice in the industry and is carried out because the properties of the drug solution such as concentration are considered unstable at the beginning of the filtration. In the filling operation, the sterilized drug solution is filled into packaging materials such as glass vials, and the filled products are sealed by closures such as rubber stoppers. The filling operation also has preflush and samples, and in addition, wastes are generated because of various reasons such as microstop of the filling machine. The intermediate product from the filling, i.e., the filled and sealed product, is inspected visually, and the defective products are removed from the good products. In addition to these four main operations, the process can include several suboperations such as online washing and sterilization for glass vials, or online bag manufacturing for intravenous bag products. The entire processes are typically performed batch-wise, and the remaining materials after a batch production are also discarded.
To reduce the losses described above and enhance the yield of the process, the companies would first focus on expensive materials such as APIs before considering other issues such as the packaging materials. While batch-to-batch production data are monitored and documented to comply with the GMP regulations, the data system usually does not cover all discarded materials. The method of Sugiyama et al. [ ] for reducing losses helps to consider various materials in one analysis, but can also be executed without including every kind of material. The method is capable of prioritizing the loss causes; however, it does not support root cause analysis, which is necessary to prevent the losses, especially the defective products, at the source of occurrence. Reflecting on these shortcomings, we set the following as the requirements of the model. First, the model should guarantee the mass balance of all materials in the process, e.g., API, WFI, excipients, and packaging materials. Second, the model should describe the losses of each operation mathematically, especially the losses resulting from pharmaceutical batch operations, e.g., preflush, samples for quality control, or defective products. Third, the model should offer traceability of the losses, particularly defective products, from the discharge to their potential root cause(s) to prevent losses from the beginning. The purpose of the model is not calculation or simulation, but description of the process for identifying relevant root cause(s) of the defective products towards yield enhancement.
Application of the Processing Matrix
Regarding the first requirement on mass balance, we adopted the processing matrix proposed by Yagi and Nishimura [ ]. This modeling approach was originally developed to describe unit operations of continuous chemical processes using the vector X and matrix P for mass flows and operations, respectively. The vector X is horizontal and contains mass flows of all components entering and exiting an operation as its element. The matrix P is square; it has the same row/column numbers as the element numbers of X and contains split fractions of components in an operation as its element. Using these vectors and matrices, the chain of operations can be described as the multiplication of P , which transforms X of the overall input to the overall output with keeping the mass balance of both. The method enables systematic calculation of the processes represented by the graph theory, which were presented by Himmelblau and Bischoff [ ].
We found this processing matrix that was originally developed for continuous processes of chemicals to be applicable for batch processes of sterile drug products, with defining vector X in the following form: $$ \boldsymbol{X}=\left({N}_1,{N}_2,{N}_3,\cdots, {N}_n\right) $$ (1)
where N 1 , N 2 , N 3 , ⋯ , N n are the amounts of n different elements in the process, which include API, excipients, packaging materials, preflush, samples, defective products, and the final product. The unit of N is the equivalent number of the final product. The operation is expressed as a square matrix P with n rows and columns, and the vector X and matrix P have the relationship shown below: $$ {\boldsymbol{X}}_{\mathrm{out}}={\boldsymbol{X}}_{\mathrm{in}}\boldsymbol{P} $$ (2)
where X in and X out are the input and output vectors, respectively.
As an example, the actual forms of X in , X out , and P in the filtration operation are shown below. In filtration, three elements, drug solution, drug solution after filtration, and preflush, are present in the operation, which gives the vector X the following form: $$ \boldsymbol{X}=\left({N}_{\mathrm{drug}\ \mathrm{solution}},{N}_{\mathrm{drug}\ \mathrm{solution}\ \mathrm{after}\ \mathrm{filtration}},{N}_{\mathrm{preflush}}\right) $$ (3)
The input vector contains only drug solution, and the vector X in can be written as follows: $$ {\boldsymbol{X}}_{in}=\left({N}_{\mathrm{drug}\ \mathrm{solution}},0,0\right) $$ (4)
The matrix P of filtration describes the conversion of drug solution to drug solution after filtration and preflush, and P is a square matrix with three rows and columns. The form of matrix P is $$ \boldsymbol{P}=\left(\begin{array}{ccc}1- x& x S& x\left(1- S\right)\\ {}0& 1& 0\\ {}0& 0& 1\end{array}\right) $$ (5)
where x [−] is the ratio of drug solution that goes through filtration and S [−] is the ratio of filtrated solution that becomes drug solution after filtration. The terms x and S are analogous to conversion and selectivity in a chemical reaction. From Eqs. ( 4 ), and ( 5 ), the output vector X out has the form $$ {\boldsymbol{X}}_{\mathrm{out}}=\left({N}_{\mathrm{drug}\ \mathrm{solution}}\left(1- x\right),{N}_{\mathrm{drug}\ \mathrm{solution}} x S,{N}_{\mathrm{drug}\ \mathrm{solution}} x\left(1- S\right)\right) $$ (6)
This vector- and matrix-based approach can also be applied to compounding, filling, and inspection, and the entire process can be described with keeping the mass balance. More details of P for these four operations will be shown in the next sections.
Description of Losses
As to the second requirement for describing the losses, we regarded each unit operation as consisting of two parts, i.e., one responsible for conversion and the other for allocation. Figure 1 shows a unit operation with three elements: input material A, main product B, and loss C, which means that vector X has three elements, and matrix P is 3 × 3. Vectors X 1 and X 3 contain only A and B, respectively, whereas vector X 4 contains C and unprocessed A. Here, the matrix that describes the actual conversion of the input elements is defined as conversion matrix P c , and the matrix that expresses the split of the output elements is defined as allocation matrix P a . With defining vector X 2 for the elements that are converted but not allocated, the relation of all vectors and matrices can be expressed as follows: $$ {\boldsymbol{X}}_2={\boldsymbol{X}}_1{\boldsymbol{P}}_{\mathrm{c}} $$ (7) $$ {\boldsymbol{X}}_3={\boldsymbol{X}}_2{\boldsymbol{P}}_{\mathrm{a}} $$ (8) $$ {\boldsymbol{X}}_4={\boldsymbol{X}}_2\left(\boldsymbol{I}-{\boldsymbol{P}}_{\mathrm{a}}\right) $$ (9) Fig. 1 Model of a unit operation defining conversion and allocation matrices
where I is the unit matrix.
The actual forms of these vectors and matrices are shown, taking filtering operation as an example. The elements of A, B, and C in Fig. 1 can be regarded as drug solution, drug solution after filtration, and preflush, respectively. The vector X has the same structure as in Eq. ( 3 ). Vectors X 1 and X 2 are the same as X in and X out in Eqs. ( 4 ) and ( 6 ), respectively, and matrix P c is the same as Eq. ( 5 ). After applying P c to X 1 and obtaining X 2 , the allocation matrix P a splits B of X 2 to X 3 which goes to the next filling operation, and I– P a splits A and C of X 2 to vector X 4 which is to be discharged. The actual forms of P a , X 3 , and X 4 are expressed as follows: $$ {\boldsymbol{P}}_{\mathbf{a}}=\left(\begin{array}{ccc}0& 0& 0\\ {}0& 1& 0\\ {}0& 0& 0\end{array}\right) $$ (10) $$ {\boldsymbol{X}}_3=\left(0,{N}_{\mathrm{drug}\kern0.18em \mathrm{solution}}\kern0.15em xS,0\right) $$ (11) $$ {\boldsymbol{X}}_4=\left({N}_{\mathrm{drug}\ \mathrm{solution}}\left(1- x\right),0,{N}_{\mathrm{drug}\ \mathrm{solution}} x\left(1- S\right)\right) $$ (12)
where x and S are again the conversion of drug solution and selectivity to drug solution after filtration, respectively. In the diagonal elements of P a , the digit 1 means “let the element go to the next operation,” and the zeroes mean “do not let go to the next operation but discharge.”
Figure 2 shows the graphical and mathematical expressions of sterile drug manufacturing using the conversion and allocation matrices proposed in this work. The process consists of the four typical operations described in the “ Application of the Processing Matrix ” section and hereafter will be used as the sterile drug product manufacturing standard. In the process, each operation i has a pair of P i ,c and P i ,a , assigning 1 to 4 as the suffix i for compounding, filtration, filling, and inspection. The process has 14 vectors, each containing 14 different elements: four raw materials of API, WFI, other raw material and packaging material; three intermediates of drug solution, drug solution after filtration, and intermediate product; one product which is the final product; and six losses of sample 1, preflush 1, preflush 2, sample 2, waste, and defective products. Vector X has the following form: $$ \boldsymbol{X}=\left({N}_1,{N}_2,{N}_3,\cdots, {N}_{14}\right) $$ (13) Fig. 2 Graphical and mathematical expression of a typical sterile drug production process
where N j is the amount of element j . The correspondence of the suffix j to the elements in the process is shown in Table 1 . The suffix numbers from 15 to 21 will be used later in the “ Creation of the Path Flow Diagram Including Defect Generation ” section. Table 1 Correspondence of the suffix number of N to the elements in the process Suffix of N Element 1 API 2 WFI 3 Other raw material 4 Packaging material 5 Drug solution 6 Drug solution after filtration 7 Intermediate product 8 Product 9 Sample 1 10 Preflush 1 11 Preflush 2 12 Sample 2 13 Waste 14 Defective product 15 Defective API 16 Defective WFI 17 Defective other raw material 18 Defective packaging material 19 Defective drug solution 20 Defective drug solution after filtration 21 Defective intermediate product
The actual forms of vectors and matrices in the filling operation are shown below as an example. The filling operation has two input vectors, X 6 and X 8 , which are summed before being multiplied by the conversion matrix of the filling operation. Vector X 6 includes only drug solution after filtration and vector X 8 includes only packaging material; therefore, the sum of vectors X 6 and X 8 would be $$ {\boldsymbol{X}}_6+{\boldsymbol{X}}_8=\left(\ 0,0,0,{N}_4,0,{N}_6,0,0,0,0,0,0,0,0\right) $$ (14)
The conversion matrix of the filling operation P 3,c has the function of converting two input elements to four output elements of intermediate product, preflush 2, sample 2, and waste. The form of P 3,c is shown below: $$ {\boldsymbol{P}}_{3,\mathbf{c}}=\left(\begin{array}{cccccccccccccc}1& & & & & & & & & & & & & 0\\ {}& 1& & & & & & & & & & & & \\ {}& & 1& & & & & & & & & & & \\ {}& & & 1-{x}_4& & & & & & & & & & \\ {}& & & & 1& & & & & & & & & \\ {}& & & & & 1-{x}_6& {x}_6{S}_7& & & & {x}_6{S}_{11}& {x}_6{S}_{12}& {x}_6{S}_{13}& \\ {}& & & & & & 1& & & & & & & \\ {}& & & & & & & 1& & & & & & \\ {}& & & & & & & & 1& & & & & \\ {}& & & & & & & & & 1& & & & \\ {}& & & & & & & & & & 1& & & \\ {}& & & & & & & & & & & 1& & \\ {}& & & & & & & & & & & & 1& \\ {}0& & & & & & & & & & & & & 1\end{array}\right) $$ (15)
where x j and S k are the conversion of element j and the selectivity to another element k , respectively. The number of suffixes of x and S corresponds to the number shown in Table 1 , and the blank area of the matrix represents “0.” As the filling operation has more than one input element, a key component needs to be specified, which is drug solution after filtration in this case. The sum of S 7 , S 11 , S 12 , and S 13 is equal to 1.
The allocation matrix of the filling operation P 3,a can be expressed as $$ {\boldsymbol{P}}_{3,\mathbf{a}}=\left(\begin{array}{cccccccccccccc}0& & & & & & & & & & & & & 0\\ {}& 0& & & & & & & & & & & & \\ {}& & 0& & & & & & & & & & & \\ {}& & & 0& & & & & & & & & & \\ {}& & & & 0& & & & & & & & & \\ {}& & & & & 0& & & & & & & & \\ {}& & & & & & 1& & & & & & & \\ {}& & & & & & & 0& & & & & & \\ {}& & & & & & & & 0& & & & & \\ {}& & & & & & & & & 0& & & & \\ {}& & & & & & & & & & 0& & & \\ {}& & & & & & & & & & & 0& & \\ {}& & & & & & & & & & & & 0& \\ {}0& & & & & & & & & & & & & 0\end{array}\right) $$ (16)
where “1” transfers the intermediate product to X 10 in the diagonal elements, which goes to visual inspection, and “0” transfers the corresponding elements to X 11 , which is to be discharged.
The vectors and matrices of the other operations can also be described in the same way, and the actual forms of P 1 , c , P 2 , c and P 4 , c will be presented in the next section. Introduction of conversion and allocation matrices enabled description of the losses in each operation, which was the second requirement of the model.
Creation of the Path Flow Diagram
Regarding the third requirement on traceability of the loss to its potential root cause(s), we attempted to visualize the path flows of the elements in all conversion matrices P c in one diagram. As for the preparation, the path flows in each of P 1,c , P 2,c , P 3,c , and P 4,c are depicted in Fig. 3a–d , respectively. The bold arrows are the main paths to produce the product, and the thin arrows are the paths to generate losses in each operation. For compounding (Fig. 3a ), API, WFI, and other raw material are converted to drug solution and sample 1. API is the key component here. For filtration (Fig. 3b ), drug solution is converted to drug solution after filtration and preflush 1. The main products of this filtration operation are converted to intermediate product, preflush 2, sample 2, and waste, together with packaging material (Fig. 3c ). The key component here is drug solution after filtration as mentioned earlier. Finally, in the inspection step, the intermediate product goes to either product or defective product (Fig. 3d ). Fig. 3 Path flows of the elements in the conversion matrices of a compounding, b filtration, c filling, and d inspection operations
Based on the path flows in the individual matrices (Fig. 3 ), we developed an overall path flow diagram (Fig. 4 ). This diagram represents the structure of the conversion matrix P c and summarizes the bold and thin arrows shown in Fig. 3 . The gray area in the diagonal elements represents positions for the 14 elements of the process. The arrows from the left and from outside of the matrix structure represent the input elements that are API, WFI, other raw material, and packaging material. The arrows from the gray area to the lower part and outside of the matrix structure show the output elements, which are the final product, i.e., product, and the losses, i.e., sample 1, preflush 1, preflush 2, sample 2, waste, and defective product. The arrows from one gray box to the other gray box indicate the conversion of one element to the other. Fig. 4 Path flow diagram indicating conversion of the elements in all operations
The path flow diagram (Fig. 4 ) conveniently visualizes the conversion of all elements in all operations in one place. For the defective product, however, this diagram does not show the trace from the discharge back to the potential root cause(s) that need(s) to be prevented. Considering this third requirement of the model, we performed an extension of the diagram, to be explained in the next sections.
Consideration of Defect Generation
The extension was to consider how the defects are generated in the entire process, which results in the defective product. Figure 5a shows the defect generation in a unit operation except for the inspection operation. Here, we distinguish between two types of defects. One is the defect that stems from defective input elements from the previous operations; in other words, the cause was the input element. The other is a defect resulting from problems in the operation; in other words, the operation itself is the cause. In the inspection, the conversion from the bad state to the good state may also happen, as depicted in Fig. 5b . This inverse conversion corresponds to misdetection, whereas the conversion from the bad to the good state is actually overlooked. Fig. 5 Defect generation in a unit operations except for visual inspection, and b visual inspection
The actual process contains the chain of the operation (Fig. 5a ) and terminates with the visual inspection (Fig. 5b ). The defective product found in the inspection stems from the three causes, i.e., defective raw materials, improper operations, and misdetections in the inspection. Because GMP requires rigorous validation of the visual inspection operations, we focused on the first two causes shown in Fig. 5a and extended the diagram in Fig. 4 accordingly.
Creation of the Path Flow Diagram Including Defect Generation
To incorporate the paths of defect generation into the model, new elements were added for the vectors and matrices. The defective statuses of all elements were defined, i.e., defective API, defective WFI, defective other raw material, defective packaging, defective drug solution, defective drug solution after filtration, and defective intermediate product. Vector X was extended to have 21 elements, and matrix P became a square matrix with 21 rows and columns. The correspondence of the suffix numbers to the elements is shown in Table 1 . When this extension of the path flow diagram is performed, elements 1 to 14 of Table 1 are regarded to be only good. It should be noted that in the “ Description of Losses ” section, elements 1 to 14 were regarded to be both good and bad. The actual form of vector X would now be $$ \boldsymbol{X}=\left({N}_1,{N}_2,{N}_3,\cdots, {N}_{14},{N}_{15},\cdots, {N}_{21}\right) $$ (17)
According to the number of elements of vector X , matrix P is also extended to have 21 rows and columns. The conversion matrices P 1,c , P 2,c , and P 3,c turn into having a function of converting the defective input element to a defective output, and also the good input element to the defective output (Fig. 5a ). The matrix P 4,c transfers good and bad intermediate products to good and bad products, respectively (only horizontal arrows in Fig. 5b ), assuming ideal performance in visual inspection. The extended part of P c contains conversion x and selectivity S . For example, in the filling operation, row 6 and column 21 of P 3,c define x 6 S 21 where S 21 is the selectivity of drug solution after filtration to defective intermediate product. In addition to this defect generation, the conversion from defective drug solution after filtration to defective intermediate product is also defined by x 20 S 21 located in row 20 and column 21 of P 3,c . The allocation matrices P 1,a , P 2,a , and P 3,a turn into having a function of allocating elements to be transferred to the next operation, both good and defective ones. For example, in the filling operation, the function of the allocation matrix P 3,a is to let both intermediate product and defective intermediate product go to the subsequent inspection operation. The allocation matrix P 3,a has two 1s, namely, one at row 7 and column 7 for the former, and the other at row 21 and column 21 for the latter. Matrix P 4,a allocates good and bad intermediate products to final and defective products, respectively.
To enhance the yield of the actual processes, a path flow diagram based on the extended P c can be drawn to identify the potential root cause(s) of the defective product (Fig. 6 ). Figure 6 indicates all the paths of defect generation leading to the defective product found in the inspection operation. Here, two types of defects are distinguished, as introduced in Fig. 5a . One is the defective raw material, which is indicated with solid arrows coming from outside of the matrix structure. This cause is indicated as defective API, defective WFI, defective other raw material, and defective packaging material and corresponds to the elements N 15 , N 16 , and N 17 in vector X 1 , as well as the element N 18 in vector X 8 . These defective raw materials are converted to the defective output elements (Fig. 5a ), and this conversion corresponds to parameter S * 19 of matrix P 1,c , S * 20 of P 2,c , and S * 21 of P 3,c . Parameter S * k represents the selectivity of the defective input element to element k . The other is the improper operation converting good elements to defective elements that is indicated by the solid arrows originating inside the matrix structure. This cause occurs for various reasons, such as mechanical problems, and corresponds to parameter S 19 of matrix P 1,c , S 20 of P 2,c , and S 21 of P 3,c . Here, the inspection operation is supposed to be perfect, i.e., it is assumed that no misdetection or overlooked occur. This assumption results in the relations as follows: S 8 and S 14 of P 4,c are 1 and 0, respectively, and S * 8 and S * 14 of P 4,c are 0 and 1, respectively. Fig. 6 Path flow diagram indicating defect generation in all operations
The solid arrows in the extended area of the matrix structure in Fig. 6 contain the potential root causes of the defective product. The path flow diagram offers the traceability of the loss back to its root cause(s), and thus, the developed model fulfills the three requirements determined at the beginning of the work. For the actual process improvement, the number of paths in the diagram needs to be narrowed down to identify the relevant root cause(s). Ideally, obtaining the values of the parameters N and S would be the best approach, which are associated with the defective raw materials and improper operations, respectively. However, in reality, it is difficult to measure these parameters because installing all the necessary sensors only for obtaining these values is not realistic. As a pragmatic alternative, a fault tree analysis (FTA) is useful as a quality engineering method for narrowing down the paths, incorporating the opinions of the production experts. Identifying the relevant root cause(s) would foster effective creation of improvement ideas. The next part on the case study will explain these activities, i.e., visualization of potential root causes on the path flow diagram, narrowing down the paths using FTA, identification of relevant root cause(s), and creation of improvement ideas.
Application of the Process Model
Steps of Yield Enhancement Using the Developed Process Model
A case study was used to demonstrate the developed process model. The investigated product was an intravenous bag that was produced in a sterile manufacturing process as depicted in Fig. 2 . The following five steps were executed. As the first step, process analysis and data collection were carried out. All operations were described in the form of Fig. 1 , which consists of both conversion and allocation matrices. The number of the elements in vector X and that of the parameters such as conversion and selectivity in conversion matrix P c were configured. The amount of all raw materials entering the process as well as all products and losses exiting the process were considered in the model. In the second step, the losses were prioritized according to an economic indicator, and a critical defective product was identified that needed to be reduced. In the third step, all possible paths for generating this defective product were considered and visualized on the basis of the matrix structure. The enumerated paths were, in the fourth step, narrowed down using FTA, and the relevant root causes could be found. In the last (fifth) step, improvement ideas were generated, one of which was evaluated in terms of cost-effectiveness, i.e., comparison between the effort and the effect of the improvement. The following sections present the details of the second to fifth steps. In the case study, the vector- and matrix-based model presented in the previous chapter was used not for calculation or simulation, but for systematizing the analysis for yield enhancement. It is sufficient to execute the analysis, when the elements of vectors and matrices as well as the positions of conversions and selectivities are known.
Prioritization of Losses
All of the losses that were identified in the first step in the process analysis and data collection were prioritized in the second step. Among different indicators, we used the annual cost of losses (ACL [ ]), an indicator that converts the lost amount of materials to the monetary unit and ranks different losses accordingly. Figure 7 shows the calculated result for ACL of the top 10 losses from the process, on a normalized scale to the maximum, i.e., the worst. The most critical loss of the process was the so-called defective sealing, which is generated in the sealing operation, a suboperation in the filling operation. Regarding the other losses, packaging material loss, packaging production loss, defective packaging material 1, defective packaging, and defective packaging material 2 were generated in the online bag manufacturing prior to the filling. Defects from supplier refer to defective raw materials. Preflush 2, sample 2, and waste were the losses occurring in the filling operation. These ACL results were obtained as absolute numbers, and the actual economic impacts could be compared, although normalization was necessary because of confidentiality reasons. In this work, we focused on the most critical cause, i.e., defective sealing, as the target for reduction. Fig. 7 Calculated ACL in a sterile drug product manufacturing process
Consideration of Defect Generation
The aim of the third step was to draw the diagram that indicates the paths of defect generation leading to defective sealing, as described in Fig. 6 . As a preparatory step, the path flow diagram without considering defect generation was created, and this corresponds to the one in Fig. 4 , replacing defective product with defective sealing. As the causes for the defective sealing, three main operations filling, filtration, and compounding and four raw materials API, WFI, other raw material, and packaging material were considered. Next, the diagram was extended to include potential root causes, considering two types of causes shown in Fig. 5a , i.e., defective raw materials and problems in operations. Overlooked and misdetection in visual inspection (see Fig. 5b ) were excluded from the analysis. The created path flow diagram was actually the one shown in Fig. 6 (replacing defective product with defective sealing). The solid arrows in the bottom part, which start from defective API, defective WFI, defective other raw material, and defective packaging material, mean that the defect generation was because of defective raw materials. The solid arrows in the top and right part of the matrix structure mean that the defect generation was because of improper operations.
Narrowing Down the Path Using FTA and Generation of Improvement Idea
As the last step, the paths of defect generation in Fig. 6 were narrowed down by using FTA to identify relevant root causes. Figure 8 shows the created FTA diagram defining defective sealing as the top event. Here, the causes were analyzed retrospectively, i.e., the causes were traced back from filling to filtration, compounding, and finally to the raw materials. For each of these operations and raw materials, brain-storming was performed with the production experts to analyze whether and what kinds of causes were present. The filling operation, which consisted of filling, cooling, and cutting as suboperations, was analyzed in detail. In the filling as a suboperation, the resin-made bags are filled with the drug solution and are sealed by sealing bars. The sealed part is then cooled by the cooling bars, and the extra edge of the bag cut by the cutting machine. Fig. 8 Fault tree analysis on defective sealing for identifying relevant root causes
Potential root causes were found in the cutting, cooling, and sealing operations as well as in the packaging material (Fig. 8 ). For instance, the item “gap in the cooling bars” indicates that there is a gap between the bars that cool down the bag, which leads to defective sealing. These root causes in the filling operation result in the presence of parameter S 21 in the path flow diagram of Fig. 6 . Similarly, the item “defective packaging material” as the defective input element to the process can cause defective sealing, which is represented by the presence of parameter N 18 . For operations and the raw materials where no root cause was assigned, the corresponding parameters could be omitted, i.e., S 19 , S 20 , N 15 , N 16 , and N 17 could be judged irrelevant. As the result of this FTA-based investigation, the bold solid arrows in Fig. 6 could be identified as the relevant root causes for defective sealing. The expert group continued their investigation to generate ideas for preventing these root causes from happening and to enhance the yield of the process.
Evaluation of Improvement Idea
One of the created improvement ideas for defective sealing was to adjust the filling machine periodically during a batch production with the expectation of reducing parameter S 21 . The idea was evaluated in terms of cost-effectiveness, i.e., comparison of the additional time cost for machine adjustment with the expected benefit of loss reduction. The cost for machine adjustment was calculated by the additional time needed and the hourly rate, while the benefit was estimated by the reduction potential of ACL. The evaluation result was normalized by the maximum reduction potential of ACL when the defective sealing would be fully reduced and is shown in Fig. 9 . Although the results here were normalized here, the actual results were obtained in absolute values to compare the real financial impacts. Because the improvement idea does not prevent all causes of the defective sealing, the maximum reduction is only an imaginary reference point. The breakeven point between the cost and the benefit, i.e., the intersection point of two lines in Fig. 9 , was around 14.1% reduction of the defective sealing. This means that the improvement makes sense first when the periodical machine adjustment could reduce more than 14.1% of the defective sealing. The experts of the process found the idea promising, which means that this can bring an attractive benefit with a reasonable amount of additional work. Fig. 9 Evaluation result of the improvement idea for yield enhancement
Conclusions and Outlook
In this paper, we presented a mathematical process model for enhancing yield in sterile drug production processes, which is of significant economic importance. For the typical processes of compounding, filtration, filling, and visual inspection, a set of standard models was defined, adopting the method of a processing matrix. This vector- and matrix-based approach for continuous chemical processes was applicable in a batch pharmaceutical process and enabled consideration of all materials guaranteeing the mass balance. The model was then extended to describe the defect generation in the process that leads to the material losses, such as defective products. As an aid to visualize the path flows of the elements as well as the defects, we defined a path flow diagram that can be used for identifying relevant root causes. With these efforts, a model could be developed that could (i) guarantee mass balance of all elements, (ii) describe losses at each operation, and (iii) offer traceability of the defective product from the discharge to their potential root causes that need to be prevented from occurring.
In the case study, the developed model was applied in a sterile manufacturing process of an intravenous bag product. For the defective sealing, the economically most critical defective product, a path flow diagram was created that visualized all the possible paths of defect generation. FTA was applied to reduce the number of paths, and relevant root causes could be identified in the filling operation and in the raw material. The generated idea on periodical adjustment of the machine was evaluated in terms of cost-effectiveness and was judged as a promising improvement option. In this case study, the developed model served as the basis that would replace the case-by-case approach of process improvement often observed in the industry.
The following three points are considered as future research opportunities. The first is the incorporation of the time-dependent character of the batch processes that would enhance a more detailed analysis of the productivity. Second, other drug manufacturing processes such as APIs or solid dosage forms could be covered, which would lead to a wider application of the model. Third, the preparation processes of the appropriate production environment, which often dominates the production schedule, such as cleaning, sterilization, or decontamination could be considered. Extending the coverage area would enhance the relevance of the process modeling approaches in realizing superior manufacturing processes in the pharmaceutical industry.