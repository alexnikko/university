Introduction
Background
Diffusion is one of the main mechanisms of various transport processes in living species and plays an important role in the distribution of drugs in the body. Processes such as membrane permeation, dissolution of solids and dispersion in cellular matrices are considered to take place by diffusion. Diffusion is typically described by Fick’s law, which, in terms of the pharmacokinetics of drugs, gives rise to exponential washout curves that have a characteristic time scale, usually expressed as a half-life. However, in the last few decades, strong experimental evidence has suggested that this is not always true and diffusion processes that deviate from this law have been observed. These are either faster (super-diffusion) or slower (sub-diffusion) modes of diffusion compared to the regular case [ , ].
Such types of diffusion give rise to kinetics that are referred to as anomalous to indicate the fact that they stray from the standard diffusion dynamics [ ]. Moreover, anomalous kinetics can also result from reaction-limited processes and long-time trapping. Anomalous kinetics introduces memory effects into the distribution process that need to be accounted for to correctly describe it. An distinctive feature of anomalous power-law kinetics is that it lacks a characteristic time scale contrary to exponential kinetics. A mathematical formulation that describes such anomalous kinetics is known as fractal kinetics [ , , ] where explicit power functions of time in the form of time-dependent coefficients are used to account for the memory effects replacing the original rate constants. In pharmacokinetics several datasets have been characterised by power laws, empirically [ , ], while the first article that utilised fractal kinetics in pharmacokinetics was [ ]. Molecules that their kinetics presents power law behaviour include those distributed in deeper tissues, such as amiodarone [ ] and bone-seeking elements, such as calcium, lead, strontium and plutonium [ , ].
An alternative theory to describe anomalous kinetics employs fractional calculus [ , ], which introduces derivatives and integrals of fractional order, such as half or three quarters. Although fractional calculus was introduced by Leibniz more than 300 years ago, it is only within the last couple of decades that real-life applications have been explored [ , , ]. It has been shown that differential equations with fractional derivatives (FDEs) describe experimental data of anomalous diffusion more accurately. Although fractional-order derivatives were first introduced as a novel mathematical concept with unclear physical meaning, nowadays, a clear connection between diffusion over fractal spaces (such as networks of capillaries) and fractional-order dynamics has been established [ , , , ]. In particular, in anomalous diffusion the standard assumption that the mean square displacement \(\langle x^2 \rangle\) is proportional to time does not hold. Instead, it is \(\langle x^2 \rangle \sim t^{{2}/{d}}\) , where \(d\ne 2\) is the associated fractal dimension [ , , ].
Fractional kinetics [ ] was introduced in the pharmaceutical literature in [ ] and the first example of fractional pharmacokinetics which appeared in that article was amiodarone, a drug known for its power-law kinetics [ ]. Since then, other applications of fractional pharmacokinetics have appeared in the literature. Kytariolos et al. [ ] presented an application of fractional kinetics for the development of nonlinear in vitro-in vivo correlations. Popović et al. have presented several applications of fractional pharmacokinetics to model drugs, namely for diclofenac [ ], valproic acid [ ], bumetanide [ ] and methotrexate [ ]. Copot et al. have further used a fractional pharmacokinetics model for propofol [ ]. In most of these cases the fractional model has been compared with an equivalent ordinary PK model and was found superior. FDEs have been proposed to describe drug response too, apart from their kinetics. Verotta has proposed several alternative fractional PKPD models that are capable of describing pharmacodynamic times series with favourable properties [ ]. Although these models are empirical, i.e., they have no mechanistic basis, they are attractive since the memory effects of FDEs can link smoothly the concentration to the response with a variable degree of influence, while the shape of the responses generated by fractional PKPD models can be very flexible and parsimonious (modelled using few parameters).
Applications of FDEs in pharmacokinetics fall in the scope of the newly-coined discipline of mathematical pharmacology [ ] to which this issue is dedicated. Mathematical pharmacology utilises applied mathematics, beyond the standard tools used commonly in pharmacometrics, to describe drug processes in the body and assist in controlling them.
This paper introduces the basic principles of fractional calculus and FDEs, reviews recent applications of fractional calculus in pharmacokinetics and discusses their clinical implications. Moreover, some aspects of drug dosage regimen optimisation based on control theory are presented for the case of pharmacokinetic models that follow fractional kinetics. Indeed, in clinical pharmacokinetics and therapeutic drug monitoring, dose optimisation is carried out usually by utilising Bayesian methodology. Optimal control theory is a powerful approach that can be used to optimise drug administration, which can handle complicated constraints and has not been used extensively for this task. The case of fractional pharmacokinetic models is of particular interest for control theory and poses new challenges.
A problem that has hindered the applications of fractional calculus is the lack of efficient general-purpose numerical solvers, as opposed to ordinary differential equations. However, in the past few years significant progress has been achieved in this area. This important issue is discussed in the paper and some techniques for numerical solution of FDEs are presented.
Fractional derivatives
Derivatives of integer order \(n\in \mathbb {N}\) , of functions \(f:\mathbb {R}\rightarrow \mathbb {R}\) are well defined and their properties have been extensively studied in real analysis. The basis for the extension of such derivatives to real orders \(\alpha \in \mathbb {R}\) commences with the definition of an integral of order \(\alpha\) which hinges on Cauchy’s iterated ( n -th order) integral formula and gives rise to the celebrated Riemann-Liouville (RL) integral \({{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha }_t\) [ ]: $$\begin{aligned} {{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha }_t f(t) = {}_{0}\mathrm {D}_{t}^{-\alpha }f(t) = \tfrac{1}{\Gamma (\alpha )}\int _0^t (t-\tau )^{\alpha -1}f(\tau )\mathrm {d}\tau , \end{aligned}$$ (1) where \(\Gamma\) is the Euler gamma function. In Eq. ( 1 ) we assume that f is such that the involved integral is well-defined and finite. This is the case if f is continuous everywhere except at finitely many points and left-bounded, i.e., \(\{f(x); 0 \le x\le t\}\) is bounded for every \(t\ge 0\) . Note that for \(\alpha \in \mathbb {N}\) , \({{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha }_t f\) is equivalent to the ordinary \(\alpha\) -th order integral. Hereafter, we focus on derivatives of order \(\alpha \in [0,1]\) as only these are of interest to date in the study of fractional pharmacokinetics.
The left-side subscript 0 of the \({}_{0}\mathrm {D}_t^{\alpha }\) and \({{}_{0}^{\mathrm {rl}}\mathrm {I}}_t^{\alpha }\) operators, denotes the lower end of the integration limits, which in this case has been assumed to be zero. However, alternative lower bounds can be considered leading to different definitions of the fractional derivative with slightly different properties. When the lower bound is \(-\infty\) , the entire history of the studied function is accounted for, which is considered preferable in some applications and is referred to as the Weyl definition [ ].
It is intuitive to define a fractional-order derivative of order \(\alpha\) via \({}_{0}\mathrm {D}_{t}^{\alpha }= \mathrm {D}^1 {\,}_{0}\mathrm {D}_{t}^{\alpha -1} = \mathrm {D}^1 \,{{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha -1}\) , (where \(\mathrm {D}^1\) is the ordinary derivative of order 1), or equivalently $$\begin{aligned} {}_{0}\mathrm {D}_{t}^{\alpha }f(t) = \tfrac{\mathrm {d}}{\mathrm {d}t}\left[ \tfrac{1}{\Gamma (1-\alpha )}\int _0^t \frac{f(\tau )}{(t-\tau )^{\alpha }}\mathrm {d}\tau \right] \end{aligned}.$$ (2) This is the Riemann–Liouville definition—one of the most popular constructs in fractional calculus. One may observe that the fractional integration is basically a convolution between function f and a power law of time, i.e., \({}_{0}\mathrm {D}_{t}^{-\alpha }f(t) = t^{\alpha -1}*f(t)\) , where \(*\) denotes the convolution of two functions. This explicitly demonstrates the memory effects of the studied process. Fractional derivatives possess properties that are not straightforward or intuitive; for example, the half derivative of a constant \(f(t) = \lambda\) with respect to t does not vanish and instead is \(_{0}\mathrm {D}_t^{{1}/{2}} \lambda = {\lambda }/{\sqrt{\pi t}}\) .
Perhaps the most notable shortcoming of the Riemann–Liouville definition with the 0 lower bound is that when used in differential equations it gives rise to initial conditions that involve the fractional integral of the function and are difficult to interpret physically. This is one of the reasons the Weyl definition was introduced, but this definition may not be very practical for most applications either, as it involves an initial condition at time \(-\infty\) [ , ].
A third definition of the fractional derivative, which is referred to as the Caputo definition is preferable for most physical processes as it involves explicitly the initial condition at time zero. The definition is: $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }f(t) = \tfrac{1}{\Gamma (1-\alpha )}\int _0^t\frac{\tfrac{\mathrm {d}f(\tau )}{\mathrm {d}\tau }}{(t-\tau )^\alpha }\mathrm {d}\tau \end{aligned}$$ (3) where the upper-left superscript \(\mathrm {c}\) stands for Caputo . The Caputo derivative is interpreted as \({}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }= {{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha -1} \mathrm {D}^1\) , that is \(\mathrm {D}^1\) and \({{}_{0}^{\mathrm {rl}}\mathrm {I}}^{\alpha -1}\) are composed in the opposite way compared to the Riemann-Liouville definition. The Caputo derivative gives rise to initial value problems of the form $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha } x(t)&= F(x(t)),\end{aligned}$$ (4a) $$\begin{aligned} x(0)&= x_0. \end{aligned}$$ (4b)
This definition for the fractional derivative, apart from the more familiar initial conditions, comes with some properties similar to those of integer-order derivatives, one of them being that the Caputo derivative of a constant is in fact zero. Well-posedeness conditions, for the existence and uniqueness of solutions, for such fractional-order initial value problems are akin to those of integer-order problems [ ], [ , Chap. 3]. The various definitions of the fractional derivative give different results, but these are not contradictory since they apply for different conditions and it is a matter of choosing the appropriate one for each specific application. All definitions collapse to the usual derivative for integer values of the order of differentiation.
A fourth fractional derivative definition, which is of particular interest is the Grünwald–Letnikov , which allows the approximate discretisation of fractional differential equations. The Grünwald–Letnikov derivative, similar to integer order derivatives, is defined via a limit of a fractional-order difference . Let us first define the Grünwald–Letnikov difference of order \(\alpha\) and step-size h of a left-bounded function f as $$\begin{aligned} {^{\mathrm {gl}}\Delta }^\alpha _h f(t) = \tfrac{1}{h^{\alpha }} \sum _{j=0}^{ \left\lfloor {t}/{h}\right\rfloor }c_j^\alpha f(t-jh), \end{aligned}$$ (5) with \(c^\alpha 0=1\) and for \(j\in \mathbb {N}_{>0}\) $$\begin{aligned} c_j^\alpha =(-1)^{j}\prod _{i=0}^{j-1}\frac{\alpha -i}{i+1}. \end{aligned}$$ (6) The Grünwald–Letnikov difference operator leads to the definition of the Grünwald–Letnikov derivative of order \(\alpha\) which is defined as ([ ], Sect. 20) $$\begin{aligned} {{}^{\mathrm {gl}}\mathrm {D}}_t^\alpha f(t)=\lim _{h\rightarrow 0^+}{^{\mathrm {gl}}\Delta }^\alpha _h f(t), \end{aligned}$$ (7) insofar as the limit exists. This definition is of great importance in practice, as it allows us to replace \({{}^{\mathrm {gl}}\mathrm {D}}_t\) with \({^{\mathrm {gl}}\Delta }_h^\alpha\) provided that h is adequately small, therefore it serves as an Euler-type discretisation of fractional-order continuous time dynamics. By doing so, we produce a discrete-time yet infinite-dimensional approximation of the system since \({^{\mathrm {gl}}\Delta }_h^\alpha f(t)\) depends on \(f(t-jh)\) for all \(j\in \mathbb {N}_{>0}\) . However, we may truncate this series up to a finite history \(\nu\) , defining $$\begin{aligned} {^{\mathrm {gl}}\Delta }_{h,\nu }^\alpha f(t) =\tfrac{1}{h^{\alpha }} \sum _{j=0}^{\min \{\nu ,\left\lfloor {t}/{h}\right\rfloor \}} c_j^\alpha f(t-jh). \end{aligned}$$ (8) This leads to discrete-time finite-memory approximations which are particularly useful as we shall discuss in what follows.
Fractional kinetics
The most common type of kinetics encountered in pharmaceutical literature are the so called “zero order” and “first order”. Here the “order” refers to the order of linearity and is not to be confused with the order of differentiation, i.e., a zero order process refers to a constant rate and a first order to a proportional rate. The fractional versions of these types of kinetics are presented below and take the form of fractional-order ordinary differential equations. Throughout this presentation the Caputo version of the fractional derivative is considered for reasons already explained.
Zero-order kinetics
The simplest kinetic model is the zero-order model where it is assumed that the rate of change of the quantity q , expressed in [mass] units, is constant and equal to \(k_0\) , expressed in [mass]/[time] units. Zero-order systems are governed by differential equations of the form $$\begin{aligned} \frac{\mathrm {d}q}{\mathrm {d}t} = k_0. \end{aligned}$$ (9) The solution of this equation with initial condition \(q(0)=0\) is $$\begin{aligned} q(t) = k_0 t. \end{aligned}$$ (10) The fractional-order counterpart of such zero-order kinetics can be obtained by replacing the derivative of order 1 by a derivative of fractional order \(\alpha\) , that is $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }q(t) = k_{0,f}, \end{aligned}$$ (11) where \(k_{0,f}\) is a constant with units [mass]/[time] \(^{\alpha }\) . The solution of this equation for initial condition \(q(0)=0\) is a power law for \(t>0\) [ ] $$\begin{aligned} q(t) = \frac{k_{0,f}}{\Gamma (\alpha +1)}t^\alpha . \end{aligned}$$ (12)
First-order kinetics
The first-order differential equation, where the rate of change of the quantity q is proportional to its current value, is described by the ordinary differential equation $$\begin{aligned} \frac{\mathrm {d}q}{\mathrm {d}t} = -k_1 q(t). \end{aligned}$$ (13) Its solution with initial condition of \(q(0)=q_0\) is given by the classical equation of exponential decay $$\begin{aligned} q(t) = q_0 \exp (-k_1 t). \end{aligned}$$ (14) Likewise, the fractional-order analogue of such first-order kinetics is derived by replacing \({\mathrm {d}}/{\mathrm {d}t}\) by the fractional-order derivative \({}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }\) yielding the following fractional differential equation $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }q(t) =- k_{1,f} q(t), \end{aligned}$$ (15) where \(k_{1,f}\) is a constant with [time] \(^{-\alpha }\) units. The solution of this equation can be found in most books or papers of the fast growing literature on fractional calculus [ ] and for initial condition \(q(0)=q_0\) it is $$\begin{aligned} q(t) = q_0 \mathcal {E}_\alpha (-k_{1,f}t^\alpha ), \end{aligned}$$ (16) where \(\mathcal {E}_\alpha\) is the Mittag-Leffler function [ ] which is defined as $$\begin{aligned} \mathcal {E}_\alpha (t) = \sum _{k=0}^{\infty }\frac{t^k}{\Gamma (\alpha k + 1)}. \end{aligned}$$ (17) The function \(\mathcal {E}_\alpha (t)\) is a generalisation of the exponential function and it collapses to the exponential when \(\alpha =1\) , i.e., \(\mathcal {E}_1(t)=\exp (t)\) . Alternatively, Eq. ( 16 ) can be reparametrised by introducing a time scale parameter with regular time units, \(\tau _f = k_{1,f}^{-1/\alpha }\) and then becomes \(q(t) = q_0 \mathcal {E}_\alpha (-(t/\tau _f)^\alpha )\) . The solution of Eq. ( 15 ) basically means that the fractional derivative of order \(\alpha\) of the function \(\mathcal {E}_\alpha (t^\alpha )\) is itself a function of the same form, exactly like the classic derivative of an exponential is also an exponential.
It also makes sense to restrict \(\alpha\) to values \(0\le \alpha \le 1\) , since for values of a larger than 1 the solution of Eq. ( 15 ) is not monotonic and negative values for q may appear, therefore, it is not applicable in pharmacokinetics and pharmacodynamics. Based on these elementary equations the basic relations for the time evolution in drug disposition can be formulated, with the assumption of diffusion of drug molecules taking place in heterogeneous space. The simplest fractional pharmacokinetic model is the one-compartment model with i.v. bolus administration and the concentration, c , can be expressed by Eq. ( 16 ) divided by a volume of distribution, as $$\begin{aligned} c(t) = c_0 \mathcal {E}_{\alpha }(-k_{1,f} t^\alpha ), \end{aligned}$$ (18) with \(\alpha \le 1\) and \(c_0\) is the ratio [dose]/[apparent volume of distribution]. This equation for times \(t\ll 1\) behaves as a stretched exponential, i.e., as \({\sim }\exp (-k_{1,f}t^\alpha /\Gamma (1+\alpha ))\) , while for large values of time it behaves as a power-law, \({\sim }t^{-\alpha }/\Gamma (1-\alpha )\) (see Fig. 1 ) [ ]. This kinetics is, therefore, a good candidate to describe various datasets exhibiting power-law-like kinetics due to the slow diffusion of the drug in deeper tissues. Moreover, the relevance of the stretched exponential (Weibull) function with the Mittag-Leffler function probably explains the successful application of the former function in describing drug release in heterogeneous media [ ]. Equation ( 18 ) is a relationship for the simplest case of fractional pharmacokinetics. It accounts for the anomalous diffusion process, which may be considered to be the limiting step of the entire kinetics. Classic clearance may be considered not to be the limiting process here and is absent from the equation. Fig. 1 Amount-time profile according to Eq. ( 16 ) for \(\alpha =0.5\) (solid curve) along with its approximation at values of t close to 0 by a stretched exponential function \(\exp (-t^{{1}/{2}}/\Gamma (1.5))\) (bottom dashed curve) and an approximation at high values of t by a power function \(t^{-{1}/{2}}/\Gamma (0.5)\) (top dashed-dotted curve). Note that the time axis is logarithmic. The evolution of the amount of drug starts as a stretched exponential and eventually shapes as a power function
The Laplace transform for FDEs
Fractional differential equations (FDEs) can be easily written in the Laplace domain since each of the fractional derivatives can be transformed similarly to the ordinary derivatives, as follows, for order \(\alpha \le 1\) : $$\begin{aligned} {\mathcal {L}} \{ {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\alpha }f(t)\} = s^\alpha F(s) - s^{\alpha -1}f(0^+), \end{aligned}$$ (19) where F ( s ) is the Laplace transform of f ( t ) [ ]. For \(\alpha =1\) , Eq. ( 19 ) reduces to the classic well-known expression for ordinary derivatives, that is, \(\mathcal {L} \{\dot{f}(t)\}=sF(s) - f(0^+)\) .
Let us take as an example the following simple FDE $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1/2}q(t) = -q(t), \end{aligned}$$ (20) with initial value \(q(0) = 1\) which can be written in the Laplace domain, by virtue of Eq. ( 19 ), as follows $$\begin{aligned} s^{{1}/{2}}Q(s) - s^{-{1}/{2}}q(0) = -Q(s), \end{aligned}$$ (21) where \(Q(s)=\mathcal {L} \{q(t)\}(s)\) is the Laplace transform of q . After simple algebraic manipulations, we obtain $$\begin{aligned} Q(s) = \frac{1}{s+\sqrt{s}}. \end{aligned}$$ (22) By applying the inverse Laplace transform to Eq. ( 22 ) the closed-form analytical solution of this FDE can be obtained; this involves a Mittag-Leffler function of order one half. In particular, $$\begin{aligned} q(t) = \mathcal {E}_{{1}/{2}}(-t^{{1}/{2}}) = e^t(1+{\text {erf}}(-\sqrt{t})). \end{aligned}$$ (23) Although more often than not it is easy to transform an FDE in the Laplace domain, it is more difficult to apply the inverse Laplace transform so as to solve it explicitly for the system variables so that an analytical solution in the time domain is obtained. However, it is possible to perform that step numerically using a numerical inverse Laplace transform (NILT) algorithm [ ] as described above.
Fractional pharmacokinetics
Multi-compartmental models
A one-compartment pharmacokinetic model with i.v. bolus administration can be easily fractionalised as in Eq. ( 15 ) by changing the derivative on the left-hand-side of the single ODE to a fractional order. However, in pharmacokinetics and other fields where compartmental models are used, two or more ODEs are often necessary and it is not as straightforward to fractionalise systems of differential equations, especially when certain properties such as mass balance need to be preserved.
When a compartmental model with two or more compartments is built, typically an outgoing mass flux becomes an incoming flux to the next compartment. Thus, an outgoing mass flux that is defined as a rate of fractional order, cannot appear as an incoming flux into another compartment, with a different fractional order, without violating mass balance [ ]. It is therefore, in general, impossible to fractionalise multi-compartmental systems simply by changing the order of the derivatives on the left hand side of the ODEs.
One approach to the fractionalisation of multi-compartment models is to consider a common fractional order that defined the mass transfer from a compartment i to a compartment j : the outflow of one compartment becomes an inflow to the other. This implies a common fractional order known as a commensurate order. In the general case, of non-commensurate-order systems, a different approach for fractionalising systems of ODEs needs to be applied.
In what follows, a general form of a fractional two-compartment system is considered and then generalised to a system of an arbitrary number of compartments, which first appeared in [ ]. A general ordinary linear two-compartment model, is defined by the following system of linear ODEs, $$\begin{aligned} \frac{\mathrm {d}q_1(t)}{\mathrm {d}t}&= -k_{12}q_1(t) + k_{21}q_2(t) - k_{10}q_1(t) + u_1(t),\end{aligned}$$ (24a) $$\begin{aligned} \frac{\mathrm {d}q_2(t)}{\mathrm {d}t}&= k_{12}q_1(t) - k_{21}q_2(t) - k_{20}q_2(t) + u_2(t), \end{aligned}$$ (24b) where \(q_1(t)\) and \(q_2(t)\) are the mass or molar amounts of material in the respective compartments and the \(k_{ij}\) constants control the mass transfer between the two compartments and elimination from each of them. The notation convention used for the indices of the rate constants is that the first corresponds to the source compartment and the second to the target one, e.g., \(k_{12}\) corresponds to the transfer from compartment 1 to 2, \(k_{10}\) corresponds to the elimination from compartment 1, etc. The units of all the \(k_{ij}\) rate constants are (1/[time]). \(u_{i}(t)\) are input rates in each compartment which may be zero, constant or time dependent. Initial values for \(q_1\) and \(q_2\) have to be considered also, \(q_1(0)\) and \(q_2(0)\) , respectively.
In order to fractionalise this system, first the ordinary system is integrated, obtaining a system of integral equations and then the integrals are fractionalised as shown in [ ]. Finally, the fractional integral equations, are differentiated in an ordinary way. The resulting fractional system contains ordinary derivatives on the left hand side and fractional Riemann-Liouville derivatives on the right hand side: $$\begin{aligned} \frac{\mathrm {d}q_1(t)}{\mathrm {d}t}&= - k_{12,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{12}} q_1(t) + k_{21,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{21}} q_2(t) - k_{10,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{10}} q_1(t) + u_1(t),\end{aligned}$$ (25a) $$\begin{aligned} \frac{\mathrm {d}q_2(t)}{\mathrm {d}t}&= k_{12,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{12}} q_1(t) - k_{21,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{21}}q_2(t) - k_{20,f}{\,}_{0}\mathrm {D}_{t}^{1-\alpha _{20}} q_2(t) + u_2(t), \end{aligned}$$ (25b) where \(0 < \alpha _{ij} \le 1\) is a constant representing the order of the specific process. Different values for the orders of different processes may be considered, but the order of the corresponding terms of a specific process are kept the same when these appear in different equations, e.g., there can be an order \(\alpha _{12}\) for the transfer from compartment 1 to 2 and a different order \(\alpha _{21}\) for the transfer from compartment 2 to 1, but the order for the corresponding terms of the transfer, from compartment 1 to 2, \(\alpha _{12}\) , is the same in both equations. Also the index f in the rate constant was added to emphasise the fact that these are different to the ones of Eq. ( 24a ) and carry units [time] \(^{-\alpha }\) .
It is convenient to rewrite the above system Eqs. ( 25a , 25b ) with Caputo derivatives. An FDE with Caputo derivatives accepts the usual type of initial conditions involving the variable itself, as opposed to RL derivatives which involve an initial condition on the derivative of the variable, which is not practical. When the initial value of \(q_1\) or \(q_2\) is zero then the respective RL and Caputo derivatives are the same. This is convenient since a zero initial value is very common in compartmental analysis. When the initial value is not zero, converting to a Caputo derivative is possible, for the particular term with a non-zero initial value. The conversion from a RL to a Caputo derivative of the form that appears in Eqs. ( 25a , 25b ) is done with the following expression: $$\begin{aligned} {}_{0}\mathrm {D}_{t}^{1-\alpha _{ij}} q_i(t) = {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha _{ij}}q_i(t) + \frac{q_i(0) t^{\alpha _{ij}-1}}{\Gamma (\alpha _{ij})}. \end{aligned}$$ (26) Summarising the above remarks about initial conditions, we may identify three cases: (i) the initial condition is zero and then the derivative becomes a Caputo by definition. (ii) The initial condition is non-zero, but it is involved in a term with an ordinary derivative so it is treated as usual. (iii) The initial condition is non-zero and is involved in a fractional derivative which means that in order to present a Caputo derivative, an additional term, involving the initial value appears, by substituting Eq. ( 26 ). Alternatively, a zero initial value for that variable can be assumed, with a Dirac delta input to account for the initial quantity for that variable. So, a general fractional model with two compartments, Eqs. ( 25a , 25b ), was formulated, where the fractional derivatives can always be written as Caputo derivatives. It is easy to generalise the above approach to a system with an arbitrary number of n compartments as follows $$\begin{aligned} \frac{\mathrm {d}q_i(t)}{\mathrm {d}t} = - k_{i0} {\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha _{i0}}q_i(t) - \sum _{j\ne i}k_{ij} {\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha _{ij}}q_i(t) + \sum _{j\ne i}k_{ji} {\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha _{ji}}q_j(t) + u_i(t), \end{aligned}$$ (27) for \(i=1,\ldots , n\) , where Caputo derivatives have been considered throughout since, as explained above, this is feasible. This system of Eq. ( 27 ) is too general for most purposes as it allows every compartment to be connected with every other. Typically the connection matrix would be much sparser than that, with most compartments being connected to just one neighbouring compartment while only a few “hub” compartments would have more than one connections. The advantage of the described approach of fractionalisation is that each transport process is fractionalised separately, rather than fractionalising each compartment or each equation. Thus, processes of different fractional orders can co-exist since they have consistent orders when the corresponding terms appear in different equations. Also, it is important to note that dynamical systems of the type ( 27 ) do not suffer from pathologies such as violation of mass balance or inconsistencies with the units of the rate constants.
As mentioned, FDEs can be easily written in the Laplace domain. In the case of FDEs of the form of Eq. ( 27 ), where the fractional orders are \(1-\alpha _{ij}\) , the Laplace transform of the Caputo derivative becomes $$\begin{aligned} \mathcal {L} \{{}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha _{ij}}q_i(t)\} = s^{1-\alpha _{ij}}Q_i(s) - s^{-\alpha _{ij}}q_i(0). \end{aligned}$$ (28) An alternative approach for fractionalisation of non-commensurate fractional pharmacokinetic systems has been proposed in [ ], where the conditions that the pharmacokinetic parameters need to satisfy for the mass balance to be preserved have been defined.
A one-compartment model with constant rate input
After the simplest fractional pharmacokinetic model with one-compartment and i.v. bolus of Eq. ( 18 ), the same model with fractional elimination, but with a constant rate input is considered [ ]. Even in this simple one-compartment model, it is necessary to employ the approach of fractionalising each process separately, described above, since the constant rate of infusion is not of fractional order. That would have been difficult if one followed the approach of changing the order of the derivative of the left hand side of the ODE, however here it is straightforward. The system can be described by the following equation $$\begin{aligned} \frac{\mathrm {d}q(t)}{\mathrm {d}t} = k_{01} - k_{10,f}{\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha }q(t), \end{aligned}$$ (29) with \(q(0)=0\) and where \(k_{01}\) is a zero-order input rate constant, with units [mass]/[time], \(k_{10,f}\) is a rate constant with units [time] \(^{-\alpha }\) and \(\alpha\) is a fractional order less than 1. Eq. ( 29 ) can be written in the Laplace domain as $$\begin{aligned} sQ(s) - q(0) = \frac{k_{01}}{s} - k_{10,f}(s^{1-\alpha }Q(s) - s^{-\alpha }q(0)). \end{aligned}$$ (30) Since \(q(0)=0\) , Eq. ( 30 ) can be solved to obtain $$\begin{aligned} Q(s) = \frac{k_{01}s^{\alpha -2}}{s^{\alpha }+k_{10,f}}. \end{aligned}$$ (31) By applying the following inverse Laplace transform formula (Equation (1.80) in [ ], page 21): $$\begin{aligned} \mathcal {L} ^{-1}\left\{ \frac{s^{\mu -\nu }}{s^{\mu } + k}\right\} = t^{\nu -1}\mathcal {E}_{\mu ,\nu }(-k t^\mu ), \end{aligned}$$ (32) where \(\mathcal {E}_{\mu ,\nu }\) is the Mittag-Leffler function with two parameters. For \(\mu =\alpha\) and \(\nu = 2\) , we obtain $$\begin{aligned} q(t) = k_{01} t \mathcal {E}_{\alpha ,2}(-k_{10,f}t^{\alpha }). \end{aligned}$$ (33) In Theorem 1.4 of [ ], the following expansion for the Mittag-Leffler function is proven to hold asymptotically as \(|z|\rightarrow \infty\) : $$\begin{aligned} \mathcal {E}_{\mu ,\nu }(z) = -\sum _{k=1}^{p}\frac{z^{-k}}{\Gamma (\nu -\mu )} + \mathcal {O}(|z|^{1-p}). \end{aligned}$$ (34) Applying this formula to Eq. ( 33 ) and keeping only the first term of the sum since the rest are of higher order, the limit of Eq. ( 33 ) for t going to infinity can be shown to be \(\lim _{t\rightarrow \infty }q(t)=\infty\) for all \(0< \alpha < 1\) [ ].
The fact that the limit of q ( t ) in Eq. ( 33 ) diverges as t goes to infinity, for \(\alpha <1\) , means that unlike the classic case, for \(\alpha =1\) —where ( 33 ) approaches exponentially the steady state \({k_{01}}/{k_{10,f}}\) , for \(\alpha <1\) —there is infinite accumulation. In Fig. 2 a plot of ( 33 ) is shown for \(\alpha =0.5\) demonstrating that in the fractional case the amount grows unbounded. In the inset of Fig. 2 the same profiles are shown a 100-fold larger time span, demonstrating the effect of continuous accumulation.
The lack of a steady state under constant rate administration which results to infinite accumulation is one of the most important clinical implications of fractional pharmacokinetics. It is clear that this implication extends to repeated doses as well as constant infusion, which is the most common dosing regimen, and can be important in chronic treatments. In order to avoid accumulation, the constant rate administration must be adjusted to a rate which decreases with time. Indeed, in Eq. ( 29 ), if the constant rate of infusion \(k_{01}\) is replaced by the term \(f(t)=k_{01}t^{1-\alpha }\) , [ ] the solution of the resulting FDE is, instead of Eq. ( 33 ), the following $$\begin{aligned} q(t) = k_{01}\Gamma (\alpha ) t^\alpha \mathcal {E}_{\alpha , \alpha +1}(-k_{10,f}t^{\alpha }). \end{aligned}$$ (35) The drug quantity q ( t ) in Eq. ( 35 ) converges to the steady state \(\Gamma (\alpha ){k_{01}}/{k_{10,f}}\) as time goes to infinity, while for the special case of \(\alpha =1\) , the steady state is the usual \({k_{01}}/{k_{10,f}}\) . Similarly, for the case of repeated doses, if a steady state is intended to be achieved, in the presence of fractional elimination of order \(\alpha\) , then the usual constant rate of administration, e.g., a constant daily dose, needs to be replaced by an appropriately decreasing rate of administration. As shown in [ ], this can be either the same dose, but given at increasing inter-dose intervals, i.e., \(T_i = (T_{i-1}^{\alpha } + \alpha \Delta \tau ^{\alpha })^{{1}/{\alpha }}\) , where \(T_i\) is the time of the i -th dose and \(\Delta \tau\) is the inter-dose interval of the corresponding kinetics of order \(\alpha =1\) ; or a decreasing dose given at constant intervals, i.e., \(q_{0,i}={q_0}/{\alpha }((i+1)^{\alpha }-i^{\alpha })\) . This way, an ever decreasing administration rate is implemented which compensates the decreasing elimination rate due to the fractional kinetics. Fig. 2 Amount-time profiles for \(\alpha =0.5\) : (solid line) amount of drug versus time according to Eq. ( 33 ) with constant infusion where there is unbounded accumulation of drug, (dashed line) time-profile according to Eq. ( 35 ), with power-law infusion where the amount of drug approaches a steady state. (Inset) The same profiles for 100 times longer time span
A two-compartment i.v. model
Based on the generalised approach for the fractionalisation of compartmental models, which allows mixing different fractional orders, developed above, a two-compartment fractional pharmacokinetic model is considered, shown schematically in Fig. 3 . Compartment 1 (central) represents general circulation and well perfused tissues while compartment 2 (peripheral) represents deeper tissues. Three transfer processes (fluxes) are considered: elimination from the central compartment and a mass flux from the central to the peripheral compartment, which are both assumed to follow classic kinetics (order 1), while a flux from the peripheral to the central compartment is assumed to follow slower fractional kinetics accounting for tissue trapping [ , ].
The system is formulated mathematically as follows: $$\begin{aligned} \frac{\mathrm {d}q_1(t)}{\mathrm {d}t}&= -(k_{12} + k_{10})q_1(t) + k_{21,f} {\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha }q_2(t),\end{aligned}$$ (36a) $$\begin{aligned} \frac{\mathrm {d}q_2(t)}{\mathrm {d}t}&= k_{12}q_1(t) - k_{21,f} {\,}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{1-\alpha }q_2(t), \end{aligned}$$ (36b) where \(\alpha < 1\) and initial conditions are \(q_1(0) = q_{1,0}\) , \(q_2(0) = 0\) which account for a bolus dose injection and no initial amount in the peripheral compartment. Note that it is allowed to use Caputo derivatives here since the fractional derivatives involve only terms with \(q_2\) for which there is no initial amount, which means that Caputo and RL derivatives are identical. Fig. 3 A fractional two-compartment PK model with an i.v. bolus. Elimination from the central compartment and a mass flux from the central to the peripheral compartment, which are both assumed to follow classic kinetics (order 1), while a flux from the peripheral to the central compartment is assumed to follow slower fractional kinetics, accounting for tissue trapping (dashed arrow)
Applying the Laplace transform, to the above system the following algebraic equations are obtained: $$\begin{aligned} sQ_1(s) - q_1(0)&= - (k_{12} + k_{10})Q_1(s) + k_{21}(s^{1-\alpha }Q_2(s) \;- s^{-\alpha }q_2(0)),\end{aligned}$$ (37a) $$\begin{aligned} sQ_2(s) - q_2(0)&= k_{12}Q_1(s) - k_{21,f}(s^{1-\alpha }Q_2(s) - s^{-\alpha }q_2(0)). \end{aligned}$$ (37b)
Solving for \(Q_1(s)\) and \(Q_2(s)\) and substituting the initial conditions, $$\begin{aligned} Q_1(s)&= \frac{q_{1,0}(s^{\alpha } + k_{21,f})}{(s+k_{12}+k_{10})(s^\alpha +k_{21,f})-k_{12}k_{21,f}} \end{aligned}$$ (38a) $$\begin{aligned} Q_2(s)&= \frac{q_{1,0} s^{\alpha -1} k_{12}}{(s+k_{12}+k_{10})(s^\alpha +k_{21,f})-k_{12}k_{21,f}} \end{aligned}$$ (38b) Using the above expression for \(Q_1\) and \(Q_2\) , Eqs. ( 38a ) and ( 38b ), respectively, can be used to simulate values of \(q_1(t)\) and \(q_2(t)\) in the time domain by an NILT method. Note that primarily \(q_1(t)\) is of interest, since in practice we only have data from this compartment. The output for \(q_1(t)\) from this numerical solution may be combined with the following equation $$\begin{aligned} c(t) = \frac{q_1(t)}{V}, \end{aligned}$$ (39) where c is the drug concentration in the blood and V is the apparent volume of distribution. Eq. ( 39 ) can be fitted to pharmacokinetic data in order to estimate parameters V , \(k_{10}\) , \(k_{12}\) , \(k_{21,f}\) and \(\alpha\) .
The closed-form analytical solution of Eqs. ( 36a , 36b ), can be expressed in terms of an infinite series of generalised Wright functions as demonstrated in the book by Kilbas et al. [ ], but these solutions are hard to implement and apply in practice. Moloni in [ ] derived analytically the inverse Laplace transform of \(Q_1(s)\) as: $$\begin{aligned} q_1(t)&\;=\; q_{1,0} \sum _{n=0}^{\infty }(-1)^n k_{21,f}^n \sum _{l=0}^{n} \frac{k_{10}^l n!}{(n-l)!l!} \Big ( t^{l+\alpha n}\mathcal {E}_{1,l+\alpha n + 1}^{n+1} (-(k_{10}+k_{12})t) \nonumber \\&+t^{l+\alpha (n+1)} \mathcal {E}_{1,l+\alpha (n+1) + 1}^{n+1} (-(k_{10}+k_{12})t) \Big ), \end{aligned}$$ (40a) while for \(Q_2\) the inverse Laplace transform works out to be [ ]: $$\begin{aligned} q_2(t) = q_{1,0} k_{12} \sum _{n=0}^{\infty }(-1)^n k_{21,f}^n \sum _{l=0}^{n} \frac{k_{10}^l n!}{(n-l)!l!} t^{l+\alpha n} \mathcal {E}_{1,l+\alpha n + 2}^{n+1} (-(k_{10}+k_{12})t). \end{aligned}$$ (40b) Fig. 4 Concentration-time profile of amiodarone in the central compartment. The solid line corresponds to the fractional-order pharmacokinetic model of Eqs. ( 36a , 36b ) with the parameter estimates: \(\alpha =0.587\) , \(k_{10}=1.49\,\mathrm{{days}}^{-1}\) , \(k_{12}= 2.95\,\mathrm{{days}}^{-1}\) , \(k_{21,f}=0.48\,\mathrm{{days}}^{-\alpha }\) and \({q_0}/{V}=4.72{ng}/{ml}\) . The circles correspond to experimental measurements
An application of the fractional two-compartment model, the system of Eqs. ( 36a , 36b ) to amiodarone PK data was presented in [ ]. Amiodarone is an antiarrhythmic drug known for its anomalous, non-exponential pharmacokinetics, which has important clinical implications due to the accumulation pattern of the drug in long-term administration. The fractional two-compartment model of the previous section was used to analyse an amiodarone i.v. data-set which first appeared in [ ] and estimates of the model parameters were obtained. Analysis was carried out in MATLAB while the values for \(q_1(t)\) of Eq. ( 40a ) were simulated using a NILT algorithm [ ] from the expression of \(Q_1(s)\) in the Laplace domain. In Fig. 4 the model-based predictions are plotted together with the data demonstrating good agreement for the 60 day period of this study. The estimated fractional order was \(\alpha =0.587\) and the non-exponential character of the curve is evident, while the model follows well the data both for long and for short times, unlike empirical power-laws which explode at \(t=0\) .
Numerical methods for fractional-order systems
For simple fractional-order models, as we discussed previously, there may exist closed-form analytical solutions which involve the one-parameter or two-parameters Mittage-Leffler function, or are given by more intricate analytical expressions such as Eqs. ( 40a , 40b ). Interestingly, even for simple analytical solutions such as Eq. ( 16 ), the Mittag-Leffler function itself is evaluated by solving an FDE numerically [ ]. This fact, without discrediting the value of analytical solutions, necessitates the availability of reliable numerical methods that allow us to simulate and study fractional-order systems. The availability of accurate discrete-time approximations of the trajectories of such systems is important not only for simulating, but also for the design of open-loop or closed-loop administration strategies, based on control theory [ ]. Time-domain approximations are less parsimonious than s -domain ones, but are more suitable for control applications as we discuss in the next section.
There can be identified four types of solutions for fractional-order differential equations: (i) closed-form analytical solutions, (ii) approximations in the Laplace s -domain using integer-order rational transfer functions, (iii) numerical approximation schemes in the discrete time domain and (iv) numerical inverse Laplace transforms. Each of these comes with certain advantages as well as limitations; for example, closed-form analytical solutions are often not available, while the inverse Laplace function requires an explicit closed form for \(u_i(t)\) so it cannot be used for administration rates that are defined implicitly or are arbitrary signals. Approximations in the s -domain are powerful modelling tools, but they fail to provide error bounds on the concentration of the administered drug in the time domain which are necessary in clinical practice.
In regard to closed-form analytical solutions, when available, they involve special functions such as the Mittag-Leffler function \(\mathcal {E}_{\alpha ,\beta }(t)=\sum _{k=0}^{\infty } {t^k}/{\Gamma (\alpha k + \beta )}\) whose evaluation calls, in turn, for some numerical approximation scheme. Analytical closed-form solutions of fractional differential equations are available for pharmacokinetic systems [ ]. Typically for the evaluation of this function we resort to solving an FDE numerically [ , , ] because the series in the definition of \(\mathcal {E}_{\alpha ,\beta }(t)\) converges rather slowly and no exact error bounds as available so as to establish meaningful termination criteria.
Transfer functions and integer-order approximations
Fractional-order systems, like their integer-order counterparts, can be modelled in the Laplace s -domain via transfer functions , that is, $$\begin{aligned} F_{ij}(s) = \frac{Q_j(s)}{U_i(s)}, \end{aligned}$$ (41) where \(Q_j(s)\) and \(U_i(s)\) are the Laplace transforms of the drug quantity \(q_j(t)\) and the administration rate \(u_i(t)\) . If the pharmacokinetics is described by linear fractional-order models such as the ones discussed above, \(F_{ij}\) will be a fractional-order rational function (a quotient of polynomials with real exponents).
Rational approximations aim at approximating such transfer functions—which involve terms of the form \(s^\alpha\) , \(\alpha \in \mathbb {R}\) —by ordinary transfer functions of the form $$\begin{aligned} \tilde{F}_{ij}(s) = \frac{P_{ij}(s)}{S_{ij}(s)}, \end{aligned}$$ (42) where \(P_{ij}\) and \(S_{ij}\) are polynomials and the degree of \(P_{ij}\) is no larger than the degree of \(S_{ij}\) . For convenience with notation, we henceforth drop the subscripts ij .
Padé Approximation The Padé approximation of order [ m / n ], \(m,n\in \mathbb {N}\) , at a point \(s_0\) is rather popular and leads to rational functions with \(\deg P =m\) and \(\deg S = n\) [ ].
Matsuda-Fujii continuous fractions approximation This method consists in interpolating a function F ( s ), which is treated as a black box, across a set of logarithmically spaced points [ ]. By letting the selected points be \(s_k\) , \(k=0,1,2,\dots\) , the approximation is written as the continued fractions expansion $$\begin{aligned} F(s) = \alpha _0 + \frac{s-s_0}{\alpha _1 + \frac{s-s_1}{\alpha _2 + \frac{s-s_2}{\alpha _3+\dots }}} \end{aligned}$$ (43) where, \(\alpha _i = \upsilon _i (s_i)\) , \(\upsilon _0(s) = H(s)\) and \(\upsilon _{i+1}(s) = \frac{s-s_i}{\upsilon _i(s) - \alpha _i}\) .
Oustaloup’s method Oustaloup’s method is based on the approximation of a function of the form: $$\begin{aligned} H(s) = s^{\alpha }, \end{aligned}$$ (44) with \(\alpha >0\) by a rational function $$\begin{aligned} \widehat{H}(s) = c_0 \prod _{k=-N}^N \frac{s+\omega _k}{s+\omega '_k}, \end{aligned}$$ (45) within a range of frequencies from \(\omega _b\) to \(\omega _h\) [ ]. The Oustaloup method offers an approximation at frequencies which are geometrically distributed about the characteristic frequency \(\omega _u = \sqrt{\omega _b\omega _h}\) —the geometric mean of \(\omega _b\) and \(\omega _h\) . The parameters \(\omega _k\) and \(\omega _k'\) are determined via the design formulas [ ] $$\begin{aligned} \omega _k' = \omega _b \left( \frac{\omega _h}{\omega _b}\right) ^{ \frac{k+N+0.5(1+\alpha )}{2N+1} },\end{aligned}$$ (46a) $$\begin{aligned} \omega _k = \omega _b \left( \frac{\omega _h}{\omega _b}\right) ^{ \frac{k+N+0.5(1-\alpha )}{2N+1} },\end{aligned}$$ (46b) $$\begin{aligned} c_0 = \left( \frac{\omega _h}{\omega _b}\right) ^{-\frac{r}{2}} \prod _{k=-N}^{N}\frac{\omega _k}{\omega _k'}. \end{aligned}$$ (46c) Parameters \(\omega _b\) , \(\omega _h\) and N are design parameters of the Oustaloup method.
There are a few more methods which have been proposed in the literature to approximate fractional-order systems by rational transfer functions such as [ , ], as well as data-driven system identification techniques [ ].
Time domain approximations
Several methods have been proposed which attempt to approximate the solution to a fractional-order initial value problem in the time domain.
Grünwald–Letnikov This is the method of choice in the discrete time domain where \({{}^{\mathrm {gl}}\mathrm {D}}_t^\alpha x(t)\) is approximated by its discrete-time finite-history variant \(({{^{\mathrm {gl}}\Delta }}^\alpha _{h,\nu } x)_k\) which is proven to have bounded error with respect to \(({{^{\mathrm {gl}}\Delta }}_h^\alpha x)_k\) [ ]. The boundedness of this approximation error is a singular characteristic of this approximation method and is suitable for applications in drug administration where it is necessary to guarantee that the drug concentration in the body will remain within certain limits [ ]. As an example, system ( 15 ) is approximated (with sampling time h ) by the discrete-time linear system $$\begin{aligned} \tfrac{1}{h^{\alpha }} \sum _{j=0}^{\min \{\nu ,\left\lfloor {t}/{h}\right\rfloor \}} c_j^\alpha q_{k+1-j} = -k_{1,f} q_{k}, \end{aligned}$$ (47) where \(q_k = q(kh)\) .
The discretisation of the Grünwald–Letnikov derivative suffers from the fact that the required memory grows unbounded with the simulation time. The truncation of the Grünwald–Letnikov series up to some finite memory gives rise to viable solution algorithms which can be elegantly described using triangular strip matrices as described in [ ] and are available as a MATLAB toolbox.
Approximation by parametrisation Approximate time-domain solutions can be obtained by assuming a particular parametric form for the solution. Such a method was proposed by Hennion and Hanert [ ] where q ( t ) is approximated by finite-length expansions of the form \(\sum _{j=0}^{N}A_j \phi _j(t)\) , where \(\phi _j\) are Chebyshev polynomials and \(A_j\) are constant coefficients. By virtue of the computability of fractional derivatives of \(\phi _j\) , the parametric approximation is plugged into the fractional differential equation which, along with the initial conditions, yields a linear system. What is notable in this method is that expansions as short as \(N=10\) lead to very low approximation errors. Likewise, other parametric forms can be used. For example, [ ] used a Fourier-type expansion and [ ] used piecewise quadratic functions.
Numerical integration methods Fractional-order initial value problems can be solved with various numerical methods such as the Adams–Bashforth–Moulton predictor-corrector (ABMPC) method [ ] and fractional linear multi-step methods (FLMMs) [ , ]. These methods are only suitable for systems of FDEs in the form $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^\gamma x(t)&= f(t,x(t)),\end{aligned}$$ (48a) $$\begin{aligned} x^{(k)}(0)&= x_{0,k},\, k = 0,\dots ,m-1 \end{aligned}$$ (48b) where \(\gamma\) is a rational, and \(m = \lceil \gamma \rceil\) . Typically in pharmacokinetics we encounter cases with \(0 < \gamma \le 1\) , therefore, we will have \(m=1\) .
Let us give an example on how this applies to the two-compartment model we presented above. In order to bring Eqs. ( 36a , 36b ) in the above form, we need to find a rational approximation of two derivatives, \(1-\alpha\) and 1. If we can find a satisfying rational approximation of \(1 - a\; \approxeq \; p/q\) , then the first order derivative follows trivially. Now, Eqs. ( 36a , 36b ) can be written as $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } x_0&= x_1 \end{aligned}$$ (49a) $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } x_1&= x_2 \end{aligned}$$ (49b) $$\begin{aligned}&\ \,\vdots \nonumber \\ {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } x_{q-1}&= -(k_{12}+k_{10})x_0 {+} k_{21,f} x_{q+p} {+} u\end{aligned}$$ (49c) $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } x_{q}&= x_{q+1} \end{aligned}$$ (49d) $$\begin{aligned}&\ \, \vdots \nonumber \\ {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } x_{2q-1}&= k_{12}x_0 - k_{21,f}x_{q+p} \end{aligned}$$ (49e) with initial conditions \(x_0(0) = q_1(0)\) , \(x_{q}(0) = q_2(0)\) and \(x_i(0) = 0\) for \(i \notin \{1, q\}\) , and \(\gamma =1/q\) . This system is in fact a linear fractional-order system for which closed-form analytical solutions are available ([ ], Thm. 2.5). In particular, Eqs. ( 49a , 49b ) can be written concisely in the form $$\begin{aligned} {}_{0}^{\mathrm {c}}\mathrm {D}_{t}^{\gamma } \mathbf {x}(t)&= A\mathbf {x}(t) + Bu(t)\end{aligned}$$ (50a) $$\begin{aligned} \mathbf {x}(0)&= \mathbf {x}_0, \end{aligned}$$ (50b) where \(\mathbf {x} = (x_0, x_1,\ldots , x_{2q-1})\) and \(\mathbf {x}_0 = (x_0(0),\ldots , x_{2q-1}(0))\) and matrices A and B can be readily constructed from the above dynamical equations. This fractional-order initial value problem has the closed-form analytical solution ([ ], Thm. 2.5) $$\begin{aligned} \mathbf {x}(t) = \mathcal {E}_\gamma (At^\gamma )\mathbf {x}_0 + \int _0^t \sum _{k=0}^{\infty }\frac{A^k(t-\tau )^{k\gamma }}{\Gamma ((k+1)\gamma )}Bu(\tau )\mathrm {d}\tau . \end{aligned}$$ (51) Evidently, the inherent complexity of this closed-form analytical solution—which would require the evaluation of slowly-converging series—motivates and necessitates the use of numerical methods.
The number of states of system ( 49a , 49b ) is 2 q , therefore, the rational approximation should aim at a small q . Yet another reason to choose small q is that small values of \(\gamma\) render the system hard to simulate numerically because they increase the effect of and dependence on the memory.
Adams-Bashforth-Moulton predictor-corrector (ABMPC) Methods of the ABMPC type have been generalised to solve fractional-order systems. The key idea is to evaluate \(({{{}_{0}^{\mathrm {rl}}\mathrm {I}}}^\gamma f)(t,x(t))\) by approximating f with appropriately selected polynomials. Solutions of Eqs. ( 48a , 48b ) satisfy the following integral representation $$\begin{aligned} x(t) = \sum _{k = 0}^{m-1} x_{0,k}\frac{t^k}{k!} + \left( {{{}_{0}^{\mathrm {rl}}\mathrm {I}}}^\gamma f\right) (t,x(t)), \end{aligned}$$ (52) where the first term on right hand side will be denoted by \(T_{m-1}(t).\) This is precisely an integral representation of Eqs. ( 48a , 48b ). The integral on the right hand side of the previous equation can be approximated, using an uniformly spaced grid \(t_n = nh\) , by \(\frac{h^\gamma }{\gamma (\gamma + 1)}\sum _{j = 0}^{n+1} a_{j,n+1} f(t_j)\) for suitable coefficients \(a_{j,n+1}\) [ ]. The numerical approximation of the solution of Eqs. ( 48a , 48b ) is $$\begin{aligned} x(t_{n+1})&= T_{m-1}(t_{n+1}) + \tfrac{h^\gamma }{\Gamma (\gamma +2)}f(t_{n+1},x_p(t_{n+1})) + \sum _{j=1}^n a_{j,n+1}f(t_j,x(t_j)). \end{aligned}$$ (53a) The equation above is usually referred to as the corrector formula and \(x_p(t_{n+1})\) is given by the predictor formula $$\begin{aligned} x_P(t_{n+1}) = T_{m-1}(t_n)&+ \tfrac{1}{\Gamma (\gamma )} \sum _{j = 0}^{n} b_{j,n+1}f(t_j,x(t_j)). \end{aligned}$$ (53b) Unfortunately, the convergence error of ABMPC when \(0< \gamma < 1\) is \(\mathcal {O}(h^{1+\gamma })\) , therefore, a rather small step size h is required to attain a reasonable approximation error. A modification of the basic predictor-corrector method with more favourable computational cost is provided in [ ] for which the MATLAB implementation fde12 is available.
Lubich’s method Fractional linear multi-step methods (FLMM) [ ] are a generalisation of linear multi-step methods (LMM) for ordinary differential equations. The idea is to approximate the Riemann-Liouville fractional-order integral operator ( 1 ) with a discrete convolution, known as a convolution quadrature , as $$\begin{aligned} \left( {{}_{0}^{\mathrm {rl}}\mathrm {I}}_h^\gamma f\right) (t)\;\approxeq\;h^\gamma \sum _{j=0}^{n} \omega _{n-j}f(t_j) + h^\gamma \sum _{j=0}^{s}w_{n,j}f(t_j), \end{aligned}$$ (54) for \(t_j = jh\) , where ( \(w_{n,j}\) ) and ( \(\omega _n\) ) are independent of h . Surprisingly, the latter can be constructed from any linear multistep method for arbitrary fractional order \(\gamma\) [ ]. FLMM constructed this way will inherit the same convergence rate and at least the same stability properties as the original LMM method [ ].
A MATLAB implementation of Lubich’s method, namely flmm2 [ ] which is based on [ ] is available. However, these methods do not perform well for small \(\gamma\) . According to [ ], for the case of amiodarone, it is reported that values of \(\gamma\) smaller than 0.1 give poor results and often do not converge, while using a crude approximation given by \(\gamma = 1/5\) , flmm2 was shown to outperform fde12 in terms of accuracy and stability at bigger step sizes h .
Numerical inverse Laplace
The inverse Laplace transform of a transfer function F ( s )—on the Laplace s -domain—is given by the complex integral $$\begin{aligned} f(t) = {\mathcal {L}} ^{-1}\{F\}(t) = \lim _{T \rightarrow \infty }\frac{1}{2\pi i} \int _{\sigma - iT}^{\sigma + iT} e^{st}F(s)\mathrm {d}s, \end{aligned}$$ (55) where \(\sigma\) is any real number larger than the real parts of the poles of F . The numerical inverse Laplace (NILT) approach aims at approximating the above integral numerically. Such numerical methods apply also to cases where F is not rational as it is the case with fractional-order systems ( 55 ).
In the approach of De Hoog et al. , the integral which appears in Eq. ( 55 ) is cast as a Fourier transform which can then be approximated by a Fourier series followed by standard numerical integration (e.g., using the trapezoid rule) [ ]. Though quite accurate for a broad class of functions, these methods are typically very demanding from the computational point of view. An implementation of the above method is available online [ ].
In special cases analytical inversion can be done by means of Mittag-Leffler function [ , ]. A somewhat different approach is taken by [ ], where authors approximate \(e^{st}\) , the kernel of the inverse Laplace transformation, by a function of the form \(\tfrac{e^{st}}{1 + e^{-2a}e^{2st}}\) and choose a appropriately so as to achieve an accurate inversion.
In general, numerical inversion methods can achieve high precision, but they are not suitable for control design purposes, especially for optimal control problems. Moreover, there is not one single method that gives the most accurate inversion for all types of functions. An overview of the most popular inversion methods used in engineering practice is given in [ ].
Drug administration for fractional pharmacokinetics
Approaches for drug administration scheduling can be classified according to the desired objective into methods where (i) we aim at stabilising the concentration in certain organs or tissues towards certain desired values (set points) [ ] and (ii) the drug concentration needs to remain within certain bounds which define a therapeutic window [ ].
Another level of classification alludes to the mode of administration where we identify the (i) continuous administration by, for instance, intravenous continuous infusion, (ii) bolus administration, where the medicine is administered at discrete time instants [ , ] and (iii) oral administration where the drug is administered both at discrete times and from a discrete set of dosages (e.g., tablets) [ ].
Drug administration is classified according to the way in which decisions are made in regard to how often, at what rate and/or what amount of drug needs to be administered to the patient. We can identify (i) open-loop administration policies where the patient follows a prescribed dosing scheme without adjusting the dosage and (ii) closed-loop administration where the dosage is adjusted according to the progress of the therapy [ ]. The latter is suitable mainly for hospitalised patients who are under monitoring and where drug concentration measurements are available or the effect of the drug can be quantified. Such is the case of controlled anaesthesia [ ]. However, applications of closed-loop policies extend beyond hospitals, such as in the case of glucose control in diabetes [ ].
Despite the fact that optimisation-based methods are well-established in numerous scientific disciplines along with their demonstrated advantages over other approaches, to date, empirical approaches remain popular [ , , , ].
In the following sections we propose decision making approaches for optimal drug administration using as a benchmark a fractional two-compartment model using, arbitrarily and as a benchmark, the parameters values of amiodarone. We focus on the methodological framework rather than devising an administration scheme for a particular compound. We discuss three important topics in optimal administration of compounds which are governed by fractional pharmacokinetics. Next, we formulate the drug administration problem as an optimal control problem we prescribe optimal therapeutic courses to individuals with known pharmacokinetic parameters. Lastly, we design optimal administration strategies for populations of patients whose pharmacokinetic parameters are unknown or inexactly known. We present an advanced closed-loop controlled administration methodology based on model predictive control.
Individualised administration scheduling
In this section we present an optimal drug administration scheme based on the two-compartment fractional model of Eqs. ( 36a , 36b ) and assuming that the drug is administered into the central compartment continuously. We will show that the same model and the same approach can be modified to form the basis for bolus administration.
In order to state the optimal control problem for optimal drug administration we first need to discretise the two-compartment model ( 36a , 36b ) with a (small) sampling time \(t_c\) $$\begin{aligned} t_c^{-1}(x_{k+1}-x_{k}) = Ax_k + F \,{^{\mathrm {gl}}\Delta }^{1 - a}_{t_c,\nu } x_k + Bu_k \end{aligned}$$ (56) where \(x_k = \left[ q_1( kt_c) \,\, q_2( kt_c) \right] '\) and \(u_k\) is the administration rate at the discrete time k . The left hand side of ( 56 ) corresponds to the forward Euler approximation of the first-order derivative, and we shall refer to \(t_c=[10^{-2}]{days}\) as the control sampling time . On the right hand side of ( 56 ), \({^{\mathrm {gl}}\Delta }^{1 - a}_{t_c,\nu }\) has replaced the fractional-order operator \(_{0}^{\mathrm {c}}\mathrm {D}_t^{1-\alpha }\) . Matrices A , F and B are $$\begin{aligned} A = \begin{bmatrix} -(k_{12} + k_{10})&0 \\ k_{21,f}&0 \\ \end{bmatrix}, F = \begin{bmatrix} 0&k_{21,f} \\ 0&-k_{21,f} \\ \end{bmatrix}, B = \begin{bmatrix} 1\\ 0\\ \end{bmatrix}. \end{aligned}$$ (57) The discrete-time dynamic equations of the system can now be stated as $$\begin{aligned} x_{k+1} = x_k + t_c \bigg ( Ax_k + \frac{F}{t_c^{1-a}} \sum _{j = 0}^{\nu } c_j^{1-a}x_{k-j} + Bu_k \bigg ), \end{aligned}$$ (58) where \(c_j^\alpha = (-1)^j\left( {\begin{array}{c}\alpha \\ j\end{array}}\right)\) . By augmenting the system with past values as \(\mathbf {x}_k = (x_k,x_{k-1},\dots ,x_{k-\nu + 1})\) we can rewrite Eq. ( 58 ) as a finite-dimension linear system $$\begin{aligned} \mathbf {x}_{k+1} = \hat{A} \mathbf {x}_k + \hat{B}u_k. \end{aligned}$$ (59) Matrices \(\hat{A}\) and \(\hat{B}\) are straightforward to derive and are given in [ ]. The therapeutic session will last for \(N_d = N t_c = 7\, {{\rm {days}}}\) in total, where N is called the prediction horizon . Since it is not realistic to administer the drug to the patient too frequently, we assume that the patient is to receive their treatment every \(t_d= 0.5\, {{\rm{days}}}\) . The administration schedule must ensure that the concentration of drug in all compartments never exceeds the minimum toxic concentration limits while tracking the prescribed reference value as close as possible. To this aim we formulate the constrained optimal control problem [ ] $$\begin{aligned} \min _{ u_0,\ldots , u_{N_d-1}}J&= \sum _{k=0}^{{N_d}/{t_c} + 1} (x_{\mathrm {ref},k} - x_k)' Q (x_{\mathrm {ref},k} - x_k) \end{aligned}$$ (60a) subject to the constraints $$\begin{aligned} \mathbf {x}_{k+1}&= \hat{A} \mathbf {x}_k + \hat{B} u_j, \quad \text { for } \ k t_c = j t_d\end{aligned}$$ (60b) $$\begin{aligned} \mathbf {x}_{k+1}&= \hat{A} \mathbf {x}_k, \quad \text { otherwise}\end{aligned}$$ (60c) $$\begin{aligned} 0\,&\le\,x_{k}\,\le\,0.5 \end{aligned}$$ (60d) $$\begin{aligned} 0\,&\le\,u_{j} \le 0.5 \end{aligned}$$ (60e) for \(k\,=\,0,\ldots , N\) ; \(j\,=\,0,\ldots , N_d-1\) .
In the above formulation \(x_{\mathrm {ref},k}\) is the desired drug concentration at time k and operator \('\) denotes vector transposition. Any deviation from set point is penalised by a weight matrix Q , where here we chose \(Q= \mathrm {diag}([0\;1])\) . Note that we are tracking only the second state. Our underlying GL model has a relative history of \(t_c \nu = 5 {{\rm{days}}}\) . Optimal drug concentrations are denoted by \(u^\star _k\) , for \(k = 0,\dots , N_d-1\) and they correspond to dosages administered intravenously at times \(kt_d\) . In the optimal control formulation we have implicitly assumed that \(t_d\) is an integer multiple of \(t_c\) , which is not restrictive since \(t_c\) can be chosen arbitrarily. In Fig. 5 we present the pharmacokinetic profile of a patient following the prescribed optimal administration course.
Finally, the problem in Eqs. ( 60a – 60e ) is a standard quadratic problem with simple equality and inequality constraints that can be solved at low computational complexity. Such problems can be easily formulated in YALMIP [ ] or ForBES [ ] for MATLAB or CVXPY [ ] for Python. Fig. 5 Drug administration scheduling via optimal control. The behaviour of the controlled system was simulated using the ABMPC method (dashed red line). The predicted pharmacokinetic profile using the Grünwald-Letnikov approximation (solid blue line) and fde12 are indistinguishable. The set-point on \(q_2\) (dashed orange line) and the maximum allowed concentration (black solid lines) are shown in the figure (Color figure online)
The optimal control framework offers great flexibility in using arbitrary system dynamics, constraints on the administration rate and the drug concentration in the various compartments, and cost functions which encode the administration objectives.
The quadratic function which we proposed in Eqs. ( 60a – 60e ) is certainly not the only admissible choice. For instance, other possible choices are 1. \(J = \sum _{k=0}^{{N_d}/{t_c} + 1} (x_{\mathrm {ref},k} - x_k)' Q (x_{\mathrm {ref},k} - x_k) + \beta u_k^2\) , where we also penalise the total amount of drug that is administered throughout the prediction horizon, 2. \(J = \sum _{k=0}^{{N_d}/{t_c} + 1} \mathrm{dist}^2(x_k, [{\underline{x}}, \bar{x}])\) , where \([{\underline{x}}, \bar{x}]\) is the therapeutic window and \(\mathrm{dist}^2(\cdot , [{\underline{x}}, \bar{x}])\) is the squared distance function defined as \(\mathrm{dist}^2(x_k, [{\underline{x}}, \bar{x}]) = \min _{z_k} \{\Vert x_k-z_k\Vert ^2;\ {\underline{x}} \le z_k \le \bar{x}\}\) .
Administration scheduling for populations
In the previous section, we assumed that the pharmacokinetic parameters are known aiming at an individualised dose regimen. When designing an administration schedule for a population of patients—without the ability to monitor the distribution of the drug or the progress of the therapy—then J becomes a function of the pharmacokinetic parameters (in our case \(k_{10}\) , \(k_{12}\) , \(k_{21,f}\) and \(\alpha\) ). That said, J becomes a random quantity which follows an—often unknown or inexactly known—probability distribution. In order to formulate an optimal control problem we now need to extract a characteristic value out of the random quantity J . There are two popular ways to do so leading to different problem statements.
First, we may consider the maximum value of J , \(\max J\) , over all possible values of \(k_{10}\) , \(k_{12}\) , \(k_{21,f}\) and \(\alpha\) . This leads to robust or minimax problem formulations which consist in solving [ ] $$\begin{aligned} \min _{ u_0,\ldots , u_{N_d-1}} \max _{k_{10}, k_{12}, k_{21,f},\alpha } J\left( u_0,\ldots , u_{N_d-1}, k_{10}, k_{12}, k_{21,f},\alpha \right) , \end{aligned}$$ (61) subject to the system dynamics and constraints. In Eq. ( 61 ), the maximum is taken with respect to the worst-case values of \(k_{10}\) , \(k_{12}\) , \(k_{21,f}\) and \(\alpha\) , that is, their minimum and maximum values. Apparently, the minimax approach does not make use of any probabilistic or statistical information which is typically available for the model parameters. As a result, it is likely to be overly conservative and lead to poor performance. Fig. 6 Drug administration to a population of 100 (randomly generated) individuals by stochastic optimal control. The yellow thin lines correspond to the predicted individual responses to the administration and the black lines represent the average response (Color figure online)
On the other hand, in the stochastic approach we minimise the [ ] expected cost \(\mathbb {E}J\) $$\begin{aligned} \min _{ u_0,\ldots , u_{N_d-1}} \mathbb {E}_{k_{10}, k_{12}, k_{21,f},\alpha }\ J\left( u_0,\ldots , u_{N_d-1}, k_{10}, k_{12}, k_{21,f},\alpha \right) , \end{aligned}$$ (62) subject to the system dynamics and constraints. Open-loop stochastic optimal control methodologies have been proposed for the optimal design of regimens under uncertainty for classical integer-order pharmacokinetics [ , , ], yet, to the best of our knowledge, no studies have been conducted for the effectiveness of stochastic optimal control for fractional pharmacodynamics.
The expectation in Eq. ( 62 ) can be evaluated empirically given a data-set of estimated pharmacokinetic parameters \((k_{10}^{(i)}, k_{12}^{(i)}, k_{21,f}^{(i)},\alpha ^{(i)})_{i=1}^{L}\) by minimising the sample average of J , that is $$\begin{aligned} \min _{ u_0,\ldots , u_{N_d-1}} \tfrac{1}{L}\sum _{i=1}^{L} J\left( u_0,\ldots , u_{N_d-1}, k_{10}^{(i)}, k_{12}^{(i)}, k_{21,f}^{(i)},\alpha ^{(i)}\right) . \end{aligned}$$ (63) The effect of L on the accuracy of the derived optimal decisions is addressed in [ ] where probabilistic bounds are provided. Simulation results with the stochastic optimal control methodology on a population of 100 patients using \(L=20\) are shown in Fig. 6 . Note that in both the minimax and the stochastic approach, a common therapeutic course \(u_0,\ldots , u_{N_d-1}\) is sought for the whole population of patients.
In stochastic optimal control it is customary to adapt the state constraints in a probabilistic context requiring that they be satisfied with certain probability, that is $$\begin{aligned} \mathrm {P}[x_k \le x_{\max }] \ge 1-\beta , \end{aligned}$$ (64) where \(\beta \in [0,1]\) is a desired level of confidence. Such constraints are known as chance constraints or probabilistic constraints . Such problems, unless restrictive assumptions are imposed on the distribution of \(x_k\) , lead to nonconvex optimisation problems and solutions can be approximated by Monte Carlo sampling methods ([ ], Sect. 5.7.1) or by means of convex relaxations known as ambiguous chance constraints where ( 64 ) are replaced by \(\mathrm {AV@R}_{\beta }[x_k] \le x_{\max }\) , where \(\mathrm {AV@R}_{\beta }[x_k]\) is the average value-at-risk of \(x_k\) at level \(\beta\) ([ ], Sect. 6.3.4).
The minimax and the expectation operator are the two “extreme” choices with the former relating to complete lack of probabilistic information and the latter coming with the assumption of exact knowledge of the underlying distribution of pharmacokinetic parameters. Other operators can be chosen to account for imperfect knowledge of that distribution, therefore, bridging the gap between minimax and stochastic optimal control. Suitable operators for optimal control purposes are the coherent risk measures which give rise to risk-averse optimal control which is the state of the art in optimisation under uncertainty [ ].
Model predictive control
Model predictive control fuses an optimal control open-loop decision making process with closed-loop control when feedback is available. Following its notable success and wide adoption in the industry, MPC has been proposed for several cases of drug administration for drugs that follow integer-order kinetics such as erythropoietin [ ], lithium ions [ ], propofol for anaesthesia [ ] and, most predominantly, insulin administration to diabetic patients [ , , , ].
In MPC, at every time instant, we solve an optimal control problem which produces a plan of future drug dosages over a finite prediction horizon by minimising a performance index J . The future distribution of the drug in the organism is predicted with a dynamical model such as the ones based on the Grünwald-Letnikov discretisation presented in the previous sections. Out of the planned sequence of dosages, the first one is actually administered to the patient. At the next time instant, the drug concentration is measured and the same procedure is repeated in a fashion known as receding horizon control [ ].
A fractional variant of the classical PID controller, namely a PI \(^{\lambda }\) D \(^\mu\) fractional-order controller, has been proposed in [ ] for the controlled administration. However, the comparative advantage of MPC is that it can inherently account for administration rate, drug amount and drug concentration constraints which are of capital importance. In [ , ], the truncated Grünwald-Letnikov approximation serves as the basis to formulate MPC formulations with guaranteed asymptotic stability and satisfaction of the constraints at all time instants. We also single out impulsive MPC, which was proposed in [ ], which is particularly well-suited for applications of bolus administration where the patient is injected the medication (e.g., intravenously), thus abruptly increasing the drug concentration. In such cases, it is not possible to achieve equilibrium, but instead the objective becomes to keep the concentration within certain therapeutic limits. Model predictive control can further be combined with stochastic [ , ] and risk-averse [ ] optimal control aiming at a highly robust administration that is resilient to the inexact knowledge of the pharmacokinetic parameters of the patient as well as potential time varying phenomena (e.g., change in the PK/PD parameter values due to illness, drug-drug interactions and alternations due to other external influences).
Furthermore, in feedback control scenarios, state information is often partially available. For example, when a multi-compartment model is used, concentration measurement from only a single compartment is available. As an example, in the case of multi-compartment physiologically based models, we would normally only have information from the blood compartment. In such cases, a state observer can be used to produce estimates of concentrations or amounts of drug in compartments where we do not have access. A state observer is a dynamical system which, using observations of (i) those concentrations that can be measures and (ii) amount or rate of administered drug at every time instant, produces estimates \(\hat{q}_i\) of those amounts/concentrations of drug to which we do not have access. State observers are designed so that \(\hat{q}_i(t) - q_i(t)\rightarrow 0\) as \(t\rightarrow \infty\) , that is, although at the beginning (at \(t=0\) ) we only have an estimate \(\hat{q}_i(0)\) of \(q_i(0)\) , we shall eventually obtain better results which converge to the actual concentrations. State observers, such as the Kalman filter, have been successfully employed in the administration of compounds following integer-order dynamics [ ] including applications of artificial pancreas [ , ].
Observers are, furthermore, employed to filter out measurement errors and modelling errors. When the system model is inexact, the system dynamics in Eq. ( 59 ) becomes $$\begin{aligned} \mathbf {x}_{k+1} = \hat{A} \mathbf {x}_k + \hat{B}u_k + d_k, \end{aligned}$$ (65) where \(d_k\) serves as a model mismatch term. We may then assume that \(d_k\) follows itself some dynamics often as trivial as \(d_{k+1}=d_k\) . We may then formulate the following linear dynamical system with state \((\mathbf {x}_k,d_k)\) $$\begin{aligned} \begin{bmatrix} \mathbf {x}_{k+1}\\d_{k+1} \end{bmatrix} = \begin{bmatrix} \hat{A}&I\\ 0&I \end{bmatrix} \begin{bmatrix} \mathbf {x}_k\\d_k \end{bmatrix} + \begin{bmatrix} \hat{B}\\0 \end{bmatrix} u_k, \end{aligned}$$ (66) and build a state observer for \((\mathbf {x}_k,d_k)\) jointly. The estimates \((\hat{\mathbf {x}}_k,\hat{d}_k)\) are then fed to the MPC. This leads to an MPC formulation known as offset-free MPC [ ] that can control systems with biased estimates of the pharmacokinetic parameters.
Model predictive control is a highly appealing approach because it can account for imperfect knowledge of the pharmacokinetic parameters of the patient, measurement noise, partial availability of measurements and constraints while it decides the amount of administered drug by optimising a cost function thus leading to unparalleled performance. Moreover, the tuning of MPC is more straightforward compared to other control approaches such as PID or fractional PID. In MPC the main tuning knob is the cost function J of the involved optimal control problem which reflects and encodes exactly the control objectives.
Conclusions
Fractional kinetics offers an elegant description of anomalous kinetics, i.e., non-exponential terminal phases, the presence of which has been acknowledged in the pharmaceutical literature extensively. The approach offers simplicity and a valid scientific basis, since it has been applied in problems of diffusion in physics and biology. It introduces the Mittag-Leffler function which describes power law behaved data well, in all time scales, unlike the empirical power-laws which describe the data only for large times. Despite the mathematical difficulties, fractional pharmacokinetics offer undoubtedly a powerful and indispensable approach for the toolbox of the pharmaceutical scientist.
Solutions of fractional-order systems involve Mittag-Leffler-type functions, or other special functions whose numerical evaluation is nontrivial. Several approximation techniques have been proposed as we outlined above for fractional systems with different levels of accuracy, parsimony and suitability for optimal administration scheduling or control. In particular, those based on discrete time-domain approximations of the system dynamics with bounded approximation error, such as the truncated Grünwald-Letnikov approximation, are most suitable for optimal control applications. There nowadays exist software that implement most of the algorithms that are available in the literature and facilitate their practical use. Further research effort needs to be dedicated in deriving error bounds in the time domain for available approximation methods that will allow their adoption in optimal control formulations.
The optimal control framework is suitable for the design of administration courses both to individuals as well as to populations where the intra-patient variability of pharmacokinetic parameters needs to be taken into account. In fact, stochastic optimal control offers a data-driven decision making solution that enables us to go from sample data to administration schemes for populations. Optimal control offers great flexibility in formulating optimal drug dosing problems and different problem structures arise naturally for different modes of administration (continuous, bolus intravenous, oral and more). At the same time, further research is necessary to make realistic assumptions and translate them into meaningful optimisation problems.
MPC methodologies are becoming popular for controlled drug administration. Yet, their potential for fractional-order pharmacokinetics and their related properties, especially in regard to stochastic systems and the characterisation of invariant sets, needs to be investigated.
Overall, at the intersection of fractional systems theory, pharmacokinetics, numerical analysis, optimal control and model predictive control, spring numerous research questions which are addressed in the context of mathematical pharmacology.