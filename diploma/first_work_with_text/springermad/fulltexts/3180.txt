Introduction
Frequently, errors that can cause patient death and serious adverse reactions are made when preparing compounded sterile preparations (CSP’s) using incorrect and defective materials [ ] and when the person who is performing the compounding uses an incorrect method or procedure. Additionally, wrong decisions may be made in the stressful and often demanding environment of the clean room where CSP’s are made due to personnel fatigue [ ]. A wrong vial containing an injection that has a label similar to the required medication may be picked erroneously, causing eventual fatality. Even when the final CSP is released for patient administration after inspection and verification by the pharmacist, if an incorrect method was used when making the compounded injection, it can lead to deleterious effects and adversely affect patient health [ , ].
Compounded sterile preparations made national news in the US following the tragic death of several patients spanning numerous states in 2012 [ ]. Several reviews on the topic of safety of compounded sterile preparations, published prior to this tragedy and after, point to the prevalence of wide-ranging issues, including failure to meet specifications [ ], contamination and/or sterility problems [ , ], raw material purity issues [ ], errors related to potency [ ], content uniformity [ ], and labeling [ ]. Quantitatively, the Institute for Safe Medication Practices (ISMP) reported that in a five-hospital observational study that evaluated the accuracy of various types of CSP’s, a mean error of 9% was observed (approximately 1 in 10 CSP’s being prepared incorrectly prior to dispensing) [ ]. In another study, a patient event from a compounding error was reported in approximately 30% of surveyed hospitals over a 5-year period [ ]. A recent survey of practices related to CSP’s in US hospitals show that integration, adoption, and updating of innovation and technology in this field are severely limited [ ]. The current methods to evaluate, monitor, and correct these issues are based on direct personnel supervision and self-reporting. Thus, errors are identified after a minor or major event has occurred, followed by implementation of policies and procedures to limit, contain, and rectify the error. This approach, although helpful in verifying the cause of the problem and creating awareness of it among clinicians, is unable to prevent such events from occurring again. The introduction of checklists has been suggested to be useful in a variety of situations where there is high probability of process-based errors [ , ]. The earliest evidence for use of checklist-based decision support can be seen in aviation and other engineering fields. An intelligent decision support system based on integration of foundational knowledge, material properties, process selection, and equipment use for dosage form development has been proposed for use in the pharmaceutical industry during dosage form development [ ]. Adoption of this type of strategy in the healthcare field has been slow but was initiated through use in nursing and in select areas of medicine and surgery [ , ]. Numerous studies published in the recent past illustrate that the introduction of checklist-based systems in healthcare and medicine has led to significant decreases in errors, substantial cost reduction, better patient outcomes, and thousands of lives saved [ , , , , , ].
Until now, there has been no attempt to augment the existing compounded sterile preparations environment. Efforts to completely automate the preparation environment via robots are excessively and prohibitively expensive. In this study, an object and image tracking-based software system that can provide real-time support to identify and select materials, followed by monitoring, evaluation, and feedback during preparation of a compounded sterile preparation (CSP), was developed. A touch-free, gesture-controlled tool has been integrated into the system to enable hands-free navigation through the system, so as to simplify operating the system and minimize contamination risk from touch [ ]. This system offers a cost-effective and user-friendly solution to problems encountered when preparing CSP’s. A major innovation of this project is that it incorporates advances in digital and computational techniques in the CSP environment to reduce human error and ensure quality of the compounded preparation. Another important aspect of the project is the use of sensors such as barcode scanners and digital cameras to identify potential errors through object tracking, image tracking, and feedback mechanisms. A computational support system (CSS) that helps to select proper materials before compounding and is capable of monitoring the procedure continuously and providing real time feedback to personnel preparing injections will help to address the problems related to CSP’s. The system enables easy identification of material to be used when preparing an injection by coupling a standard barcode scanner to an image database. After properly identifying, selecting, and verifying the items, the technician can then proceed to perform the compounding process. During this time, image analysis and real-time monitoring of the procedure are performed through a strategically placed digital camera. As key points are reached during the compounding process, the program will provide feedback to the personnel regarding the validity and propriety of the steps used during injection preparation.
The whole compounding process is generally characterized by various standard operation procedures. The procedures are formulated based on institutional policies of a particular hospital or compounding facility by taking into account the guidelines published in the United States Pharmacopeia General Chapter <797> [ ], manufacturer’s recommendations available through package inserts accompanying injections that are used in compounding, and other guideline documents [ , ]. Some generalizations can be made regarding the procedure to be used when preparing an injection, based on the nature of the compounded preparation being made. We have selected three commonly encountered CSP’s (shown in Fig. 1 ), including one compound involving an injection available in an ampule referred to as medication order-1 (MO-1); a second preparation in which a certain volume of sterile liquid injection is withdrawn from a vial during the compounding process, called medication order-2 (MO-2); and a third type in which a sterile powder for injection is reconstituted, called medication order-3 (MO-3). All three CSP’s have varying degrees of difficulty and complexity during compounding. The procedure used to prepare a particular CSP was developed from existing practices and guidelines and incorporated into the interactive decision support system (DSS), which is part of the CSS created, tested, and evaluated in this project. The procedure was further transformed into a sequence of steps comparable to a checklist-type visual aid that will help the technician to navigate through the compounding procedure effortlessly [ ]. Fig. 1 Medication orders for (a) promethazine HCl infusion MO-1, (b) labetalol HCl MO-2, and (c) protonix MO-3
Materials and Methods
All experiments and testing were done in a horizontal laminar airflow hood that is approved, tested, and routinely used to train PharmD students to compound CSP’s in an instructional compounding laboratory. The semi-automatic system developed and tested contains two separate interfaces equipped with required hardware. The system can be further divided into the following two major subsystems.
Subsystem 1: Material Selection System (MSS)
The MSS is a barcode scanner subsystem comprising of a barcode reader (Magellan 1100i Barcode Scanner, Datalogic ADC Inc., Eugene, OR) along with a Graphical User Interface (GUI) (developed on Microsoft Visual Studio 13 using C#.net framework) designed specifically for selecting materials such as ampules, vials, IV bags, needles, syringes, and alcohol swab pad that are used to prepare a particular type of CSP [ ]. The flowchart of the MSS is shown in Fig. 2 . The first step during MSS usage is to perform all necessary calculations and select the appropriate items from those available for the CSP ordered by the physician. After this, the compounding procedure is selected (such as “Protonix reconstitution”). The next step is to assemble and choose the material available on the shelves for compounding. When the item (medication or medical equipment such as syringe, needle, etc.) is scanned using the barcode scanner, the barcode will be read and the MSS will check and verify the item based on the technician’s earlier selection of the compounding procedure. When the technician choses a wrong item, the system provides a vocal feedback message and prevents the compounding process to proceed to the next step until the mistake is rectified. This is made possible by connecting the GUI with a backend database. The database stores information about the medication and medical equipment, including category, name, size, concentration, date of expiry, and the corresponding barcode. These fields help to precisely select the correct medication and medical equipment through the GUI. Once all the correct items—including the correct medication, IV bag, and material such as needles and syringes—have been collected and staged in the Laminar Airflow Workbench (LAFW), the MSS proceeds to the next step in compounding. Next, the system shows the actual procedure to be followed in a sequential order from start to end, with appropriate audio and imagery related to a particular step on the GUI window so that the technician can see, hear, or read the compounding procedure. The technician can turn on the audio when the procedure text is displayed so as to enable the read-out-loud function when needed. Fig. 2 Flowchart of material selection system for proper selection of items
The MSS has the following seven elements as parts of the system.
Compounding Calculator
The compounding calculator element was thought to be an essential part of this system since a large number of preventable medication errors from CSP’s have been found to be due to a calculation-related or mathematical mistake [ , ]. The starting window of the application has an embedded basic arithmetic calculator in which the technician provides the dose required in milligrams (mg) and the concentration of medication in milligrams per milliliter (mg/ml). The volume of injection required to compound the CSP will be computed in milliliters. The calculation window is independent of the rest of the application program and uses a separate panel background color to denote a property.
Item Selector
The MSS has an item selector interface that contains category, name and size fields for quick and easy selection of material. A tree-based architecture was used in the database to store the properties of medications. This feature helps the interface design to show only the names of the selected category and all the sizes of the selected name and category in a combo box. The user first selects a category such as vial, syringe, ampule, and IV bag. Subsequently, the combo box is updated and shows only the item(s) that matches the category previously selected in the category combo box. Then, the user selects the next field which is the “name” in the name combo box. Following this, the size combo box is updated and displays available sizes that match with the previously selected category and name. At this stage, the correct size can be selected.
Expiration Date-Check
When a particular medication is selected the expiration date check automatically verifies the date of expiry. This is an important safety check point since medications past its expiration date may have its quality compromised and hence can adversely affect the health and safety of patients. If the selected item is expired, then the technician will not be permitted to go beyond this point until that mistake is corrected. The expiration date-check compares the stored expiry date of a medication in the database with the date when the item is being selected for preparing a CSP and displays an appropriate recommendation.
Image Confirmation
When an item is selected, the image confirmation element in the MSS will display the corresponding image of that item on screen allowing the user to visually check and verify if the correct item is being selected for use in the CSP. This feature is made possible in the interface by placing a link of the item image in the database so that the program will load an image based on the stored link when the item is selected.
Database Operation
The database used in this system is a local database connected to the MSS interface application using a connection string. The database has a table to store information about the medication, with columns that store information such as barcode data, category, name, image link, expiration date, and concentration in mg/ml. The table is organized in a manner such that columns contain discrete types of information while rows array the number of data stored in the database. There are basic buttons to add, edit and delete information from the database. New information will be automatically updated to every window when a change is presented.
Read-Out-Loud and Visual Aid
For a particular CSP preparation procedure, all critical and necessary steps are listed on various pages of a tab. Each page exhibits the steps in text format of sufficiently large and visible font size to be used after a previous step has been followed and concluded. These steps can also be read out loud with an optional speak button placed on each page. There is also a picture that displays each particular step on a side screen so that the technician can crosscheck the activities being performed to the visual and audio.
Barcode Reader
Barcodes have universally become a quick and easy method to identify various kinds of material in all walks of life. Due to the size, shape, and volume of medications and medical equipment, the healthcare field uses very unique kinds of barcode symbologies such as linear 1D, stacked 1D, and 2D categories. The various types typically encountered are EAN-14, GS1-128 stacked, GS1-128 limited, GS1-128 truncated, GS1 data-bar, etc. The MSS employs a Magellan 1100i omnidirectional presentation scanner manufactured by Datalogic S.p.A, Bologna, Italy. The scanner captures the image of the barcode using a high-quality imaging sensor, decodes it using a barcode-decoding algorithm, and gives the barcode to a PC transmitted serially in a manner similar to that of a keyboard input. A flow chart of the barcode scanning process is shown in Fig. 3 . Fig. 3 Flowchart of barcode reading process of material selection system
Subsystem 2: Video Processor System (VPS)
Once the proper material has been selected using the MSS, the CSP compounding process can start. The compounding process is monitored using a digital camera (Webcam C615, Logitech, Newark, CA) fixed to the LAFW at the proper orientation. The primary objective of VPS is to analyze the technician’s compounding procedure in real time to issue accurate and timely warnings when mistakes occur. The experimental and system setups (Fig. 4 ) that are needed to run the VPS in real time are enumerated below. Fig. 4 Schematic diagram of the experimental setup in the LAFW
Weighted Frame Correlation Technique (VPS.01)
The camera position was fixed so that when compounding is performed, the images captured will have good spatial and temporal resolution. This arrangement helps to reduce the computational overhead to register the object position in new image frame. Video capturing generally occurs at 25 to 30 frames per second (fps), but in the VPS it was reduced to 10 (fps) by taking into consideration the fact that information will not change in the millisecond time range. The video has distinct sequential stages unique for each compounding procedure.
To compute the similarity of input video frames with previously defined stages, there are 25 images for each stage that are used as reference for correlation calculation. As we are considering 10 frames per second, the total window considers 2.5 s of video for analysis as reference. The correlation values are filtered by the window, as shown in Fig. 5 , and the cumulative similarity of the video frame to each stage is calculated. Whichever stage has the highest similarity value will be the most probable candidate for registration in the weighted frame correlation. The flowchart of VPS.01 is shown in Fig. 6 . The algorithm for weighted frame correlation decides which stage the current frame indicates based on similarity calculation and probability. Probability signifies the likeliness of occurrence of a particular stage based on the previous stage registered. Fig. 5 Window model for weighted frame correlation calculation (VPS.01) Fig. 6 Flowchart of weighted frame correlation technique (VPS.01)
Component Detection Technique (VPS.02)
The approach discussed here is to detect various steps used during the compounding procedure in a sequential manner and analyze the steps to determine whether steps are missed. The imaging region within the LAFW was confined to the field of view of the camera lens and had a finite boundary drawn along the region. The item placement areas were fixed within this region and referred to as the region-of-interest (ROI). To detect items such as an IV bag, ampule, vial, syringe, filter needle, regular needle, and alcohol swab pad, object detection using SURF (Speeded up Robust Features) was implemented [ ]. SURF object detection helps to detect the template object in an image containing several objects. The detection scheme was implemented for each item that was going to be used during a compounding process. Thus, by applying object detection, we can obtain the position of each item and select the region of interest in the image frame based on the placement area of a particular item. The general flowchart of VPS.02 is shown in Fig. 7 . Fig. 7 General work flow in the component detection technique used in VPS.02 and VPS.03
Modified Component Detection Technique (VPS.03)
In the modified component detection technique (VPS.03), to reduce the processing time for item detection, the search zone for item detection was limited by creating marked rectangular areas inside the LAFW. Only one particular type of item can be placed in each rectangular area, as indicated by A-F shown in Fig. 4 . This minor modification of limiting the random positioning of items substantially reduced the detection time and the algorithm was realized in real time.
Testing the Robustness of VPS.03 to Detect Errors
The ability of the system to detect errors made during the compounding process was tested by deliberately making mistakes during the compounding process. Some common mistakes were recorded for the three standard compounding procedures used in this system. The mistakes that were made are skipping cleaning stage, not using filter needle, not using regular needle, not using medication, and not following the correct sequence of events in a particular procedure.
Results and Discussion
The medication order for each CSP was processed in a manner identical to how it will be handled in the IV compounding room of an in-patient hospital pharmacy. One CSP was compounded at a time, and the procedure started with the material selection being tracked by the MSS, followed by the compounding process being monitored by the VPS. The entire compounding procedure was performed with the implementation of various algorithms. The results from MSS were recorded by capturing screenshots of the computer GUI in the proper sequence. The VPS performed video processing by implementing various algorithms when the CSP’s such as ampule preparation, powder for reconstitution, and liquid injection vial were made in the LAFW.
Material Selection System
The MSS helped to select only the desired material needed for performing the compounding. A typical workflow during the material selection stage for preparing a CSP is shown in Fig. 8 . The example shown in the figure is the preparation of a labetalol injection. The items are selected first (Fig. 8a ), followed by the relevant procedure, as shown in Fig. 8b . Following this, the combo-box automatically enables selecting the first appropriate item that is needed to perform this compounding. In Fig. 8a , the item “syringe” is displayed under the category, followed by the name “luer-lock with needle”, and size/volume “3 ml” fields. In this manner, other items needed for compounding this CSP were selected including the syringe, sterile syringe tip cap, injection vial, and alcohol swab pad. After this, the items were gathered and scanned by clicking the “get barcode” button and bringing each item to the sensor of the barcode scanner (Fig. 8c ). When each item is scanned, its image will be displayed as is shown in the case of the needle and the labetalol vial shown in Fig. 8d , and 8e , respectively. Additionally, information coded in the barcode will be displayed in a box as well. Figure 8f also shows an example of an error message that is displayed when an item was scanned that does not match the material previously selected for that particular CSP. Similarly, if an item that is expired was scanned an error message will be displayed indicating that the particular item is date-expired and cannot be used. The MSS does not increase the item count and advances to the next stage only when the error has been rectified. In this manner, the MSS leads and guides the technician to accurately and precisely select the desired medication and medical equipment. The MSS window shown in Fig. 8a also shows the compounding calculator, which was used to calculate the volume of the injection that will provide the dose required for a patient, according to the medication order. An example CSP in which this feature was used was the labetalol injection that was withdrawn into a 3-ml syringe and capped with sterile syringe tip cap. According to the product label, the labetalol injection was available in a concentration of 100 mg/20 ml, and the dose required in the medication order was 15 mg. The dose required was typed into the “dose required” box, and the concentration of the injection that was used in the compounding was provided in the “concentration” box (Fig. 8a ). Following this, when the “get volume” button is clicked, the “volume req” window displays the volume of injection that is to be used in the CSP as 3 ml. This process will help to eliminate numerous errors that are typically observed in the CSP compounding setting, such as using wrong items for compounding, using the wrong procedure when preparing the CSP, and miscalculating the volume of injection needed to supply a dose in the CSP. The MSS functioned flawlessly during the compounding of all three CSP’s prepared in this work. Fig. 8 Output screenshots of MSS. (a) All selected items shown with barcode. (b) Selection of compounding procedure. ﻿(c)﻿ Barcode ﻿scanning. (d) scanned needle. (e) scanned labetalol vial. (f) error message for wrongly selected item﻿.
The GUI of the MSS was designed to address the shortcomings of currently existing practices in the IV compounding rooms. The system makes medication and materials selection very easy and has an expiration date check with visual confirmation when correct item is selected. This simplifies the tedious and manual item and label checking performed by technicians during item selection process. It also adds a simple compounding calculator that can calculate the volume required which avoids the use of an external calculator and thus helps to reduce contamination during compounding.
The MSS works on the assumption that the information in the database are current. If they are not updated, then the system may give an error message for even a correct medication that was not present in the database. Current practices in automated inventory control use this type of setup. Hence, eventually as this system is developed and expanded further, one of the options is to connect the existing hospital/pharmacy inventory systems to the proposed MSS.
Video Processing System
Compounding Procedure Monitoring Using Weighted Frame Correlation Technique (VPS.01)
The Phenergan infusion CSP (MO-1) was first selected to test the VPS.01 since it had the highest number of manipulations and steps involved during preparation. The camera fixed in position 1, as shown in Fig. 4 , collected the video. The five major stages and the corresponding abbreviations used in Table 1 during Phenergan infusion preparation are (1) cleaning stage (CS)—during this stage, the ampule and the compounding port in the 50 ml normal saline IV bag are cleaned; (2) opening syringe and needle stage (OSNS)—during this stage, the syringe and filter needle are taken out of the plastic wrapping material and the needle is attached to the syringe; (3) ampule break stage (ABS)—during this stage, the ampule is broken using proper technique; (4) changing needle stage (CNS)—during this stage, the filter needle is removed from the syringe that contains injection withdrawn from the ampule and a regular needle is attached to the syringe; and (5) injection into IV bag stage (IIBS)—this is the final stage of the CSP preparation when the injection in the syringe is slowly injected into the 50 ml NS IV bag through the compounding port. Image frames obtained from the video camera were fed into VPS, which calculated the correlation value of a current image frame when compared to each of the five stages described above using the filter window, as shown in Fig. 5 . Results obtained from three trials are shown in Table 1 . The correlation values obtained for each stage are similar within a particular test trial, but the value for a particular stage fluctuated among the three test trials. This led to improper and erroneous identification of the stage of infusion preparation. As an example, in test trial 1, the wrong stage was identified two times: once when the actual stage was ABS, it was wrongly identified as CNS, and the other mistake was when the IIBS stage was wrongly identified as CS. These two errors brought the accuracy of the VPS.01 down to 60% in test trial 1. The overall accuracy in the stage classification on all three trials was found to be 53.3 ± 11.5%, which is very low and insufficient to make it applicable on a CSP decision support system. Table 1 Correlation values and accuracy of VPS.01 for three trials of ampule preparation with five stages; cleaning stage (CS), opening syringe and needle stage (OSNS), ampule break stage (ABS), changing needle stage (CNS), and injecting into IV bag (IIBS). Trial Observed stage in video Stage detected by system Correlation value, \( \mathrm{Ci}={\displaystyle \sum_{i=1}^{25}\mathrm{Si}.\mathrm{Wi}} \) Accuracy (%) 1 CS CS 12.54 OSNS OSNS 11.32 ABS CNS 10.54 60 CNS CNS 12.45 IIBS CS 10.69 2 CS CS 13.12 OSNS ABS 11.25 ABS CNS 11.68 60 CNS CNS 12.65 IIBS IIBS 12.47 3 CS CS 13.55 OSNS OSNS 12.35 ABS CNS 11.56 40 CNS ABS 10.98 IIBS CS 11.67
The poor accuracy of VPS.01 was attributed to the camera position and the nature of the algorithm used to classify stages. Camera position 1 (as shown in Fig. 4 ) gave an angular side view of the compounding area and the items placed and used there. The algorithm used in VPS.01 uses the correlation between the whole image frame of a particular current image and reference images of each stage. During the compounding process, successive image frames had only small differences, leading to similar correlation values for each stage. This led to poor discretion between various compounding stages. Additional tests were performed after moving the camera to position 2 (as shown in Fig. 4 ), but only marginal improvement in accuracy was observed (data not shown). It was during this stage that it was noted that the processing time using VPS.01 was high and did not allow for implementation of this method as a DSS in real time. However, the algorithm did yield promising results with slight modifications, but the results and decision regarding the compounding process were obtained after completion of the CSP preparation. Thus, it was concluded that VPS.01, with some more modifications, may be useful when evaluating the compounding skills and technique of technicians or students in a training or educational laboratory.
Compounding Procedure Monitoring Using Component Detection Technique (VPS.02)
The low accuracy of VPS.01 led to the use of video acquisition orientation and the use of a component detection algorithm in compounding procedure monitoring. The camera position was fixed at position 2 in VPS.02. From the new camera position, better quality video and images were captured that enabled better differentiation between various items used in the CSP compounding process. Additionally, the use of ROI’s helped to reduce the search area for items placed within the area and enhanced item recognition. In VPS.02, rather than analyzing the whole image, the algorithm focuses on detecting each component (item) used in compounding and detects compounding stages based on whether that particular component (item) is utilized by the technician. As an example, in the CSP preparation involving use of an injection ampule, the first activity is to clean the appropriate IV bag and ampule using an alcohol swab pad. First, the technician will pick the alcohol pad from the alcohol swab pad area and then clean each of these items. During video processing, the hand-movement near the ROI of alcohol pad is detected. When hand-movement in the alcohol swab pad area is detected along with movement in the IV bag region and ampule region, then it can be concluded that the compounding process is in the cleaning stage. Hence, if hand-movement is detected toward other items without having movement at the alcohol swab pad along with concurrent movement in the IV bag and ampule regions, then it can be inferred that the cleaning stage was omitted during the compounding process. This is a critical error during the preparation of a CSP. After cleaning the ampule and IV bag, the next step is to open the syringe and assemble the filter needle. To detect this stage, hand-movement in the syringe and filter needle ROI’s were detected. The next step in the compounding process is the ampule breaking stage. Applying similar logic as described above during each stage, the progress of the compounding process was estimated during the entire compounding process.
When the system starts, VPS.02 first detects all the items required to prepare the CSP placed inside the hood with multiple scanning until it detects all the components. During the scanning, the region property (area and centroids) of each detected item is obtained. After all components placed inside the hood are detected, appropriate messages and warnings, when applicable, were displayed based on items being utilized during the compounding stage. The component detection stage in VPS.02 was accomplished using the surf detection technique, as shown in Fig. 9 . In this method, the items were placed randomly inside the LAFW in the item staging (placement) area that was in front of the working zone, as shown in Fig. 4 . During trial 1 of ampule preparation, as in Table 2 , all items except the ampule were detected. Detected items were indicated on the computer screen by rectangular boundaries of varied colors around the item. As shown in Fig. 9 , yellow, red, cyan, green, purple, and blue were used to represent the filter needle, regular needle, syringe, IV bag, and ampule, respectively. During the three trials, trial 1 failed to detect the ampule (1 item), trial 2 failed to detect the IV bag (1 item), and trial 3 failed to detect the ampule and the regular needle (2 items) (Table 2 ). If we consider all three trials together, it may be concluded that all the items were successfully detected, but there was still the likelihood of missing at least one item during a particular compounding process. All items placed inside the LAFW have to be detected by the VPS.02 to monitor and evaluate the compounding process and to function as a real-time decision support system. The principal time-consuming process in the component detection algorithm described was the proper detection of each item inside the LAFW. The rest of the processing absolutely relies on the perfection of this detection. The items used during compounding are small and can be placed in any orientation in the LAFW. This warranted extracting and comparing features from several different samples of a particular item, with the image frame captured as video via the digital webcam for detection of that particular item. The size of the sample population determines the accuracy of detection and the processing time. This led to significant lag time in processing and updating the progress of the compounding procedure. Hence, the implementation and running of the component detection part of the system was not realized in real time. Since the objective of the research is to develop DSS in real time, the observed detection time (DT) makes this algorithm not suitable to implement in VPS. The average detection time (DT) for a particular item during a single scanning in VPS.02 was found to be 71.9 ± 5.5 s. It was also found that the VPS.02 required at least five scans to completely detect all items in the LAFW, contributing to a total DT of approximately 6 min during the detection stage of the process. We estimated that to implement VPS.02 in real time, the detection process should at least be completed within 5 s from when VPS starts. This estimate was based on the observation that it generally took about 5 s from the time the camera started to when the technician actually began preparing the CSP using the items placed in the LAFW. Thus, the delayed DT did not allow for using VPS.02 to provide real-time support during the compounding process. However, VPS.02 can still be used to analyze and evaluate a pre-recorded video of the compounding process. Based on the results obtained from VPS.02, the process and algorithm were modified to develop VPS.03. Fig. 9 Original image frame, component detected image frame, and detection time (DT) of VPS.02 (MO-1) for three trials Table 2 Result of components detection during ampule preparation ﻿﻿﻿(MO-1)﻿﻿﻿ for three trials in VPS.02 Trial Item s on image frame Item detected by system Number of missed item (total item s = 6) 1 Filter needle, regular needle, syringe, ampule, swab pad, ID bag All items detected except ampule 1 2 Filter needle, regular needle, syringe, ampule, swab pad, ID bag All items detected except IV bag 1 3 Filter needle, regular needle, syringe, ampule, swab pad, ID bag All items detected except regular needle and ampule 2
Compounding Procedure Monitoring Using Modified Component Detection Technique (VPS.03)
An important change that was made in VPS.03 was that the item placing area in the LAFW was limited by drawing rectangular boxes using a green-colored marker inside which a particular item had to be placed before the compounding started (in Fig. 4 , boxes labeled A to F). In this configuration, the items were placed in the assigned specific rectangular areas before the compounding process started. The rectangular areas now limited the position and orientation of items, as shown in Fig. 10 . The pictures on the left side of the figure represent the items in the LAFW before detection and those on the right side show items after the detection was completed. When detection is completed, a colored rectangle will appear in the computer screen surrounding the object that was digitally detected. This process is identical to that described under VPS.02. Figure 10 shows the detection of items needed for MO-3 placed inside the LAFW. During the three trials, perfect detection of all the items was observed. Additionally, the detection time for compounding MO-3 was reduced to 505 ± 7.8 ms, making VPS.03 realizable in real time. Additionally, the detection times for MO-1 were 516 ± 9.1 ms and for MO-2 were 491 ± 10.6 ms. Although the position and orientation of items placed inside the LAFW had to be specifically set in VPS.03, this arrangement made the program provide real-time support during the compounding process. During preliminary testing with the MO-1 preparation, VPS.03 demonstrated high accuracy, excellent robustness, and the ability to provide real-time decision support during the compounding process. Hence, VPS.03 was tested systematically by implementing it during the preparation of MO-1, MO-2, and MO-3. The CSP required according to each medication order was prepared three times, and the compounding process was monitored and evaluated in real time during the process. Fig. 10 Original image frame, component detected image frame, and detection time (DT) for VPS.03 (MO-3) for three trials
Figure 11 shows data from VPS.03 when MO-1 was prepared. Figure 11a shows the detection of the cleaning stage, and the text highlighted with the red box within the screenshot indicates the prompt that the technician will be able to see, showing successful completion of the cleaning stage. Figure 11b shows the stage when the filter needle is attached to a 1-ml syringe, Fig. 11c shows the ampule breaking, Fig. 11d shows filter needle being switched with regular needle, and Fig. 11e shows the completion of the compounding process when the injection in the syringe is introduced into the IV bag. At each stage, the text highlighted with a surrounding red box displays the message corresponding to the successful detection of a particular step during the compounding process. MO-1 was repeated three times, and Table 3 summarizes the key findings during each experiment. As can be seen from the table, experiment I, which was a preparation of MO-1 (without any mistakes), was accurately detected, monitored, and evaluated in real time throughout various stages of compounding. Fig. 11 Output screenshots of VPS.03 of MO-1. (a) Cleaning stage. (b) Opening syringe and needle stage. (c) Ampule breaking ﻿stage. (d) Changing of needle stage. (e) Injecting medicine into IV bag. (f) Cleaning stage missed (mistake).﻿ Table 3 Summary of the results and discussion for 12.5 mg promethazine HCL (MO-1, ampule preparation) in VPS.03 Compound process Tests Descriptions Results Ampule preparation Experiment I (preparation of MO-1 without any mistakes) Compounding was performed 3 times without making any mistakes from technician The MATLAB program took video from web camera as input and frames were analyzed sequentially. Cleaning stage, opening syringe needle stage, ampule break stage, changing of needle stage, and injecting into IV bag stage were detected perfectly for all 3 trials. Experiment II (preparation of MO-1 with possible mistakes Compounding is performed under identical environment as in experiment I. Mistakes are introduced deliberately during the compounding process. a. Missing cleaning stage b. Not using filter needle c. Not using regular needle d. Injecting into IV bag without drawing medicine from ampule During compounding with mistakes, the program identified the mistakes mentioned in algorithm and responded accordingly. a. Program gave the warning message “Cleaning Stage Missed” and aborted the program. b. Program continued till the end and showed “Filter Needle not used” message at the end of program. c. Program continued till end and showed “Regular Needle not used” message at the end of program. d. The program displayed “Medicine not used” and aborted instantly.
Figure 12a displays the screenshot data during the first step of MO-2 compounding. In this picture, the labetalol vial was picked up for cleaning followed by completion of the task, as is shown in Fig. 12b . In Fig. 12c , the 3 ml syringe and 1 1/2 in. 18 G needle assembly are used to draw the required volume of injection from the vial. This is followed by the final step wherein the needle was removed and a sterile luer-lock syringe tip cap was attached to the syringe, as shown in Fig. 12d . The summary of observations made during MO-2 compounding is shown in Table 4 in the row titled “Experiment III.” Fig. 12 Output screenshots of VPS.03 of MO-2. (a) Vial picked up. (b) Cleaning completed. (c) Opening syringe and needle ( d ) syringe tip capped in the end. (e) Cleaning stage missed. (f) Syringe tip cap not used at the end [ (e) and (f) are mistakes]. Table 4 Summary of the results and discussion for 15 mg labetalol HCL (MO-2, injection vial preparation) in VPS.03 Compounding process Tests Descriptions Results Injection vial preparation Experiment III (preparation of MO-2 with no mistakes) Compounding was performed 3 times without making any mistakes. Program took image from web camera video, and analyzed frame to give cleaning stage, opening syringe needle stage, and finally syringe tip cap stage perfectly during all 3 trials. Experiment IV (preparation of MO-2 with possible mistakes) Compounding was conducted under identical environment as in experiment III, mistakes were introduced during compounding. a. Cleaning stage missed b. Syringe tip cap is not used During compounding process, mistakes were identified and responded accordingly. a. Program gave warning message “Cleaning Stage Missed” and aborted instantly. b. Program gave warning message “Cap is not used” and aborted instantly.
Figure 13a shows the IPA swab pad being picked to clean the IV bag when the compounding of MO-3 started. Subsequently, in Fig. 13b , the cleaning stage was detected. After this step, the needle was assembled onto the 10 ml syringe detected in Fig. 13c , and the syringe-needle assembly was detected being used to draw the proper volume of liquid from the 100 ml normal saline IV bag in Fig. 13d . The liquid in the syringe was used to reconstitute protonix powder in the vial shown in Fig. 13e , and the concluding step in this process occurred when the reconstituted (dissolved) protonix was injected into the IV bag in Fig. 13f . The key findings during the compounding of MO-3 are shown in Table 5 along the row “Experiment V.” VPS.03 functioned flawlessly when MO-3 was compounded. Fig. 13 Output screenshots of VPS.03 of MO-3. (a) Alcohol pad picked for cleaning IV bag. (b) Cleaning completed. (c) Opening syringe and needle. (d) IV bag picked up. (e) Powder vial picked up. (f) Reconstituted solution injected into the IV bag. Table 5 Summary of the results and discussion for 40 mg protonix reconstitution (MO-3, powder reconstitution preparation) in VPS.03 Compounding process Tests Descriptions Results Powder reconstitution preparation Experiment V (preparation of MO-3 with no mistakes) Compounding was performed 3 times without any mistakes. All items compounding stages were detected flawlessly for all 3 trials. Experiment VI (preparation of MO-3 with possible mistakes) Compounding was performed under identical environment but cleaning stage and medication using stage were missed in different trials. a. Technician went for syringe without going for alcohol swab pad. b. Technician injected syringe directly into IV bag without drawing liquid from vial. System analyzed image frames received from webcam and gave following messages and program ended instantly. a. “Cleaning stage missed” b. “Medication not used”
Testing the Robustness of VPS.03 to Detect Errors
VPS.03 was able to perform flawlessly and provide real-time monitoring of the compounding process. Its ability to warn the technician when a mistake/error was made during compounding was tested by deliberately making some common compounding mistakes when each CSP was compounded. Several errors were made when MO-1 was compounded, and in Fig. 11f , the screenshot data shows when the cleaning stage was missed during CSP preparation. The dialog box in the middle of the screenshot image displays all the items that were detected at that particular time. The 50 ml normal saline bag, the filter needle, the regular needle, IPA swab pad, and the promethazine HCl ampule are visible in the picture. However, the technician picked up the 1 ml syringe (missing in the picture) first without cleaning the ampule and the compounding port in the IV bag. This led to the algorithm to detect that the cleaning step was missed and the warning message “cleaning stage missed” was shown as in the text highlighted with a red box in the picture. This mistake was made during three trials when the CSP was compounded, and each time the mistake was made, VPS.03 detected the mistake and warned the technician with the message “cleaning stage missed.” Other mistakes that were made when the Phenergan infusion was being compounded were the filter needle not being used, filter needle not being switched to a regular needle when the injection in the syringe was injected into the 50 ml NS IV bag, and the drug ampule itself being missed during CSP preparation. A filter needle has to be used when liquid injections are withdrawn from a glass ampule into a syringe. This precautionary measure will prevent any small pieces of glass that may dislodge and fall into the liquid inside the ampule while it is opened. If a filter needle is not used, then small glass pieces can be taken inside the syringe along with the injection liquid and eventually reach the patient’s body when the injection is administered. After withdrawing the injection from an ampule into a syringe using a filter needle, the filter needle has to be removed and a regular needle attached to the syringe before injecting the liquid inside the syringe into the IV bag. This switching will prevent any glass pieces or other debris that may be filtered by the filter needle when the injection is withdrawn into the syringe from being injected into the IV bag. All the errors were detected as the mistakes were committed during the compounding stage. This information is summarized in Table 3 in the row titled “Experiment II.” Similar mistakes were made intentionally, such as missing the cleaning stage and not using the luer-lock syringe tip cap when MO-2 was compounded. Figure 12e shows the screenshot image of data from when the cleaning stage was missed during MO-2 compounding. During compounding of any CSP, after the items required for a particular CSP are placed in the IV hood, the compounding port of the IV bag, vial top, and ampule as applicable are cleaned using an IPA swab pad. This step is necessary to prevent any dust or other contaminant from entering the final compounded CSP. At all times, when the cleaning stage was missed, VPS.03 detected the error and displayed the warning message as shown in Fig. 12e . MO-2 was for a labetalol injection, which in this case was to be administered as an IV push injection typically administered to a patient through a cannula inserted in a patient. When this injection is compounded in the IV room of an in-patient hospital pharmacy, the required volume of the injection is withdrawn into an appropriate syringe, the regular needle is removed, and the syringe closed by using a luer-lock syringe tip cap before dispensing. The syringe tip cap prevents any spillage from the syringe and inhibits contamination. When the luer-lock syringe tip cap was intentionally missed during MO-2 compounding, VPS.03 detected this error and displayed the error message, as shown in Fig. 12f . Similarly, one mistake was made during the compounding of MO-3. The summary of observations of mistakes made during the compounding of MO-2 is given in Table 4 in the row titled “Experiment IV,” and that made during the compounding of MO-3 is given in Table 5 in the row titled “Experiment VI.” As was observed during robustness testing of VPS.03, all the errors were detected in real time, and relevant warning messages were displayed when a particular error was detected.
The decision tree used in the design of the system and algorithms are based on standard operating procedures (SOP’s) followed in an IV compounding setting when preparing the injections presented in the manuscript. The procedures thus used typically align with the USP <797> recommendations. Hence, the data generated when testing the system conforms to standard practices and guidelines followed in CSP preparation settings such as hospital IV rooms. The algorithms were manually entered and modified to address any shortcomings when the program was developed and tested. The VPS continuously guides the compounding procedure followed and provides feedback to the technician. In addition to monitoring, a technician can also see the compounding procedure illustrated through text and image and this ascertains that the technician follows the correct procedure during compounding. All these unique features in this system are thought to improve accuracy and productivity during the compounding process.
Conclusion
A computational decision support system for use during preparation of compounded sterile preparations comprising of two main components, material selection system (MSS) and video processor system (VPS), was successfully developed and tested. The MSS enabled proper identification and selection of items and components required to compound a particular CSP. The seven unique elements constituting the MSS, such as compounding calculator, item selector, expiration date-check, image confirmation, database operation, read-out loud and visual-aid, and barcode reader, were optimized and functioned without any errors during implementation and testing. The algorithms related to the MSS were modified and rearranged to produce the final version. Three different versions of the VPS, named VPS.01, VPS.02, and VPS.03, were developed sequentially to accommodate shortcomings of a previous version. VPS.01, using the weighted frame correlation technique, could not be implemented in real time due to deficiencies such as detection errors and unsuitable detection times. VPS.02 used the component detection technique but had detection delays due to the lag time associated with video capture and the SURF detection technique. The final VPS.03 utilized a modified algorithm and technique of that used in VPS.02 and successfully detected, monitored, and evaluated the compounding of three CSP’s in real-time. VPS.03 also detected compounding errors that were deliberately made during the CSP compounding stages. Additional experimentation with VPS.03 will allow use of this computational decision support system in the CSP preparation environment. A system similar to that presented in this work is not currently available in training, educational, or practice settings.