Introduction
Target-mediated drug disposition (TMDD) describes the phenomenon where the pharmacokinetics (PK) of a drug is significantly affected by the high affinity binding properties of that drug to its target (such as a receptor, enzyme or transporter) [ , , ]. The TMDD approach for a single drug finds broad application in PK modeling, see [ , ] for a list of compounds. TMDD behavior is used in several scenarios, such as binding of one drug to two targets [ ], for antibody-drug conjugates [ ], or receptor mediated endocytosis [ ], just to name a few. Also minimal physiologically based PK models were extended with TMDD mechanisms [ , ].
In general a TMDD system is over-parameterized for parameter estimation. Since binding of drug to receptor usually occurs rapidly, steady state assumptions can be made to reduce the number of parameters. Typically, two approaches are applied, the quasi-equilibrium (QE) [ ] or the quasi-steady state (QSS) [ ] approximation to describe the rapid binding assumption. The single drug TMDD model with and without approximation was investigated in several manuscripts [ , , , , , ].
Structurally, a TMDD approximating system is a collection of ordinary differential equations (ODE) and so-called algebraic equations arising from the QE or QSS assumption. Moreover, the system is written in total variables, i.e. the sum of free drug concentration with the complex and the sum of free receptors with the complex, respectively. Since free drug concentration is of interest for application, the algebraic equations, approximating the rapid binding, have to be solved. In the single drug case this can be simply done [ ]. However, for TMDD systems with two drugs one obtains a coupled non-linear equation system for the free drug concentrations [ ] and explicit solving is no longer straightforward or even possible. Hence, there is a need for equivalent but alternative model formulations. The aim of this manuscript is to derive in full detail an ODE formulation in free variables for the single drug case without any equation system, to pave the way towards construction of QE or QSS approximations for TMDD systems with DDI mechanisms [ ].
Theoretical
In general, the construction and approximation of a TMDD model can be organized in four steps: (1) formulate the original TMDD system in free drug and free receptor concentration variables, (2) reformulate the system in total drug and total receptor concentration variables, (3) apply either QE or QSS approximation to reduce the parameters, (4) back-transform the system to an equivalent ODE in free drug and free receptor variables. To provide the entire approach, we present all four steps in full detail. In Fig. 1 , a detailed overview of the four steps is shown.
Step 1 Original single TMDD formulation in free variables
In the single TMDD drug case, free drug C binds to free receptor R forming a complex RC . The model equations [ ] are $$\begin{aligned} \frac{d}{dt} C&= In(t) -k_{el} C - k_{on} C \cdot R + k_{off} RC \end{aligned}$$ (1) $$\begin{aligned} \frac{d}{dt} R&= k_{syn} - k_{deg} R -k_{on} C \cdot R + k_{off} RC \end{aligned}$$ (2) $$\begin{aligned} \frac{d}{dt} RC&= k_{on} C \cdot R - k_{off} RC - k_{int} RC \end{aligned}$$ (3) where \(k_{el}\) is the first-order drug elimination rate, \(k_{on}\) the binding rate of free drug to free receptor, \(k_{off}\) the binding rate describing the dissociation and \(k_{int}\) the internalization rate of the complex. Free receptors may synthesize with rate \(k_{syn}\) and degraded with \(k_{deg}\) . Drug administration is described by the input function In . Omitting a peripheral compartment is only due to clarity and poses no limitation of the following analysis.
Initial values of Eqs. ( 1 )–( 3 ) are defined by their steady state baseline values. Under the assumption that the baseline level of free drug is \(C^0 \ge 0\) , receptor and complex are at steady state, the initial values become $$\begin{aligned} C(0) &= C^0 \end{aligned}$$ (4) $$\begin{aligned} R(0) &= R^0 = \frac{k_{syn}}{k_{deg}+ k_{int} \frac{k_{on} C^0}{k_{off}+k_{int}}} \end{aligned}$$ (5) $$\begin{aligned} RC(0) &= RC^0 = \frac{k_{on} C^0 R^0}{k_{off} +k_{int}}. \end{aligned}$$ (6) The input function follows from Eqs. ( 1 ) and ( 6 ) $$\begin{aligned} In (t) &= In_{Base} + In^{Ad} (t) \\ &= k_{el} C^0 + k_{int} RC^0 + In^{Ad} (t) \end{aligned}$$ (7) with \(In_{Base}\) denoting the inflow baseline and \(In^{Ad}(t)\) standing for the administration of the drugs. In case of no baseline \(C^0 = 0\) , Eqs. ( 5 − 7 ) reduce to $$\begin{aligned} R^0= & {} \frac{k_{syn}}{k_{deg}}, \; \; RC^0 \; = \; 0, \; \; In(t) \; = \; In^{Ad} (t). \end{aligned}$$ For a schematic representation of Eqs. ( 1 – 3 ) see Fig. 2 .
In order to admit either a valid QE or QSS approximation, certain conditions to the parameter and initial conditions have to be imposed. Roughly speaking, we assume the drug to have high affinity for the receptor, the elimination rates to be comparable, and an IV bolus dose which should not be too small. More precisely, we follow Peletier et al. [ ] and assume $$\begin{aligned} \frac{k_{off}}{k_{on}R^0}\ll & {} 1 \end{aligned}$$ (8) $$\begin{aligned} \max \left( \frac{k_{int}}{k_{off}} , \frac{k_{deg}}{k_{off}} , \frac{k_{el}}{k_{off}} \right)< & {} m {\text{ with }} \frac{k_{off}}{k_{on}R^0} m \ll 1. \end{aligned}$$ (9) In addition, in case of IV bolus we assume $$\begin{aligned} \frac{dose}{V}> & {} R^0 . \end{aligned}$$ (10) In case of constant infusion, i.e. \(In_X^{Ad} = k_{inf} >0\) for \(t \ge 0\) , we assume $$\begin{aligned} C_{ss}> & {} R^0 \, \end{aligned}$$ (11) where \(C_{ss} =\lim _{t \rightarrow \infty } C(t)\) denotes the steady state of the free drug concentration.
Step 2 Total variable formulation
The key for the QE or QSS approximation is to reformulate Eqs. ( 1 – 3 ) as total drug and total receptor concentration variables [ ]: $$\begin{aligned} R_{tot} = R + RC \quad {\text{ and }} \quad C_{tot} = C + RC \, . \end{aligned}$$ (12) Then one obtains $$\begin{aligned} \frac{d}{dt} C_{tot}&= \frac{d}{dt} C + \frac{d}{dt} RC \\&= In(t) - k_{el} C - k_{int} RC \end{aligned}$$ (13) $$\begin{aligned} \frac{d}{dt} R_{tot}&= \frac{d}{dt} R + \frac{ d}{dt} RC \\&= k_{syn} - k_{deg} R - k_{int} RC \end{aligned}$$ (14) $$\begin{aligned} \frac{d}{dt} RC&= k_{on} C \cdot R - k_{off} RC - k_{int} RC \, . \end{aligned}$$ (15) Substituting the free variables in the right hand side of Eqs. ( 13 – 15 ) by the total variables Eq. ( 12 ) gives $$\begin{aligned} \frac{d}{dt} C_{tot}&= In(t) - k_{el} (C_{tot}-RC) - k_{int} RC \end{aligned}$$ (16) $$\begin{aligned} \frac{d}{dt} R_{tot}&= k_{syn} - k_{deg} (R_{tot}-RC) - k_{int} RC \end{aligned}$$ (17) $$\begin{aligned} \frac{d}{dt} RC&= k_{on} (C_{tot}-RC)(R_{tot}-RC) \\&\quad - k_{off} RC - k_{int} RC \end{aligned}$$ (18) with the initial values $$\begin{aligned} C_{tot} (0) &= C_{tot}^0 = C^0 + RC^0 \end{aligned}$$ (19) $$\begin{aligned} R_{tot} (0) &= R_{tot}^0 = R^0 +RC^0 \end{aligned}$$ (20) $$\begin{aligned} RC (0) &= RC^0. \end{aligned}$$ (21) The values \(C^0, \, R^0, \, RC^0\) in Eqs. ( 19 – 21 ) are chosen according to Eqs. ( 4 – 6 ) and the input function in Eq. ( 16 ) according to Eq. ( 7 ).
In the total variable formulation Eqs. ( 16 – 18 ), the rates \(k_{on}\) and \(k_{off}\) , which are intended to be removed in the next step, show up only in the equation for the complex.
Step 3 QE and QSS approximation
The objective of the QE or QSS approximation is to reduce the number of parameters by substituting \(k_{on}\) and \(k_{off}\) with its ratio. Since the differences of the QE and QSS approximation become important for some DDI mechanisms we investigate both approximations in more detail.
For the rapid binding of free drug C to free receptor R forming a complex RC , it can be assumed that C , R and RC are at a quasi-equilibrium [ ]. Hence, we have two different processes in time, a fast process characterizing the rapid binding and a slow process describing the drug elimination. To construct the extremely fast binding rates we introduce new rates \(\frac{1}{\varepsilon } k_{on}\) , \(\frac{1}{\varepsilon } k_{off}\) and accelerate the binding by \(\varepsilon \rightarrow 0\) in a way that the ratio \(\frac{k_{off}}{k_{on}}\) remains unchanged. In the QE approximation, Eq. ( 15 ) (or Eq. 18 ) is replaced by $$\begin{aligned} \frac{d}{dt} RC = \frac{1}{\varepsilon } k_{on} C \cdot R - \frac{1}{\varepsilon } k_{off} RC - k_{int} RC \, . \end{aligned}$$ (22) To obtain the limit we multiply Eq. ( 22 ) by \(\varepsilon\) and obtain $$\begin{aligned} \varepsilon \frac{d}{dt} RC = k_{on} C \cdot R - k_{off} RC - \varepsilon k_{int} RC \end{aligned}$$ and let \(\varepsilon \rightarrow 0\) . This leads to the algebraic equation $$\begin{aligned} 0 = k_{on} C \cdot R - k_{off} RC \, . \end{aligned}$$ (23) Equation ( 23 ) allows elimination of \(k_{on}\) and \(k_{off}\) leading to $$\begin{aligned} 0&= C \cdot R - K_D RC \quad {\text{ with }} K_D = \frac{k_{off}}{k_{on}} . \end{aligned}$$ (24) The mathematical rationale of this method is provided by the theory of Fenichel [ ]. This theory allows a selective acceleration of the rates.
In the QSS approximation [ ], based on singular perturbation theory [ ], any rate on the right hand side of Eq. ( 15 ) is accelerated by \(1/\varepsilon\) leading to $$\begin{aligned} \frac{d}{dt} RC = \frac{1}{\varepsilon } k_{on} C \cdot R - \frac{1}{\varepsilon } k_{off} RC - \frac{1}{\varepsilon } k_{int} RC \, . \end{aligned}$$ (25) Hence, not only binding of the drug is rapid but also internalization of the complex. One obtains $$\begin{aligned} \varepsilon \frac{d}{dt} RC = k_{on} C \cdot R - k_{off} RC - k_{int} RC \end{aligned}$$ and in the limit \(\varepsilon \rightarrow 0\) yields the algebraic equation $$\begin{aligned} 0 = k_{on} C \cdot R - k_{off} RC - k_{int} RC \, . \end{aligned}$$ (26) Equation ( 26 ) allows elimination of \(k_{on}\) , \(k_{off}\) and \(k_{int}\) via $$\begin{aligned} 0&= C \cdot R - K_{SS} RC \quad {\text{ with }} K_{SS} = \frac{k_{off} + k_{int}}{k_{on}} . \end{aligned}$$ (27) Please note that \(k_{int}\) is still part of the TMDD system. Finally, the QE and QSS approximation are related with the property $$\begin{aligned} K_{SS} \longrightarrow K_D \quad {\text{ for }} k_{int} \longrightarrow 0 \, . \end{aligned}$$ However, for some DDI mechanisms the QSS approach is no longer capable of deleting all binding rates.
Independently of the QE Eq. ( 24 ) or QSS Eq. ( 27 ) formulation, the algebraic equation for the single drug case reads $$\begin{aligned} 0&= C \cdot R - K_Y RC \end{aligned}$$ (28) $$\begin{aligned}&= (C_{tot}-RC)(R_{tot}-RC) - K_Y RC \end{aligned}$$ (29) where \(K_Y\) is the corresponding dissociation constant and Y either stands for D (QE) or SS (QSS), i.e. \(Y \in \{D,SS\}\) . Hence, the rapid binding process is approximated by an infinitely fast process characterized by the quasi-equilibrium or quasi-steady state. Summarizing the QE or QSS approximation Eqs. ( 16 – 17 , 29 ) is of the form $$\begin{aligned} \frac{d}{dt} C_{tot}&= In(t) - k_{el} (C_{tot}-RC) - k_{int} RC \end{aligned}$$ (30) $$\begin{aligned} \frac{d}{dt} R_{tot}&= k_{syn} - k_{deg} (R_{tot}-RC) - k_{int} RC \end{aligned}$$ (31) $$\begin{aligned} 0&= (C_{tot}-RC)(R_{tot}-RC) - K_Y RC \end{aligned}$$ (32) compare [ ]. System ( 30 – 32 ) is a collection of differential equations ( 30 – 31 ) for \(C_{tot}\) and \(R_{tot}\) and an algebraic equation ( 32 ) for RC . Such systems are so-called differential-algebraic equations (DAE) [ ]. Initial values of a DAE have to satisfy the algebraic equations which is called consistency. Representation Eqs. ( 30 – 32 ) is the natural form of an approximating system with a QE or QSS assumption.
In our case, the baseline initial values for Eqs. ( 30 – 32 ) read according to Eqs. ( 19 – 21 ) $$\begin{aligned} C^0\ge & {} 0, \end{aligned}$$ (33) $$\begin{aligned} R^0= & {} \frac{k_{syn}}{k_{deg}+ k_{int} \frac{C^0}{K_Y}} \end{aligned}$$ (34) $$\begin{aligned} RC^0= & {} \frac{C^0 R^0}{K_Y} \end{aligned}$$ (35) and the input function In ( t ) from Eq. ( 7 ).
However, in case of IV bolus administration, the state where the drug is administered is increased instantaneously. Since, IV bolus is administered to \(C_{tot}\) this instantaneous change has impact on the algebraic equation. More precisely, the total drug concentration is changed to \(C_{tot}^{new} = C_{tot} + \frac{dose}{V}\) whereas the total receptor concentration remains untouched, i.e. \(R_{tot}^{new} = R_{tot}\) . Hence, the algebraic equation ( 32 ) is no longer fulfilled. To regain consistency in line with the QE or QSS assumption, the algebraic equation $$\begin{aligned} 0&= (C_{tot}^{new}-RC)(R_{tot}^{new}-RC) - K_Y RC \end{aligned}$$ (36) with respect to RC has to be solved. However, by mimicking IV bolus with a short infusion the computation of the solution of Eq. ( 36 ) can be avoided because no instantaneous changes in the state variables occur.
Step 4 The two ODE formulations
Now we take a closer look at Eqs. ( 30 – 32 ) and investigate the reformulation as ODE without an algebraic equation. First, we recapitulate the common ODE formulation in total variables [ ] where the algebraic equation is explicitly solved. Second, we develop an ODE formulation in free variables without solving any equation systems. The latter formulation will become essential for DDI TMDD systems.
ODE formulation in total variables
As presented in [ ], for the single drug case Eq. ( 32 ) can be solved easily. Eliminating complex RC in Eq. ( 32 ) with $$\begin{aligned} RC = C_{tot}-C \end{aligned}$$ yields $$\begin{aligned} 0&= C(R_{tot}-C_{tot}+C) - K_Y (C_{tot}-C) \\&= C^2 + C(R_{tot} - C_{tot} + K_Y) - K_Y C_{tot} \, . \end{aligned}$$ (37) The main difference to DDI systems with more drugs is, that in the single case Eq. ( 37 ) can be solved explicitly, which is no longer possible for DDI TMDD systems. Since Eq. ( 37 ) is quadratic in C one obtains the positive solution $$\begin{aligned} C =&\frac{1}{2} [ (C_{tot} - R_{tot} - K_Y) \\&+ \sqrt{(C_{tot}-R_{tot}-K_Y)^2 + 4 K_Y C_{tot} } ] \, . \end{aligned}$$ (38) Similarly we can eliminate RC in Eqs. ( 30 – 31 ) and obtain the typical single drug TMDD formulation $$\begin{aligned} \frac{d}{dt} C_{tot}&= In(t) - k_{el}C - k_{int}(C_{tot}-C) \end{aligned}$$ (39) $$\begin{aligned} \frac{d}{dt} R_{tot}&= k_{syn} - k_{deg} (R_{tot} - C_{tot} + C) - k_{int} (C_{tot}-C) \end{aligned}$$ (40) $$\begin{aligned} C =&\frac{1}{2} [ (C_{tot} - R_{tot} - K_Y) \\&+ \sqrt{(C_{tot}-R_{tot}-K_Y)^2 + 4 K_Y C_{tot} } ] \, \end{aligned}$$ (41) completed by the baseline initial values Eqs. ( 19 – 21 , 33 – 35 ). Equations ( 39 – 41 ) have two major advantages: First, an explicit representation of the free drug concentration C could be derived. Second, the system is independent of the complex RC because the algebraic equation could be solved. Therefore, IV bolus can be applied as usual by an instantaneous change of \(C_{tot}\) . Overall, Eqs. ( 39 – 41 ) is the well established representation for the single drug case. However, for more than one drug, a coupled non-linear algebraic equation system for the free drug concentrations will be obtained which can no longer be solved explicitly, see [ ] for competitive DDI.
Final ODE formulation in free variables
The major aim of this manuscript is to present an equivalent ODE formulation for Eqs. ( 30 – 32 ) and Eqs. ( 39 – 41 ) in free variables which is essential to implement the QE or QSS approximation for DDI TMDD models. To recover free drug concentration C without solving the algebraic equation ( 32 ), we transform Eqs. ( 30 – 32 ) back to the free variables. To do so we exploit Eqs. ( 13 – 14 ) and eliminate \(\frac{d}{dt} RC\) by differentiation of the algebraic equation ( 28 ). This leads to $$\begin{aligned} 0&= \left( \frac{d}{dt} C \right) R + C \left( \frac{d}{dt} R \right) - K_{Y} \frac{d}{dt} RC \end{aligned}$$ which is equivalent to $$\begin{aligned} \frac{d}{dt} RC&= \frac{1}{K_Y} \left( \left( \frac{d}{dt} C \right) R + C \left( \frac{d}{dt} R \right) \right) \, . \end{aligned}$$ (42) We insert Eq. ( 42 ) into Eqs. ( 13 – 14 ) and obtain $$\begin{aligned} \frac{d}{dt} C_{tot}&= \frac{d}{dt}C + \left( \frac{d}{dt}C \right) \frac{R}{K_Y} + \left( \frac{d}{dt}R \right) \frac{C}{K_Y} \\&= In(t) - k_{el}C - k_{int} \frac{C \cdot R}{K_Y} \end{aligned}$$ (43) and $$\begin{aligned} \frac{d}{dt} R_{tot}&= \frac{d}{dt} R+ \left( \frac{d}{dt}C \right) \frac{R}{K_Y} + \left( \frac{d}{dt}R \right) \frac{C}{K_Y} \\&= k_{syn} - k_{deg} R - k_{int} \frac{C \cdot R}{K_Y} \, . \end{aligned}$$ (44) Equations ( 43 – 44 ) can be written in free variables only. For reasons of clarity, we apply the equivalent matrix form and rewrite Eqs. ( 43 – 44 ) as $$\begin{aligned} \begin{pmatrix} 1 + \frac{R}{K_Y} &{} \frac{C}{K_Y} \\ \frac{R}{K_Y} &{} 1 + \frac{C}{K_Y} \end{pmatrix} \begin{pmatrix} \frac{d}{dt} C \\ \frac{d}{dt} R \end{pmatrix}&= \begin{pmatrix} In(t) - k_{el}C - k_{int} \frac{C \cdot R}{K_Y} \\ k_{syn} - k_{deg} R - k_{int} \frac{C \cdot R}{K_Y} \end{pmatrix} \, . \end{aligned}$$ (45) From Eq. ( 45 ) we obtain the final version of the ODE formulation in free variables $$\begin{aligned} \begin{pmatrix} \frac{d}{dt} C \\ \frac{d}{dt} R \end{pmatrix}&= M_{Sing} (C,R) \cdot g_{Sing} (C,R) \end{aligned}$$ (46) with $$\begin{aligned} M_{Sing}(C,R) = \frac{1}{K_Y + R + C} \begin{pmatrix} K_Y + C &{} -C \\ -R &{} K_Y + R \end{pmatrix} \end{aligned}$$ (47) and $$\begin{aligned} g_{Sing}(C,R) = \left( \begin{array}{l} In (t) -k_{el} C - k_{int} \frac{C \cdot R}{K_Y} \\ k_{syn} -k_{deg} R - k_{int} \frac{C \cdot R}{K_Y} \end{array} \right) \, . \end{aligned}$$ (48) The baseline initial values follow from \(g(C^0,R) = 0\) and read $$\begin{aligned} C(0)&= C^0 \, , \quad R(0) = R^0 = \frac{k_{syn}}{k_{deg} + k_{int} \frac{C^0}{K_Y}} \end{aligned}$$ (49) with the input function $$\begin{aligned} In (t)&= k_{el} C^0 + k_{int} \frac{C^0 R^0}{K_Y} + In^{Ad} (t). \end{aligned}$$ (50) The solution for the complex can be obtained from $$\begin{aligned} RC&= \frac{C \cdot R}{K_Y} . \end{aligned}$$ (51) The system Eqs. ( 46 – 51 ) is equivalent to the other descriptions Eqs. ( 30 – 32 ) and Eqs. ( 39 – 41 ), i.e. provides the same solution.
A major advantage of Eqs. ( 46 – 51 ) is the formulation in free drug concentration and therefore, C has not to be recovered from an equation system. This will open the route to simply construct the QE approximation for DDI TMDD systems and to straightforwardly implement such systems in standard PKPD software.
However, we have to investigate the IV bolus administration again. We are dealing with two infinitely fast processes occurring simultaneously, namely the IV bolus itself and the QE or QSS approximation of the rapid binding by the steady state assumption. The interplay of these two infinitely fast processes is responsible that one part of the drug is bound instantaneously and the other part goes to the free drug concentration. Equation ( 46 ) shows that the effect of the input function In is now split into \(\frac{K_Y+C}{K_Y+C+R} In\) acting on the concentration and \(-\frac{R}{K_Y+R+C}In\) acting on the receptor. Due to \(\frac{K_Y+C}{K_Y+C+R} + \frac{R}{K_Y+R+C} = 1\) the total amount of drug given to the system is conserved. Hence, we have $$\begin{aligned} C^{new} \ne C + \frac{dose}{V} \, , \quad R^{new} \ne R \, . \end{aligned}$$ (52) But instead of solving the equations $$\begin{aligned} C^{new} + \frac{C^{new} \cdot R^{new}}{K_Y}&= C_{tot} + \frac{dose}{V} \end{aligned}$$ (53) $$\begin{aligned} R^{new} + \frac{C^{new} \cdot R^{new}}{K_Y}&= R_{tot} \end{aligned}$$ (54) to determine \(R^{new}\) , \(C^{new}\) we mimic IV bolus with an IV short infusion. This is an admissible course of action, since short infusion of time length \(\varepsilon\) converges towards an IV bolus solution as \(\varepsilon\) tends to zero (see Appendix 1). Note that Eqs. ( 46 – 51 ) combined with short infusion (i) avoids the solution of any algebraic equation and (ii) is easy to apply since it is an ordinary differential equation written with the free drug, receptor and complex just as the original TMDD system ( 1 – 3 ).
Methods
We implemented the ODE formulation in free variables in matrix formulation Eqs. ( 46 – 50 ) in ADAPT 5 [ ], NONMEM [ ], R [ ] and MATLAB [ ]. As presented in the " Theoretical " section, IV bolus administration has to be mimicked by a short IV infusion. An infusion is described by the drug amount dose and the infusion time period \([t_a,t_a+\varepsilon ]\) where \(t_a\) is the start of infusion and \(\varepsilon\) the length. Based on this information the infusion rate \(k_{inf} = dose/(V \varepsilon )\) is calculated. For accuracy reasons the size of \(\varepsilon\) should be chosen small but for numerical stiffness reasons not too small. Taking both items into account optimal results were obtained with \(\varepsilon = 1e\) −4.
The drug input In in Eq. ( 46 ) acts on the free variables C and R . In ADAPT 5 infusions are implemented by input functions denoted with R(1) for the single drug, and can be positioned anywhere in the code by the user. Hence, Eqs. ( 46 ) can be straightforward implemented (compare line 218 of the source code in Appendix 2). In contrast, in NONMEM the compartment for the infusion is indicated in the data file. From this information NONMEM adds the input function internally to the right hand side of the differential equation. Since in Eq. ( 46 ) the input function In is part of the matrix multiplication and not simply added to the equations, we cannot directly apply the internal infusion mechanism. One way is to implement the infusion in the control stream (compare lines 110–115 in Appendix 2). To ensure that the integration process accesses start and stop of the infusion, we indicate these time points as dummys in the data file (see lines 127–128). Since no internal infusion mechanisms are available in R and MATLAB, we applied the same technique as in NONMEM. Full files for ADAPT 5 and NONMEM are available as supplemental material.
A DAE solver is available in NONMEM, R and MATLAB, and therefore, we additionally implemented the DAE formulation Eqs. ( 30 – 32 ). In NONMEM, ADVAN9 can be used to solve the DAE where the algebraic equation ( 32 ) is indicated in the $AES block and the corresponding initial value is set in $AESINITIAL . Further with INIT = 0 it is indicated that the initial values are consistent. In R the Radau5 [ ] solver is implemented and the differential and algebraic equations are indicated by a mass matrix. In MATLAB we used the ode15s solver together with a mass matrix.
We implemented the original TMDD formulation with IV bolus Eqs. ( 1 – 7 ) in ADAPT 5 and produced data with the residual error model $$\begin{aligned} Var_i = \left( \sigma Y(t_i) \right) ^2 \end{aligned}$$ where \(Var_i\) is the variance at the i th time point \(t_i\) , \(\sigma\) is the variance parameter and Y is the model prediction. Model parameters were set to \(k_{el} = 0.1\) , \(k_{int} = 0.1\) , \(k_{on} = 2.5\) , \(k_{off} = 0.1\) , \(k_{syn} = 5\) , and \(k_{deg} = 0.25\) , together with \(\sigma = 0.25\) , no baseline \(C^0 = 0\) , and a single administration of \(\frac{dose}{V}\) at \(t=0\) . These settings satisfy the conditions ( 8 – 11 ) with \(\frac{k_{off}}{k_{on}\,R^0}\) = \(2 \cdot 10^{-3}\) , \(\frac{k_{off}}{k_{on}\,R^0} m\) = \(5 \cdot 10^{-3}\) and \(R^0 = 20\) .
In NONMEM and ADAPT 5, the model parameters were estimated with the maximum likelihood estimator. In R and MATLAB we applied a weighted least squares approach.
Results
Approximation quality of the QE and QSS formulation
To investigate the approximation quality, we chose a certain set of model parameters (as defined in the " Methods " Section) and performed simulations to exemplary compare the original system Eqs. ( 1 – 7 ) with the QE or QSS approximation Eqs. ( 46 – 50 ) where \(K_D = 0.04\) or \(K_{SS} = 0.08\) . The following should provide a rough understanding of the approximation quality without testing all kinds of parameter situations and extreme cases.
First, we investigate the absence of baseline, i.e. \(C^0=0\) . In Fig. 3 a and b a comparison of the original system and the QE or QSS approximation is shown for escalating doses ( \(dose =\) 10, 100 and 1000). For lower concentrations the QE approximation seems superior to the QSS assumption. Second, different baseline values ( \(C^0 =\) 0.01, 0.1, 1 and 10) are applied with a \(dose =\) 100, compare Fig. 3 c and d. Here QE seems to have a better approximation quality for low and high baseline values whereas the QSS quality gains for increasing baseline values. Third, we fixed dose and baseline ( \(dose =\) 100 and \(C^0 =\) 1) and changed \(k_{on}\) and \(k_{off}\) (by multiplying the factors 0.1, 1 and 10 to both parameters) in such a way that for the QE approximation the ratio \(K_D\) remains equal. Hence, the approximation always stays the same but the original system differs. More precisely for increasing \(k_{on}\) and \(k_{off}\) the original system converges to the QE approximation, see Figure 3 e. In the QSS approximation, changing of \(k_{on}\) and \(k_{off}\) will lead to different \(K_{SS}\) due to the additional dependency of \(k_{int}\) . For increasing \(k_{on}\) and \(k_{off}\) , \(K_{SS}\) converges to \(K_D\) and also the QSS approximation quality increases, see Fig. 3 f. Note that these observations are in line with the conditions ( 8 – 11 ) since with rising \(k_{off}\) the actual value of m decreases.
Parameter estimation
We implemented the ODE formulation in the QE approximation Eqs. ( 46 – 50 ) with an IV short infusion in ADAPT 5, NONMEM, R and MATLAB, and fitted data produced by the original formulation. The receptor related parameters \(k_{syn}\) and \(k_{deg}\) were fixed, no baseline is available, i.e. \(C^0 = 0\) , and a single administration of \(dose = 100\) at \(t = 0\) occurs. All four software packages could reasonably well estimate the parameters, see Table 1 . The fit from ADAPT 5 is shown in Fig. 4 .
Additionally, we implemented the DAE formulation in total variables with an IV short infusion Eqs. ( 30 – 32 ) in NONMEM, R and MATLAB. The software packages R and MATLAB had no numerical issues in order to solve the DAE and to estimate the model parameters, whereas the ADVAN9 solver in NONMEM produced errors of the form “LSODI Code 204” during parameter estimation. All parameter estimates are listed in Table 1 .
Discussion
The natural form of the QE or QSS approximation is a collection of differential and algebraic equations (see [ ]). To avoid appearance of the algebraic part, Mager and Krzyzanski [ ] solved explicitly the algebraic equation to obtain the free drug concentration in the single drug case. Hence, their representation is formulated in total variables but has an explicit representation of the free drug concentration. Note that also other approximation approaches exist, e.g. the computational singular perturbation (CSP) method [ , , ].
Following Mager and Krzyzanski [ ], in case of two drugs one obtains a non-linear equation system for the two free drug concentrations, as initially shown by Yan et al. [ ] for the competitive DDI case. In general, for such systems no explicit solution is known. This was the reason to investigate the single drug case again and to construct a pure ODE formulation in the original free variables which avoids solving of any equation system. Administration of an IV bolus has to be mimicked by an IV short infusion, which poses no limitations of our approach. Our new approach and the method presented in [ ] are equivalent when applied to single drug TMDD systems. The presented approach will be applied in a more general form in [ ] to construct the ODE formulation without any equation system for TMDD models with DDI mechanisms such as competitive and uncompetitive behavior.
Finally, we had a special focus on an endogenous baseline, since in DDI often endogenous substances are combined with exogenously administered agents which may result in a specific interaction mechanism such as competitive behavior.