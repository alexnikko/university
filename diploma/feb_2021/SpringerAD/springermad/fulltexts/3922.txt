Introduction
Leukopenia is a common adverse effect of chemotherapy in cancer patients. Its clinical markers are white blood cells (WBC) or absolute neutrophil count (ANC) in the circulation. The mechanism of cytotoxicity involves suppression of granulopoietic progenitor cells. Cell cycle specific anticancer agents affect the proliferating precursors for granulocytes in the bone marrow via various cytotoxic mechanisms resulting in lower of WBCs. For example, 5-fluorouracil (5-FU) inhibits DNA replication in rapidly dividing cells leading to their death. Since differentiation and maturation of granulocytes in the bone marrow takes several days in humans, there is a delay between exposure of cells in the bone marrow to the chemotherapeutic drug and the nadir in WBC response. Additionally, the lower WBC triggers counter regulatory mechanisms leading to an increase in the production of the bone marrow precursors and the acceleration of their maturation by increasing the plasma concentration of cytokines stimulating granulopoiesis.
Friberg et al. have introduced a semi-physiological model that accounts for the suppression of granulopoiesis by chemotherapeutic agents [ , ]. This model is widely used to describe hematological toxicities due to its mechanistic adequacy, pharmacological relevance, and mathematical simplicity allowing straightforward implementation in software for data analysis and simulations. The key model components are proliferating cells in the bone marrow and the circulating granulocytes connected by a series of transit compartments describing the maturation of granulocytes in the bone marrow. The transit compartments do not reflect stages of granulocyte development but rather are meant to quantify the duration of maturation.
The transit compartment model is commonly used to introduce delays in pharmacodynamic (PD) systems [ ]. The distribution of maturation times in the last transit compartments followed by a bolus input can be described by the gamma probability density function (p.d.f.) [ ]. According to the linear systems theory, the output of any general continuous-time linear system is related to the input by a convolution integral with the unit impulse response. Consequently, any input to the first transit compartments results in the last transit compartment to be the convolution of the Erlang p.d.f. (the gamma p.d.f. with the shape parameter ν equal to the number of transit compartments) with the input. This implies that the transit compartments can be replaced by a convolution integral with the Erlang p.d.f. accounting for the maturation delay. De Suza et al. applied this idea in the distributed delay model of chemotherapy-induced myelosuppression in [ ]. The distributed delay model applies the gamma p.d.f. with an arbitrary shape parameter ν > 0 that is equal to the number of transit compartments if it is a positive integer.
Contrary to the Friberg model, the distributed delay model is difficult to implement in pharmacometric software due to lack of numerical algorithms evaluating convolution integrals. Implementation of convolution integrals in PD models has been pioneered by Veng-Pedersen et al. using the WINFUNFIT program [ ]. Recently, a convolution operator was added to Phoenix modeling language [ ]. These numerical advances made it possible to apply PD models with convolution integrals for fitting and analysis of experimental data. In particular, one can address a question of the deterministic identifiability of the distributed delay model given ν as one of model parameters [ ].
The objective of this work was to evaluate performance of the distributed delay model. The key question was the model deterministic identifiability with focus on the shape parameter ν given typical data of chemotherapeutic effect on WBCs. We fitted the distributed delay model to previously published WBC data in rats receiving intravenous doses of 5-FU. The Friberg model of chemotherapy-induced myelosuppression was used as a reference for comparison.
Methods
Data
5-FU plasma concentrations and WBC counts in rats were obtained by digitizing Figs. 2 and 3 in [ ]. In the reported study, 24 rats were randomized in one placebo group and three treatment groups. The single injection group received a single injection of 5-FU 127 mg/kg on day 0. The double injection group received two injections of 5FU 63 mg/kg on days 0 and 2. The triple injection group received three injections of 5-FU 49 mg/kg on days 0, 2, and 4. Plasma concentrations of 5-FU were measured over 2 h period after the first injection and WBC count was measured over 23 days.
PK model for 5-FU
The plasma concentrations of 5-FU following bolus injections are described by the one-compartment model with the Michaelis–Menten elimination [ ]: $$\frac{dA}{dt} = \mathop \sum \limits_{i = 1}^{k} Dose_{k} \delta (t - t_{i} ) - \frac{{V_{max} A}}{{K_{m} + C}}$$ (1) where A is the amount of drug in the plasma, V max and K m are Michaelis–Menten constants, and C denotes the 5-FU plasma concentration: $$C = \frac{A}{V}$$ (2) with the volume of distribution V . The IV bolus injection of Dose k at time t i is described by the Dirac delta function, δ . The index k is equal to 1 for single injection, 2 for double injection, and 3 for triple injection group. The initial condition for Eq. ( 1 ) is 0.
Friberg model
The original model of chemotherapy-induced myelosuppression presented by Friberg et al. [ ] was slightly modified to comply with the mechanism of cytotoxicity introduced in [ ]. A model schematic is shown in Fig. 1 a. The proliferating precursor cells for granulocytes ( Prol ) reproduce at a first-order rate k prol and are converted to maturating cells in the bone marrow ( Trans 1 ) at a first-order rate k tr . The maturation process is described by three transit compartments ( Trans i , i = 1, 2, 3) with the transit rate constant k tr . The mature cells are released to the circulation and form granulocytes ( Circ ) which enter the extravascular tissue at a first-order rate k circ . The circulating granulocytes negatively feedback on the proliferation rate of cells in the bone marrow as described by the term (Circ 0 /Circ) γ , where Circ 0 is the baseline count of the circulating granulocytes. The drug irreversibly removes the proliferating cells at a second-order rate Slope . The differential equations are as follows: $$\frac{d \it{prol}}{dt} = k_{\text Prol} \it{Prol}\left( {\frac{{Circ_{0} }}{Circ}} \right)^{\gamma } - Slope \times C \times \it{Prol} - k_{tr} \it{Prol}$$ (3) $$\frac{{dTrans_{1} }}{dt} = k_{tr} (\it Prol - Trans_{1} )$$ (4) $$\frac{{dTrans_{2} }}{dt} = k_{tr} \left( {Trans_{1} - Trans_{2} } \right)$$ (5) $$\frac{{dTrans_{3} }}{dt} = k_{tr} \left( {Trans_{2} - Trans_{3} } \right)$$ (6) $$\frac{dCirc}{dt} = k_{tr} Trans_{3} - k_{circ} Circ$$ (7) The stability of Prol requires $$k_{prol} = k_{tr}$$ (8) Since the parameter k circ is difficult to identify from myelosuppression WBC data, an additional assumption has been made [ ] $$k_{circ} = k_{tr}$$ (9) Fig. 1 Schematic diagrams of the Friberg model (upper) and distributed delay model (lower). Symbols and processes are explained in Methods
Equations ( 7 ) and ( 8 ) imply that the steady-state solutions to Eqs. ( 3 )–( 7 ) are equal to Circ 0 . Consequently, the initial conditions for Eqs. ( 3 )–( 7 ) are:
$$\it Prol\left( 0 \right) = Circ_{0} ,Trans_{i} \left( 0 \right) = Circ_{0} ,i = 1, \, 2, \, 3,\, Circ\left( 0 \right) = Circ_{0}$$ (10)
Finally, the transit rate between the transit compartments k tr can be expressed in terms of the mean transit time MTT and the number of transit compartments:
$$k_{tr} = \frac{\nu }{MTT}$$ (11)
Note that MTT is defined differently in [ ]. The full set of PD parameters for the Friberg model consists of Circ 0 , MTT , γ , and Slope .
Distributed delay model
Assuming that all Friberg model variables were at steady-state prior to drug administrations at time t = 0, one can show that for ν = 3 (see Appendix A): $$Trans_{{}} \left( t \right) = \frac{{k_{tr} }}{{\left( {\nu - 1} \right)!}}\mathop \int \limits_{ - \infty }^{t} \it Prol(\tau )\left( {k_{tr} (t - \tau )} \right)^{ \nu- 1} \exp \left( { - k_{tr} (t - \tau )} \right)d\tau$$ (12) The integral in Eq. ( 12 ) is known as the convolution of Prol with the gamma probability density function \(g_{{\nu ,k_{tr} }}\) : $$\mathop \smallint \limits_{ - \infty }^{t} \it Prol(t - \tau )g_{{,k_{tr} }} (\tau )d\tau = (\it Prol * g_{{,k_{tr} }} )(t)$$ (13) where $$g_{{,k_{tr} }} \left( \tau \right) = \frac{{k_{tr} }}{{\varGamma (\nu )}}\left( {k_{tr} \tau } \right)^{ \nu- 1} \exp \left( { - k_{tr} \tau } \right)$$ (14) The gamma function \({\varGamma (\nu )}\) is the extension of the factorial \(\left( {\nu - 1} \right)!\) defined for positive integers on the set of positive real numbers > 0 [ ]. Consequently, Eq. ( 7 ) can be written for any real > 0 as follows: $$\frac{dCirc}{dt} = k_{tr} \it Prol * g_{{\nu ,k_{tr} }} - k_{circ} Circ$$ (15)
The maturation process described in the Friberg model by transit compartments is replaced here by the convolution. The presence of the convolution in Eq. ( 15 ) requires knowledge of Prol ( t ) in the past: $$\it Prol\left( t \right) = Circ_{0} ,t \le 0,Circ\left( 0 \right) = Circ_{0}$$ (16) Equations ( 3 ), ( 15 ), and ( 16 ) are referred to as the distributed delay model of chemotherapy-induced myelosuppression that was introduced by De Suza et al. [ ]. The MTT parameter in Eq. ( 11 ) is equal to the mean for the gamma distribution [ ]. The full set of PD parameters for the distributed delay model consists of Circ 0 , MTT , ν, γ , and Slope . For ν = 3 the distributed delay model coincides with the Friberg model.
Data analysis
Both 5-FU plasma concentrations and WBC counts were log-transformed. The naïve pooled PK data from three treatment groups were fitted with ln( C ) using the additive residual error model and the maximum likelihood estimation method implemented in NLME module of Phoenix 8 (Certara L.P.). The estimates of V , V max and K m were fixed and used for both Friberg and distributed delay models describing the PD data. Similarly, the naïve pooled PD data from four treatment groups were fitted with ln( Circ ) using the additive residual error model and the maximum likelihood estimation method implemented in NLME module of Phoenix 8.
Model comparison
To compare performance of both PD models, the estimates of model parameters, their standard errors, correlation coefficient between observed and predicted values (r 2 ), objective function value (− 2 LL ), Akaike Information Criterion ( AIC ), Bayesian Information Criterion ( BIC ), and running times were used. Additionally, since the models are nested, the likelihood ratio test ( LRT ) was performed to determine significant difference [ ]: $$LRT = - 2LL_{r} - ( - 2LL_{f} )$$ (17) where the index r refers to the Friberg (reduced) model, and f corresponds to the distributed delay (full) model. LRT is approximately Chi squared distributed with k f − k r degrees of freedom, where k f and k r denote the number of estimated parameters in the distributed delay model and the Friberg model, respectively.
Sensitivity analysis
The PD models differ only by one parameter ν, which is a positive integer for the Friberg model and a positive real number for the distributed delay model. We performed a series of simulations to investigate the impact of non-integer ν values on the shape of \(g_{{\nu ,k_{tr} }}\) and Circ versus time curves given the estimated values of the remaining PD parameters. Simulations were performed using NLME module of Phoenix 8.
Results
Observed 5-FU plasma concentrations fitted by the PK model, Eqs. ( 1 )–( 2 ), are shown in Fig. 2 . The parameter estimates are listed in Table 1 . Fitting of the naïve pooled PK data resulted in parameter estimates of V max and K m that were close to the estimates of their typical values 108 mg/L/h and 22 mg/L reported in [ ]. The volume of distribution V normalized by the mean body weight of rats used in the study (288 g) was also close to its typical value 0.24 L reported in [ ]. The PK parameters V , V max , and K m were fixed at their estimated values for analysis of the PD data. Fig. 2 Log-transformed observed 5-FU plasma concentrations (symbols) and PK model predicted log-transformed C versus time courses (continuous lines) following a single dose injection in three treatment groups Table 1 Estimates of PK parameters for 5-FU Parameter Unit Estimate CV% V L/kg 1.028 6.03 V max mg/L/h 99.95 13.2 K m mg/L 21.96 17.2
The naïve pooled WBC counts from all treatment groups were fitted by the Friberg model [Eqs. ( 3 )–( 7 )] and distributed delay model [Eqs. ( 3 ) and ( 15 )]. The observed data fitted by both models are shown in Fig. 3 . The PD parameter estimates are listed in Table 2 . Both models described the data moderately well with the squared correlation coefficients r 2 = 0.576 and r 2 = 0.586 for Friberg model and distributed delay model, respectively (see Fig. 4 ). The CV% of parameter estimates did not exceed 30%, with Slope being the least precise parameter. While estimates of Circ 0 and Slope were very similar for both models, MTT and γ differed, with the latter being significant ( P < 0.05) based on the disjoint 95% CIs. Additionally, the shape parameter ν was significantly different from 3.0. To verify if the distributed delay model could reproduce the Friberg model, the shape parameter ν was fixed at 3.0 and the PD data was re-fitted. The fittings and parameter estimates for both models were almost identical (see Table 3 ). Fig. 3 Log-transformed WBC counts (symbols) and PD model predicted log-transformed Circ versus time plots (continuous lines) for the four treatment groups. Red lines correspond to the Friberg model and blue lines correspond to the distributed delay model Table 2 Estimates of PD parameters for 5-FU, their coefficients of variation (CV%), and 95% confidence intervals (95%CI) for the Friberg model and distributed delay model Parameter Unit Friberg model Distributed delay model Estimate CV% 95% CI Estimate CV% 95% CI MTT h 67.03 3.54 [62.3,71.7] 55.64 6.67 [48.3,62.9] ν N/A 1.455 16.1 [0.992,1.92] Circ 0 10 9 cells/L 14.41 4.51 [13.1,15.7] 14.37 4.80 [13.0,15.7] γ 0.2813 6.69 [0.244,0.318] 0.5068 15.9 [0.349,0.665] Slope L/mg/h 0.01767 26.2 [0.0085,0.0268] 0.01213 28.1 [0.0095,0.033] Fig. 4 Observed versus predicted plots for Friberg model (upper panel) and distributed delay model (lower panel). The continuous lines are LOESS lines. The r 2 values are the squared correlation coefficients for ln( WBC ) and ln( Circ ) Table 3 Estimates of PD parameters for 5-FU and their coefficients of variation (CV%) for the Friberg model and distributed delay model with ν = 3 Parameter Unit Friberg model Distributed delay model Estimate CV% Estimate CV% MTT h 67.03 3.54 67.04 3.53 Circ 0 10 9 cells/L 14.41 4.51 14.41 4.51 γ 0.2813 6.69 0.2815 6.68 Slope L/mg/h 0.01767 26.2 0.01767 26.2
The distributed delay model has one more parameter ( ν ) than the Friberg model, and the models are nested. Several markers of model performance were used for comparison between Friberg and distributed delay models. Their values are shown in Table 4 . The objective function value − 2 LL differed by 6.78 which implied the significant difference between models according to LRT test ( P = 0.00922). Both AIC and BIC were lower for the distributed delay model by 4.78 and 1.23, respectively. The running time that accounted for the convergence of the minimization of the objective function and calculation of standard errors was much shorter for the Friberg model (1 s) than for the distributed delay model (66.2 min). Table 4 Goodness of fit criteria for the Friberg model and distributed delay model Metric Friberg model Distributed delay − 2 LL 102.02 95.24 AIC 112.02 107.24 BIC 129.81 128.58 r 2 0.576 0.586 Run time (s) 0.98 3971.46
The relative standard error for ν estimate was 16.1% that implied that this parameter can be reliably estimated from the WBC count data together with remaining PD parameters. To assess whether the PD response Circ is sensitive to ν , we performed a local sensitivity analysis by varying ν values while other PD parameters were fixed at their estimated values. Figure 5 shows that varying ν in the range 0.5 to 3.0 had strong influence on the time course of Circ following a single dose injection of 5-FU. On the other hand, the shapes of the p.d.fs were not affected by ν > 1. This implies that, given the model parametrization Eqs. ( 8 ), ( 9 ), and ( 11 ), ν impacts Circ time profiles by controlling elimination k circ and proliferation k prol rates rather than the shape of the delay distribution. Fig. 5 Time courses of the circulating WBCs predicted by the PD model following a single bolus dose 127 mg/kg of 5-FU (upper panel) and probability distribution functions for the gamma distribution \(g_{{\nu ,k_{tr} }}\) (lower panel) for varying values of the shape parameter ν . The remaining model parameters are shown in Tables 1 and 2
Discussion
The transit compartment model is commonly used in modeling delays in PKPD systems. The major feature underlying its popularity is easy implementation in pharmacometric software by means of ordinary differential equations. However, a selection of the number of transit compartments ν poses an inherent difficulty. The observation that the delay introduced by series of transit compartments can be described by a convolution of the input with the gamma p.d.f. \(g_{{\nu ,k_{tr} }}\) having shape parameter being an integer is known as the linear chain trick [ ]. It has been first applied in modeling of absorption delay in PK data for drugs administered orally by Savic et al. [ ]. De Suza et al. has applied the linear chain trick by replacing the transit compartments connecting the proliferating cell pool Prol with the circulating granulocytes Circ in the Friberg model with the convolution of the first-order output from Prol with \(g_{{\nu ,k_{tr} }}\) [ ]. This removes a constraint imposed on the distribution of delays by ν = 3 and introduces more flexibility as ν > 0 can be any positive number. Since the gamma p.d.f. is meant to describe the distribution of maturation times of the granulopoietic precursor cells in the bone marrow, one can naturally consider other p.d.fs serving this purpose that are defined by two or more parameters (e.g. Weibull p.d.f.). Then Eq. ( 13 ) becomes $$\frac{dCirc}{dt} = k_{tr} \it Prol * g - k_{circ} Circ$$ (18)
One can consider k tr be a scale parameter for g and the MTT can be calculated as the mean delay: $$MTT = \mathop \smallint \limits_{0}^{\infty } \tau g\left( \tau \right)d\tau$$ (19)
The challenge of this extension is a numerical implementation of the convolution integral in Eq. ( 18 ) in pharmacometric software.
The presence of the state variable Prol in the convolution integral makes the distributed delay model a system of integro-differential equations. Studying properties of such models requires more advanced techniques than ones applied for models described by ordinary differential equations [ ]. A formal proof of existence of a unique solution as well as a steady-state solution is beyond the scope of this report. Stability of the steady-state of the distributed delay model is discussed in [ ].
The Friberg model presented here differs from the one introduced in [ ] by the second-order cytotoxic rate \(Slope \times C\) . In the original model, \(Slope \times C\) is one of possible drug effect models E Drug that reversibly inhibits the proliferation of Prol cells by means of the product k prol (1 − E Drug ). When the cytotoxic effect was implemented as \(E_{Drug} = Slope \times C\) , the estimate of Slope = 0.393L/mg/h was such that E Drug > 1 for initial times after the largest dose of 127 mg/kg. This implies the negative inhibition of k prol that is biologically implausible. Instead of exploring other forms for E Drug describable by one parameter, we elected the irreversible cell killing over reversible inhibition. From a theoretical point of view each of these cytotoxic mechanisms can be implemented in the distributed delay model without any qualitative changes in model behavior.
The major objective of this work was to evaluate performance of the distributed delay model with the Friberg model as a reference. The key question was the model deterministic identifiability given typical data of chemotherapeutic effect on WBCs. Presence of an additional parameter ν potentially could negatively impact the precision of parameter estimates beyond acceptable values, rendering the model unidentifiable. This was not what we observed. Only a modest increase in standard errors of PD parameter estimates took place resulting in acceptable precisions. Additionally, the local sensitivity analysis showed that ν plays a significant role in controlling proliferation of Prol cells and elimination of Circ cells, given MTT as a primary model parameter. Consequently, we conclude that the distributed delay model is deterministically identifiable from a typical cytotoxic data. Since the Friberg model is nested in the distributed delay model, one can expect a better performance of the latter. This was confirmed by all applied metrics, including the LRT that yielded a significant improvement. Overall performance was only modestly better.
The feature most negatively affecting performance of the distributed delay model was the running time. This is due to the convolution integral involved in the right-hand side of Eq. ( 15 ). The convolution operator in the Phoenix modeling language involves direct numerical calculation of the integral. Hence, the computational cost directly depends on the number of grid points for the approximation, and thus may become very expensive in order to have a reasonable accurate approximation, especially for the case where the problem is stiff [ ]. The difference in running time between the Friberg model and distributed delay model would not be so extreme if one allowed a selection of the optimal number of transit compartments for the former. Although selection of = 3 has been proven robust [ ], additional computational time would have been necessary for testing if other integer ν values had yielded better model performance.
In summary, we applied the distributed delay model to describe the myelosuppressive effect of 5-FU in rats. The model adequately described the data and all model parameters were estimated with reasonable precision. Sensitivity analysis revealed that all model parameters including a new parameter accounting for the shape of the delay distribution are deterministically identifiable from a typical cytotoxic data. Model performance was significantly impaired by the long running time attributed to numerical calculation of the convolution integral accounting for the delay. This might limit model applications to describe population PKPD data. Further research on more robust algorithms evaluating convolution integrals is mandated.