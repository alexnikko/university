1 Introduction
Over the past few decades, a variety of techniques for non-invasive measurement of brain activity have been developed, one of which is source localization using electroencephalography (EEG). It uses measurements of the voltage potential at various locations on the scalp (in the order of microvolts ( μV )) and then applies signal processing techniques to estimate the current sources inside the brain that best fit this data.
It is well established [ ] that neural activity can be modelled by currents, with activity during fits being well-approximated by current dipoles. The procedure of source localization works by first finding the scalp potentials that would result from hypothetical dipoles, or more generally from a current distribution inside the head – the forward problem; this is calculated or derived only once or several times depending on the approach used in the inverse problem and has been discussed in the corresponding review on solving the forward problem [ ]. Then, in conjunction with the actual EEG data measured at specified positions of (usually less than 100) electrodes on the scalp, it can be used to work back and estimate the sources that fit these measurements – the inverse problem. The accuracy with which a source can be located is affected by a number of factors including head-modelling errors, source-modelling errors and EEG noise (instrumental or biological) [ ]. The standard adopted by Baillet et. al . in [ ] is that spatial and temporal accuracy should be at least better than 5 mm and 5 ms, respectively.
In this primer, we give a review of the inverse problem in EEG source localization. It is intended for the researcher who is new in the field to get insight in the state-of-the-art techniques used to get approximate solutions. It also provides an extensive list of references to the work of other researchers. The primer starts with a mathematical formulation of the problem. Then in Section 3 we proceed to discuss the two main categories of inverse methods: non parametric methods and parametric methods. For the first category we discuss minimum norm estimates and their generalizations, the Backus-Gilbert method, Weighted Resolution Optimization, LAURA, shrinking and multiresolution methods. For the second category, we discuss the non-linear least-squares problem, beamforming approaches, the Multiple-signal Classification Algorithm (MUSIC), the Brain Electric Source Analysis (BESA), subspace techniques, simulated annealing and finite elements, and computational intelligence algorithms, in particular neural networks and genetic algorithms. In Section 4 we then give an overview of source localization errors and a review of the performance analysis of the techniques discussed in the previous section. This is then followed by a discussion and conclusion which are given in Section 5.
2 Mathematical formulation
In symbolic terms, the EEG forward problem is that of finding, in a reasonable time, the potential g ( r , r dip , d ) at an electrode positioned on the scalp at a point having position vector r due to a single dipole with dipole moment d = d e d (with magnitude d and orientation e d ), positioned at r dip (see Figure 1 ). This amounts to solving Poisson's equation to find the potentials V on the scalp for different configurations of r dip and d . For multiple dipole sources, the electrode potential would be m(r)=∑ig(r,rdipi,di) . Assuming the principle of superposition, this can be rewritten as ∑ig(r,rdipi)(dix,diy,diz)T=∑ig(r,rdipi)diei , where g ( r , rdipi ) now has three components corresponding to the Cartesian x , y , z directions, d i = ( d ix , d iy , d iz ) is a vector consisting of the three dipole magnitude components, ' T ' denotes the transpose of a vector, d i = || d i || is the dipole magnitude and ei=di/‖di‖ is the dipole orientation. In practice, one calculates a potential between an electrode and a reference (which can be another electrode or an average reference). Figure 1 A three layer head model.
For N electrodes and p dipoles: m=[m(r1)⋮m(rN)]=[g(r1,rdip1) ⋯ g(r1,rdipp)⋮ ⋱ ⋮g(rN,rdip1) ⋯ g(rN,rdipp)][d1e1⋮dpep] (1)
where i = 1, ..., p and j = 1, ..., N . Each row of the gain matrix G is often referred to as the lead-field and it describes the current flow for a given electrode through each dipole position [ ].
For N electrodes, p dipoles and T discrete time samples: M=[m(r1,1) ⋯ m(r1,T)⋮ ⋱ ⋮m(rN,1) ⋯ m(rN,T)]=G({rj,rdipi})[d1,1e1 ⋯ d1,Te1⋮ ⋱ ⋮dp,1ep ⋯ dp,Tep] (2a) =G({rj,rdipi})D (2b)
where M is the matrix of data measurements at different times m ( r , t ) and D is the matrix of dipole moments at different time instants.
In the formulation above it was assumed that both the magnitude and orientation of the dipoles are unknown. However, based on the fact that apical dendrites producing the measured field are oriented normal to the surface [ ], dipoles are often constrained to have such an orientation. In this case only the magnitude of the dipoles will vary and the formulation in (2a) can therefore be re-written as: M=[g(r1,rdip1)e1 ⋯ g(r1,rdipp)ep⋮ ⋱ ⋮g(rN,rdip1)e1 ⋯ g(rN,rdipp)ep][d1⋮dp] (3a) =G({rj,rdipi,ei})[d1,1 ⋯ d1,T⋮ ⋱ ⋮dp,1 ⋯ dp,T] (3b) =G({rj,rdipi,ei})D (3c)
where D is now a matrix of dipole magnitudes at different time instants. This formulation is less underdetermined than that in the previous structure.
Generally a noise or perturbation matrix n is added to the system such that the recorded data matrix M is composed of:
M = GD + n .
Under this notation, the inverse problem then consists of finding an estimate Dˆ of the dipole magnitude matrix given the electrode positions and scalp readings M and using the gain matrix G calculated in the forward problem. In what follows, unless otherwise stated, T = 1 without loss of generality.
3 Inverse solutions
The EEG inverse problem is an ill-posed problem because for all admissible output voltages, the solution is non-unique (since p >> N ) and unstable (the solution is highly sensitive to small changes in the noisy data). There are various methods to remedy the situation (see e.g. [ , , ]). As regards the EEG inverse problem, there are six parameters that specify a dipole: three spatial coordinates ( x , y , z ) and three dipole moment components (orientation angles ( θ , φ ) and strength d ), but these may be reduced if some constraints are placed on the source, as described below.
Various mathematical models are possible depending on the number of dipoles assumed in the model and whether one or more of dipole position(s), magnitude(s) and orientation(s) is/are kept fixed and which, if any, of these are assumed to be known. In the literature [ ] one can find the following models: a single dipole with time-varying unknown position, orientation and magnitude; a fixed number of dipoles with fixed unknown positions and orientations but varying amplitudes; fixed known dipole positions and varying orientations and amplitudes; variable number of dipoles (i.e. a dipole at each grid point) but with a set of constraints. As regards dipole moment constraints, which may be necessary to limit the search space for meaningful dipole sources, Rodriguez-Rivera et al . [ ] discuss four dipole models with different dipole moment constraints. These are (i) constant unknown dipole moment; (ii) fixed known dipole moment orientation and variable moment magnitude; (iii) fixed unknown dipole moment orientation, variable moment magnitude; (iv) variable dipole moment orientation and magnitude.
There are two main approaches to the inverse solution: non-parametric and parametric methods. Non-parametric optimization methods are also referred to as Distributed Source Models, Distributed Inverse Solutions (DIS) or Imaging methods. In these models several dipole sources with fixed locations and possibly fixed orientations are distributed in the whole brain volume or cortical surface. As it is assumed that sources are intracellular currents in the dendritic trunks of the cortical pyramidal neurons, which are normally oriented to the cortical surface [ ], fixed orientation dipoles are generally set to be normally aligned. The amplitudes (and direction) of these dipole sources are then estimated. Since the dipole location is not estimated the problem is a linear one. This means that in Equation 4 , { rdipi } and possibly e i are determined beforehand, yielding large p >> N which makes the problem underdetermined. On the other hand, in the parametric approach few dipoles are assumed in the model whose location and orientation are unknown. Equation ( 4 ) is solved for D , { rdipi } and e i , given M and what is known of G . This is a non-linear problem due to parameters { rdipi }, e i appearing non-linearly in the equation.
These two approaches will now be discussed in more detail.
3.1 Non parametric optimization methods
Besides the Bayesian formulation explained below, there are other approaches for deriving the linear inverse operators which will be described, such as minimization of expected error and generalized Wiener filtering. Details are given in [ ]. Bayesian methods can also be used to estimate a probability distribution of solutions rather than a single 'best' solution [ ].
3.1.1 The Bayesian framework
In general, this technique consists in finding an estimator xˆ of x that maximizes the posterior distribution of x given the measurements y [ , , , , ]. This estimator can be written as xˆ=maxx[p(x|y)]
where p ( x | y ) denotes the conditional probability density of x given the measurements y . This estimator is the most probable one with regards to measurements and a priori considerations.
According to Bayes' law, p(x|y)=p(y|x)p(x)/p(y).
The Gaussian or Normal density function
Assuming the posterior density to have a Gaussian distribution, we find p(x|y)=p(x)p(y|x)/p(y)=exp[−Fα(x)]/z/p(y)
where z is a normalization constant called the partition function, F α ( x ) = U 1 ( x ) + αL ( x ) where U 1 ( x ) and L ( x ) are energy functions associated with p ( y | x ) and p ( x ) respectively, and α (a positive scalar) is a tuning or regularization parameter. Then xˆ=minx(Fα(x)).
If measurement noise is assumed to be white, Gaussian and zero-mean, one can write U 1 ( x ) as
U 1 ( x ) = || Kx - y || 2
where K is a compact linear operator [ , ] (representing the forward solution) and ||.|| is the usual L 2 norm. L ( x ) may be written as U s ( x ) + U t ( x ) where U s ( x ) introduces spatial (anatomical) priors and U t ( x ) temporal ones [ , ]. Combining the data attachment term with the prior term, xˆ=minx(Fα(x))=minx(||Kx−y||2+αL(x)).
This equation reflects a trade off between fidelity to the data and spatial/temporal smoothness depending on the α .
In the above, p ( y | x ) ∝ exp(- X T . X ) where X = Kx - y . More generally, p ( y | x ) ∝ exp(- Tr ( X T . σ -1 . X )), where σ -1 is the data covariance matrix and ' Tr ' denotes the trace of a matrix.
The general Normal density function
Even more generally, p ( y | x ) ∝ exp(- Tr (( X - μ ) T . σ -1 .( X - μ ))), where μ is the mean value of X . Suppose R is the variance-covariance matrix when a Gaussian noise component is assumed and Y is the matrix corresponding to the measurements y . The R-norm is defined as follows: ||Y−KX||R2=Tr[(Y−KX)TR−1(Y−KX)]
Non-Gaussian priors
Non-Gaussian priors include entropy metrics and L p norms with p < 2 i.e. L ( x ) = || x || p .
Entropy is a probabilistic concept appearing in information theory and statistical mechanics. Assuming x ∈ ℝ n consists of positive entries x i > 0, i = 1, ..., n the entropy is defined as ℰ(x)=−∑i=1nxilog(xi/xi∗)
where xi∗ > 0 is a is a given constant. The information contained in x relative to xi∗ is the negative of the entropy. If it is required to find x such that only the data Kx = y is used, the information subject to the data needs to be minimized, that is, the entropy has to be maximized. The mathematical justification for the choice L ( x ) = - ℰ ( x ) is that it yields the solution which is most 'objective' with respect to missing information. The maximum entropy method has been used with success in image restoration problems where prominent features from noisy data are to be determined.
As regards L p norms with p < 2, we start by defining these norms. For a matrix A , ||A||p=∑i,j|aij|pp where a ij are the elements of A . The defining feature of these prior models is that they are concentrated on images with low average amplitude with few outliers standing out. Thus, they are suitable when the prior information is that the image contains small and well localized objects as, for example, in the localization of cortical activity by electric measurements.
As p is reduced the solutions will become increasingly sparse. When p = 1 [ ] the problem can be modified slightly to be recast as a linear program which can be solved by a simplex method. In this case it is the sum of the absolute values of the solution components that is minimized. Although the solutions obtained with this norm are sparser than those obtained with the L 2 norm, the orientation results were found to be less clear [ ]. Another difference is that while the localization results improve if the number of electrodes is increased in the case of the L 2 approach, this is not the case with the L 1 approach which requires an increase in the number of grid points for correct localization. A third difference is that while both approaches perform badly in the presence of noisy data, the L 1 approach performs even worse than the L 2 approach. For p < 1 it is possible to show that there exists a value 0 < p < 1 for which the solution is maximally sparse. The non-quadratic formulation of the priors may be linked to previous works using Markov Random Fields [ , ]. Experiments in [ ] show that the L 1 approach demands more computational effort in comparision with L 2 approaches. It also produced some spurious sources and the source distribution of the solution was very different from the simulated distribution.
Regularization methods
Regularization is the approximation of an ill-posed problem by a family of neighbouring well-posed problems. There are various regularization methods found in the literature depending on the choice of L ( x ). The aim is to find the best-approximate solution x δ of Kx = y in the situation that the 'noiseless data' y are not known precisely but that only a noisy representation y δ with || y δ - y || ≤ δ is available. Typically y δ would be the real (noisy) signal. In general, an xαδ is found which minimizes
F α ( x ) = || Kx - y δ || 2 + αL ( x ).
In Tikhonov regularization, L ( x ) = || x || 2 so that an xαδ is found which minimizes
F α ( x ) = || Kx - y δ || 2 + α || x || 2 .
It can be shown (in Appendix) that xα(δ)δ=(K∗K+αI)−1K∗yδ
where K* is the adjoint of K . Since ( K*K + α I ) -1 K* = K* ( KK* + α I ) -1 (proof in Appendix), xα(δ)δ=K∗(KK∗+αI)−1yδ.
Another choice of L ( x ) is
L ( x ) = || Ax || 2
where A is a linear operator. The minimum is obtained when xα(δ)δ=(K∗K+αA∗A)−1K∗y (6)
In particular, if A = ∇ where ∇ is the gradient operator, then xα(δ)δ = ( K*K + α ∇ T ∇) -1 K*y . If A = ΔB , where Δ is the Laplacian operator, then xα(δ)δ = ( K*K + α B *Δ T Δ B ) -1 K*y .
The regularization parameter α must find a good compromise between the residual norm || Kx - y δ || and the norm of the solution || Ax ||. In other words it must find a balance between the perturbation error in y and the regularization error in the regularized solution.
Various methods [ , , ] exist to estimate the optimal regularization parameter and these fall mainly in two categories:
1. Those based on a good estimate of || ϵ || where ϵ is the noise in the measured vector y δ .
2. Those that do not require an estimate of || ϵ ||.
The discrepancy principle is the main method based on || ϵ ||. In effect it chooses α such that the residual norm for the regularized solution satisfies the following condition:
|| Kx - y δ || = || ϵ ||
As expected, failure to obtain a good estimate of ϵ will yield a value for α which is not optimal for the expected solution.
Various other methods of estimating the regularization parameter exist and these fall mainly within the second category. These include, amongst others, the
1. L -curve method
2. General-Cross Validation method
3. Composite Residual and Smoothing Operator (CRESO)
4. Minimal Product method
5. Zero crossing
The L -curve method [ , , ] provides a log-log plot of the semi-norm || Ax || of the regularized solution against the corresponding residual norm || Kx - y δ || (Figure 2a ). The resulting curve has the shape of an 'L', hence its name, and it clearly displays the compromise between minimizing these two quantities. Thus, the best choice of alpha is that corresponding to the corner of the curve. When the regularization method is continuous, as is the case in Tikhonov regularization, the L -curve is a continuous curve. When, however, the regularization method is discrete, the L -curve is also discrete and is then typically represented by a spline curve in order to find the corner of the curve. Figure 2 Methods to estimate the regularization parameter . (a) L-curve (b) Minimal Product Curve.
Similar to the L -curve method, the Minimal Product method [ ] aims at minimizing the upper bound of the solution and the residual simultaneously (Figure 2b ). In this case the optimum regularization parameter is that corresponding to the minimum value of function P which gives the product between the norm of the solution and the norm of the residual. This approach can be adopted to both continuous and discrete regularization.
P ( α ) = || Ax ( α )||.|| Kx ( α ) - y δ ||
Another well known regularization method is the Generalized Cross Validation (GCV) method [ , ] which is based on the assumption that y is affected by normally distributed noise. The optimum alpha for GCV is that corresponding to the minimum value for the function G : G=||Kx(α)−yδ||2/(Tr(I−KT))2
where T is the inverse operator of matrix K . Hence the numerator measures the discrepancy between the estimated and measured signal y δ while the denominator measures the discrepancy of matrix KT from the identity matrix.
The regularization parameter as estimated by the Composite Residual and Smoothing Operator (CRESO) [ , ] is that which maximizes the derivative of the difference between the residual norm and the semi-norm i.e. the derivative of B ( α ):
B ( α ) = α 2 || Ax ( α )|| 2 - || Kx ( α ) - y δ || 2
Unlike the other described methods for finding the regularization parameter, this method works only for continuous regularization such as Tikhonov.
The final approach to be discussed here is the zero-crossing method [ ] which finds the optimum regularization parameter by solving B ( α ) = 0 where B is as defined in Equation (7). Thus the zero-crossing is basically another way of obtaining the L -curve corner.
One must note that the above estimators for xα(δ)δ are the same as those that result from the minimization of || Ax || subject to Kx = y . In this case x = K (*) ( KK (*) ) -1 y where K (*) = ( AA* ) -1 K* is found with respect to the inner product ⟨⟨ x , y ⟩⟩ = ⟨ Ax , Ay ⟩. This leads to the estimator,
x = ( A*A ) -1 K* ( K ( AA* ) -1 K* ) -1 y
which, if regularized, can be shown to be equivalent to (6).
As regards the EEG inverse problem, using the notation used in the description of the forward problem in Section ??, the Bayesian methods find an estimate Dˆ of D such that Dˆ=min(U(D))
where U(D)=||M−GD||R2+αL(D).
As an example, in [ ] one finds that the linear operator A in Equation ( 5 ) is taken to be a matrix A whose rows represent the averages (linear combinations) of the true sources. One choice of the matrix A is given by Aij = A3(p−1)+k,3(q−1)+m= wjexp−dpq2/σi2 for k=m and zero otherwise
In the above equation, the subscripts p , q are used to indicate grid points in the volume representing the brain and the subscripts k , m are used to represent Cartesian coordinates x , y and z (i.e. they take values 1,2,3), d pq represents the Euclidean distances between the p th and q th grid points. The coefficients w j can be used to describe a column scaling by a diagonal matrix while σ i controls the spatial resolution. In particular, if σ i → 0 and w j = 1 the minimum norm solution described below is obtained.
In the next subsections we review some of the most common choices for L ( D ).
Minimum norm estimates (MNE)
Minimum norm estimates [ , , ] are based on a search for the solution with minimum power and correspond to Tikhonov regularization. This kind of estimate is well suited to distributed source models where the dipole activity is likely to extend over some areas of the cortical surface.
L ( D ) = || D || 2 DˆMNE=(GTG+αIp)−1GTM
or DˆMNE=GT(GGT+αIN)−1M
The first equation is more suitable when N > p while the second equation is more suitable when p > N . If we let T MNE be the inverse operator G T ( GG T + α I N ) -1 , then T MNE G is called the resolution matrix and this would ideally the identity matrix. It is claimed [ , ] that MNEs produce very poor estimation of the true source locations with both the realistic and sphere models.
A more general minimum-norm inverse solution assumes that both the noise vector n and the dipole strength D are normally distributed with zero mean and their covariance matrices are proportional to the identity matrix and are denoted by C and R respectively. The inverse solution is given in [ ]: DˆMNE=RGT(GRGT+C)−1M
R ij can also be taken to be equal to σ i σ j Corr ( i , j ) where σi2 is the variance of the strength of the i th dipole and Corr ( i , j ) is the correlation between the strengths of the i th and j th dipoles. Thus any a priori information about correlation between the dipole strengths at different locations can be used as a constraint. R can also be taken as RiiRjj(Corr(i,j)) where Rii=f(1/ζi) is such that it is large when the measure ζ i of projection onto the noise subspace is small. The matrix C can be taken as σ 2 I if it is assumed that the sensor noise is additive and white with constant variance σ 2 . R can also be constructed in such a way that it is equal to UU T where U is an orthonormal set of arbitrary basis vectors [ ]. The new inverse operator using these arbitrary basis functions is the original forward solution projected onto the new basis functions.
Weighted minimum norm estimates (WMNE)
The Weighted Minimum Norm algorithm compensates for the tendency of MNEs to favour weak and surface sources. This is done by introducing a 3 p × 3 p weighting matrix W : L(D)=||WD||2D^WMNE=(GTG+αWTW)−1GTM (8)
or D^WMNE=(WTW)−1GT(G(WTW)−1GT+αIN)−1M
W can have different forms but the simplest one is based on the norm of the columns of the matrix G : W = Ω ⊗ I 3 , where ⊗ denotes the Kronecker product and Ω is a diagonal p × p matrix with Ωββ=∑α=1Ng(rα,rdipβ)⋅g(rα,rdipβ)T , for β = 1, ..., p .
MNE with FOCUSS (Focal underdetermined system solution)
This is a recursive procedure of weighted minimum norm estimations, developed to give some focal resolution to linear estimators on distributed source models [ , , , ]. Weighting of the columns of G is based on the mag nitudes of the sources of the previous iteration. The Weighted Minimum Norm compensates for the lower gains of deeper sources by using lead-field normalization. D^FOCUSS|i=WiWiTGT(GWiWiTGT+αIN)−1M (9)
where i is the index of the iteration and W i is a diagonal matrix computed using Wi=wiWi−1diag(D^i−1) (10)
wi=diag(1/|G(:,j)||) , j ∈ [1, 2, ..., p ] is a diagonal matrix for deeper source compensation. G(:, j ) is the j th column of G . The algorithm is initialized with the minimum norm solution D^MNE , that is, W0=diag(D^MNE)=diag(D^0(1),D^0(2),...,D^0(3p)) , where D^0 ( n ) represents the n th element of vector D^0 . If continued long enough, FOCUSS converges to a set of concentrated solutions equal in number to the number of electrodes.
The localization accuracy is claimed to be impressively improved in comparison to MNE. However, localization of deeper sources cannot be properly estimated. In addition to Minimum Norm, FOCUSS has also been used in conjunction with LORETA [ ] as discussed below.
Low resolution electrical tomography (LORETA)
LORETA [ , ] combines the lead-field normalization with the Laplacian operator, thus, gives the depth-compensated inverse solution under the constraint of smoothly distributed sources. It is based on the maximum smoothness of the solution. It normalizes the columns of G to give all sources (close to the surface and deeper ones) the same opportunity of being reconstructed. This is better than minimum-norm methods in which deeper sources cannot be recovered because dipoles located at the surface of the source space with smaller magnitudes are priveleged. In LORETA, sources are distributed in the whole inner head volume. In this case, L ( D ) = || ΔB.D || 2 and B = Ω ⊗ I 3 is a diagonal matrix for the column normalization of G . D^LOR=(GTG+αBΔTΔB)−1GTM
or D^LOR=(BΔTΔB)−1GT(G(BΔTΔB)−1GT+αIN)−1M
Experiments using LORETA [ ] showed that some spurious activity was likely to appear and that this technique was not well suited for focal source estimation.
LORETA with FOCUSS [31]
This approach is similar to MNE with FOCUSS but based on LORETA rather than MNE. It is a combination of LORETA and FOCUSS, according to the following steps:
1. The current density is computed using LORETA to get D^LOR .
2. The weighting matrix W is constructed using (10), the initial matrix being given by W0=diag(D^LOR)=diag(D^0(1),D^0(2),...,D^0(3p)) , where D^0 ( n ) represents the n th element of vector D^0 .
3. The current density D^i is computed using (9).
4. Steps (2) and (3) are repeated until convergence.
Standardized low resolution brain electromagnetic tomography
Standardized low resolution brain electromagnetic tomography (sLORETA) [ ] sounds like a modification of LORETA but the concept is quite different and it does not use the Laplacian operator. It is a method in which localization is based on images of standardized current density. It uses the current density estimate given by the minimum norm estimate D^MNE and standardizes it by using its variance, which is hypothesized to be due to the actual source variance S D = I 3 p , and variation due to noisy measurements SMnoise = α I N . The electrical potential variance is S M = GS D G T + SMnoise and the variance of the estimated current density is SD^=TMNESMTMNET=GT[GGT+αIN]−1G . This is equivalent to the resolution matrix T MNE G . For the case of EEG with unknown current density vector, sLORETA gives the following estimate of standardized current density power: D^MNE,lT{[SD^]ll}−1D^MNE,l (11)
where D^MNE,l ∈ ℝ 3 × 1 is the current density estimate at the l th voxel given by the minimum norm estimate and [ SD^ ] ll ∈ ℝ 3 × 3 is the l th diagonal block of the resolution matrix SD^ . It was found [ ] that in all noise free simulations, although the image was blurred, sLORETA had exact, zero error localization when reconstructing single sources, that is, the maximum of the current density power estimate coincided with the exact dipole location. In all noisy simulations, it had the lowest localization errors when compared with the minimum norm solution and the Dale method [ ]. The Dale method is similar to the sLORETA method in that the current density estimate given by the minimum norm solution is used and source localization is based on standardized values of the current density estimates. However, the variance of the current density estimate is based only on the measurement noise, in contrast to sLORETA, which takes into account the actual source variance as well.
Variable resolution electrical tomography (VARETA)
VARETA [ ] is a weighted minimum norm solution in which the regularization parameter varies spatially at each point of the solution grid. At points at which the regularization parameter is small, the source is treated as concentrated When the regularization parameter is large the source is estimated to be zero. D^VAR=argminD,Λ(||M−GD||2+||ΛL3.W.D||2+τ2||L.ln(Λ)−α||2)
where L is a nonsingular univariate discrete Laplacian, L 3 = L ⊗ I 3 × 3 , where ⊗ denotes the Kronecker product, W is a certain weight matrix defined in the weighted minimum norm solution, Λ is a diagonal matrix of regularizing parameters, and parameters τ and α are introduced. τ controls the amount of smoothness and α the relative importance of each grid point. Estimators are calculated iteratively, starting with a given initial estimate D 0 (which may be taken to be D^LOR ), Λ i is estimated from D i - 1 , then D i from Λ i until one of them converges.
Simulations carried out with VARETA indicate the necessity of very fine grid spacing [ ].
Quadratic regularization and spatial regularization (S-MAP) using dipole intensity gradients
In Quadratic regularization using dipole intensity gradients [ ], L ( D ) = || ∇D || 2 which results in a source estimator given by D^QR=(GTG+α∇T∇)−1GTM
or D^QR=(∇T∇)−1GT(G(∇T∇)−1)GT+αIN)−1M
The use of dipole intensity gradients gives rise to smooth variations in the solution.
Spatial regularization is a modification of Quadratic regularization. It is an inversion procedure based on a non-quadratic choice for L ( D ) which makes the estimator become non-linear and more suitable to detect intensity jumps [ ]. L(D)=∑n=1NvΦv(∇D|v)
where N v = p × N n and N n is the number of neighbours for each source j , ∇D | v is the v th element of the gradient vector and Φv(u)=u2/[1+(u/Kv)2] . K v = α v × β v where α v depends on the distance between a source and its current neighbour and β v depends on the discrepancy regarding orientations of two sources considered. For small gradients the local cost is quadratic, thus producing areas with smooth spatial changes in intensity, whereas for higher gradients, the associated cost is finite: Φ v ( u ) ≈ Kv2 , thus allowing the preservation of discontinuities. The estimator at the i th iteration is of the form D^i=Θ(G,L(D^i−1))M
where Θ is a p by N matrix depending on G and priors computed from the previous source estimate D^i−1 .
Spatio-temporal regularization (ST-MAP)
Time is taken into account in this model whereby the assumption is made that dipole magnitudes are evolving slowly with regard to the sampling frequency [ , ]. For a measurement taken at time t , assuming that D^t−1 and D^t may be very close to each other means that the orthogonal projection of D^t on the hyperplane ED^t−1⊥ perpendicular to D^t−1 is 'small'. The following nonlinear equation is obtained: GTG+α(Δt+βPt−1⊥TPt−1⊥)Dt=GTMt
where Δt=−∇xTBxt∇xT∇x−∇yTByt∇y
is a weighted Laplacian and Bxt=diag.[bxt|k]k=1,...,p
with bxt|k=Φ′(∇xDt|k)/2∇xDt|k.
Pt−1⊥ is the projector onto ED^t−1⊥ .
Spatio-temporal modelling
Apart from imposing temporal smoothness constraints, Galka et. al . [ ] solved the inverse problem by recasting it as a spatio-temporal state space model which they solve by using Kalman filtering. The computational complexity of this approach that arises due to the high dimensionality of the state vector was addressed by decomposing the model into a set of coupled low-dimensional problems requiring a moderate computational effort. The initial state estimates for the Kalman filter are provided by LORETA. It is shown that by choosing appropriate dynamical models, better solutions than those obtained by the instantaneous inverse solutions (such as LORETA) are obtained.
3.1.2 The Backus-Gilbert method
The Backus-Gilbert method [ , , ] consists of finding an approximate inverse operator T of G that projects the EEG data M onto the solution space in such a way that the estimated primary current density D^BG = TM , is closest to the real primary current density inside the brain, in a least square sense. This is done by making the 1 × p vector RuvγT=TuγTGv ( u , v = 1, 2, 3 and γ = 1, ..., p ) as close as possible to δuvIγT where δ is the Kronecker delta and I γ is the γ th column of the p × p identity matrix. G v is a N × p matrix derived from G in such a way that in each row, only the elements in G corresponding to the v th direction are kept. The Backus-Gilbert method seeks to minimize the spread of the resolution matrix R , that is to maximize the resolving power. The generalized inverse matrix T optimizes, in a weighted sense, the resolution matrix.
We reproduce the discrete version of the Backus-Gilbert problem as given in [ ]: minTuγ{[Iγ−GuTTuγ]TWγBG[Iγ−GuTTuγ]+∑v=13(1−δvu)TuγTGvGvTTuγ}
under the normalization constraint: TuγTGu1p=1 . 1 p is a p × 1 matrix consisting of ones.
One choice for the p × p diagonal matrix WγBG is: [WγBG]αα=||vα−vγ||2, ∀α,γ=1,...,p
where v i is the position vector of grid point i in the head model. Note that the first part of the functional to be minimized attempts to ensure correct position of the localized dipoles while the second part ensures their correct orientation.
The solution for this EEG Backus-Gilbert inverse operator is: Tuγ=Euγ†Lu/LuTEuγ†Lu
where: Lu=Gu1p,Euγ=Cuγ+∑v=13(1−δuv)Fv,Cuγ=GuWγBGGuT,Fv=GvGvT.
' † ' denotes the Moore-Penrose pseudoinverse.
3.1.3 The weighted resolution optimization
An extension of the Backus-Gilbert method is called the Weighted Resolution Optimization (WROP) [ ]. The modification by Grave de Peralta Menendez is cited in [ ]. WγBG is replaced by W1γGdeP where [W1γGdeP]ll=||vl−vγ||2+βGdeP.
The second part of the functional to be minimzed is replaced by ∑v=13(1−δuv)TuγTGvW2γGdePGvTTuγ
where [W2γGdeP]ll=||vl−vγ||2+βGdeP+αGdeP,
α GdeP and β GdeP are scalars greater than zero. In practice this means that there is more trade off between correct localization and correct orientation than in the above Backus-Gilbert inverse problem.
In this case the inverse operator is: Tuγ=βGdeP{GuW1γGdePGuT+∑v=13(1−δuv)GvW2γGdePGvT}†GuIγ.
In [ ] five different inverse methods (the class of instantaneous, 3D, discrete linear solutions for the EEG inverse problem) were analyzed and compared for noise-free measurements: minimum norm, weighted minimum norm, Backus-Gilbert, weighted resolution optimization (WROP) and LORETA. Of the five inverse solutions tested, only LORETA demonstrated the ability of correct localization in 3D space.
The WROP method is a family of linear distributed solutions including all weighted minimum norm solutions. As particular cases of the WROP family there are LAURA [ , ], a local autoregressive average which includes physical constraints into the solutions and EPI-FOCUS [ ] which is a linear inverse (quasi) solution, especially suitable for single, but not necessarily point-like generators in realistic head models. EPIFOCUS has demonstrated a remarkable robustness against noise.
LAURA
As stated in [ ] in a norm minimization approach we make several assumptions in order to choose the optimal mathematical solution (since the inverse problem is underdetermined). Therefore the validity of the assumptions determine the success of the inverse solution. Unfortunately, in most approaches, criteria are purely mathematical and do not incorporate biophysical and psychological constraints. LAURA (Local AUtoRegressive Average) [ ] attempts to incorporate biophysical laws into the minimum norm solution.
According to Maxwell's laws of electromagnetic field, the strength of each source falls off with the reciprocal of the cubic distance for vector fields and with the reciprocal of the squared distance for potential fields. LAURA method assumes that the electromagnetic activity will occur according to these two laws.
In LAURA the current estimate is given by the following equation: D^LAURA=WjGT(GWj−1GT+αIN)−1M
The W j matrix is constructed as follows:
1. Denote by Vi the vicinity of each solution point defined as the hexahedron centred at the point and comprising at most Vmax = 26 points.
2. For each solution point denote by N k the number of neighbours of that point and by d ki the Euclidean distance from point k to point i (and vice versa).
3. Compute the matrix A using e i = 2 for scalar fields and e i = 3 for vector fields Aii=Vmax/Ni∑k∈Vidki−ei
and Aik=−dki−ei
4. The weight matrix W j is defined by:
W j = P T P
where: P = W m A ⊗ I 3
where I 3 is the 3 × 3 identity matrix and ⊗ denotes the Kronecker product. W m is a diagonal matrix formed by the mean of the norm of the three columns of the lead field matrix associated with the i th point.
3.1.4 Shrinking methods and multiresolution methods
By applying suitable iterations to the solution of a distributed source model, a concentrated source solution may be obtained. Ways of performing this are explained in the next section.
S-MAP with iterative focusing
This modified version [ ] of Spatial Regularization is dedicated to the recovery of focal sources when the spatial sampling of the cortical surface is sparse. The source space dimension is reduced by iterative focusing on the regions that have been previously estimated with significant dipole activity. An energy criterion is used which takes into consideration both the source intensities and its contribution to data:
E = 2 E c + E a
where E c measures the contribution of every dipole source to the data and E a is an indicator of dipole relative magnitudes. Sources with energy greater than a certain threshold are selected for the next iteration. The estimator at the i th iteration is given by D^i=Θ(Gi−1,L(D^i−1)).M
where G i is the column-reduced version of G and Θ is a p i ≤ p by N matrix depending on the G i and priors computed from the previous source estimate D^i−1 . A similar approach was used in [ ] where the source region was contracted several times but at each iteration, LORETA was used to estimate the source tomography.
Shrinking LORETA-FOCUSS
This algorithm combines the ideas of LORETA and FOCUSS and makes iterative adjustments to the solution space in order to reduce computation time and increase source resolution [?, 20]. Starting from the smooth LORETA solution, it enhances the strength of some prominent dipoles in the solution and diminishes the strength of other dipoles. The steps [ ] are as follows:
1. The current density is computed using LORETA to get D^LOR .
2. The weighting matrix W is constructed using (10), its initial value being given by W0=diag(D^LOR)=diag(D^0(1),D^0(2),...,D^0(3p)) .
3. The current density D^i is computed using (9).
4. (Smoothing operation) The prominent nodes (e.g. those with values larger than 1% of the maximum value) and their neighbours are retained. The current density values on these prominent nodes and their neighbours are readjusted by smoothing, the new values being given by 1/sl+1(D^(l)+∑uD^(u)) ∀uunder constraint ||rl−ru||=d
where r l is the position vector of the l th node and s l is the number of neighbouring nodes around the l th node with distance equal to the minimum inter-node distance d .
5. (Shrinking operation) The corresponding elements in Dˆ and G are retained and the matrix M = D Dˆ is computed.
6. Steps (2) to (5) are repeated until convergence.
7. The solution of the last iteration before smoothing is the final solution.
Steps (4) and (5) are stopped if the new solution space has fewer nodes than the number of electrodes or the solution of the current iteration is less sparse than that estimated by the previous iteration. Once steps (4) and (5) are stopped, the algorithm becomes a FOCUSS process. Results [ ] using simulated noiseless data show that Shrinking LORETA-FOCUSS is able to reconstruct a three-dimensional source distribution with smaller localization and energy errors compared to Weighted Minimum Norm, the L 1 approach and LORETA with FOCUSS. It is also 10 times faster than LORETA with FOCUSS and several hundred times faster than the L 1 approach.
Standardized shrinking LORETA-FOCUSS (SSLOFO)
SSLOFO [ ] combines the features of high resolution (FOCUSS) and low resolution (WMN, sLORETA) methods. In this way, it can extract regions of dominant activity as well as localize multiple sources within those regions. The procedure is similar to that in Shrinking LORETA-FOCUSS with the exception of the first three steps which are:
1. The current density is computed using sLORETA to get D^sLOR .
2. The weighting matrix W is constructed using (10), its initial value being given by W0=diag(D^sLOR)=diag(D^0(1),D^0(2),...,D^0(3p)) .
3. The current density D^i is computed using (9). The power of the source estimation is then normalized as D^iT(l){[Ri]ll}−1Di(l) (12)
where Ri=WiWiTGT(GWiWiT+αI)†G and [ R i ] ll is the l th diagonal block of matrix R i .
In [ ], SSLOFO reconstructed different source configurations better than WMN and sLORETA. It also gave better results than FOCUSS when there were many extended sources. A spatio-temporal version of SSLOFO is also given in [ ]. An important feature of this algorithm is that the temporal waveforms of single/multiple sources in the simulation studies are clearly reconstructed, thus enabling estimation of neural dynamics directly from the cortical sources. Neither Shrinking LORETA-FOCUSS nor FOCUSS are able to accurately reconstruct the time series of source activities.
Adaptive standardized LORETA/FOCUSS (ALF)
The algorithms described above require a full computation of the matrix G . On the other hand, ALF [ ] requires only 6%–11% of this matrix. ALF localizes sources from a sparse sampling of the source space. It minimizes forward computations through an adaptive procedure that increases source resolution as the spatial extent is reduced. The algorithm has the following steps:
1. A set of successive decimation ratios on the set of possible sources is defined. These ratios determine successively higher resolutions, the first ratio being selected so as to produce a targeted number of sources chosen by the user and the last one produces the full resolution of the model.
2. Starting with the first decimation ratio, only the corresponding dipole locations and columns in G are retained.
3. sLORETA (Equation( 11 )) is used to achieve a smooth solution. The source with maximum normalized power is selected as the centre point for spatial refinement in the next iteration, in which the next decimation ratio is applied. Successive iterations include sources within a spherical region at successively higher resolutions.
4. Steps 2 and 3 are repeated until the last decimation ratio is reached. The solution produced by the final iteration of sLORETA is used as initialization of the FOCUSS algorithm. Standardization (Equation(12)) is incorporated into each FOCUSS iteration as well.
5. Iterations are continued until there is no change in solution.
It is shown in [ ] that the localization accuracy achieved is not significantly different than that obtained when an exhaustive search in a fully-sampled source space is made. A multiresolution framework approach was also used in [ ]. At each iteration of the algorithm, the source space on the cortical surface was scanned at higher spatial resolution such that at every resolution but the highest, the number of source candidates was kept constant.
3.1.5 Summary
Refering to Equation ( 8 ), Table 1 summarizes the different weight matrices used in the algorithms. Refering to Subsection 3.1.4, Table 2 summarizes the steps involved in the different iterative methods which were discussed. Table 1 Summary of weighting strategies for the various non-parametric methods. For definition of notation, refer to the respective subsection. Algorithm Weight Matrix W MNE I 3 p WMNE Ω ⊗ I 3 LORETA ( Ω ⊗ I 3 )Δ T Δ( Ω ⊗ I 3 ) Quadratic Regularization ∇ LAURA W m A ⊗ I 3 Table 2 Steps involved in the iterative methods Iterative Method Description S-MAP with Iterative Focusing Uses the S-MAP algorithm; an energy criterion is used to reduce the dimension of G ; priors computed from the previous source estimate are used at each new iteration. Shrinking LORETA-FOCUSS LORETA solution computed; Weighting matrix W constructed; FOCUSS algorithm used to estimate Dˆ ; smoothing of current density values of prominent dipoles and their neighbours; shrinking of Dˆ and G ; computation of M = G Dˆ ; process (computation of W etc.) repeated. SSLOFOM sLORETA solution computed; Weighting matrix W constructed; FOCUSS algorithm used to estimate Dˆ ; source estimation power is normalized; smoothing of current density values of prominent dipoles and their neighbours; shrinking of Dˆ and G ; computation of M = G Dˆ ; process (computation of W etc.) repeated. ALF Decimation ratios are defined; first ratio is used to retain the corresponding dipole locations and columns of G ; sLORETA computed; source with maximum normalized power selected as centre point for spatial refinement; next decimation ratio used; process repeated until last ratio is reached; final sLORETA solution used to initialize FOCUSS algorithm with standardization.
3.2 Parametric methods
Parametric Methods are also referred to as Equivalent Current Dipole Methods or Concentrated Source or Spatio-Temporal Dipole Fit Models. In this approach, a search is made for the best dipole position(s) and orientation(s). The models range in complexity from a single dipole in a spherical head model, to multiple dipoles (up to ten or more) in a realistic head model. Dynamic models take into consideration dipole changes in time as well. Constraints on the dipole orientations, whether fixed or variable, may be made as well.
3.2.1 The non-linear least-squares problem
The best location and dipole moment (six parameters in all for each dipole) are usually obtained by finding the global minimum of the residual energy, that is the L 2 -norm || V in - V model ||, where V model ∈ ℝ N represents the electrode potentials with the hypothetical dipoles, and V in ∈ ℝ N represents the recorded EEG for a single time instant. This requires a non-linear minimization of the cost function || M - G ({ r j , rdipi }) D || over all of the parameters ( rdipi , D ). Common search methods include the gradient, downhill or standard simplex search methods (such as Nelder-Mead) [ , , , ], normally including multi-starts, as well as genetic algorithms and very time-consuming simulated annealing [ , , ]. In these iterative processes, the dipolar source is moved about in the head model while its orientation and magnitude are also changed to obtain the best fit between the recorded EEG and those produced by the source in the model. Each iterative step requires several forward solution calculations using test dipole parameters to compare the fit produced by the test dipole with that of the previous step.
3.2.2 Beamforming approaches
Beamformers are also called spatial filters or virtual sensors. They have the advantage that the number of dipoles must not be assumed a priori . The output y ( t ) of the beamformer is computed as the product of a 3 × N (each Cartesian axis is considered) spatial filtering matrix W T with m ( t ), the N × 1 vector representing the signal at the array at a given time instant t associated with a single dipole source, i.e. y ( t ) = W T m ( t ). This output represents the neuronal activity of each dipole d in the best possible way at a given time t .
In beamforming approaches [ ], the signals from the electrodes are filtered in such a way that only those coming from sources of interest are maintained. If the location of interest is r dip , the spatial filter should satisfy the following constraints: WT(rdip)G(r)={I, ||r−rdip||≤δ0, ||r−rdip||>δ
where G ( r ) = [ g ( r , e x ), g ( r , e y ), g ( r , e z )] is the N × 3 forward matrix for three orthogonal dipoles at location r having orientation vectors e x , e y and e z respectively, I is the 3 × 3 identity matrix and δ represents a small distance.
In linearly constrained minimum variance (LCMV) beamforming [ ], nulls are placed at positions corresponding to interfering sources, i.e. neural sources at locations other than r dip (so δ = 0). The LCMV problem can be written as: minWTTr(Cy) subject to WT(rdip)G(rdip)=I
where C y = E [ yy T ] = W T C m W and C m = E [ mm T ] is the signal covariance matrix estimated from the available data. This means that the beamformer minimizes the output energy W T C m W under the constraint that only the dipole at r dip is active at that time. Minimization of variance optimally allocates the stop band response of the filter to attenuate activity originating at other locations. By applying Lagrange multipliers and completing the square (proof in Appendix), one obtains: W(rdip)=[G(rdip)TCm−1G(rdip)]−1G(rdip)TCm−1.
The filter W ( r dip ) is then applied to each of the vectors m ( t ) in M so that an estimate of the dipole moment at r dip is obtained. To perform localization, an estimation of the variance or strength Va^r ( r dip ) of the activity as a function of location is calculated. This is the value of the cost function Tr { W T ( r dip ) C m W ( r dip )} at the minimum, equal to Tr{[GT(rdip)Cm−1G(rdip)]−1} .
This approach can produce an estimate of the neural activity at any location by changing the location r dip . It assumes that any source can be explained as a weighted combination of dipoles. Hence the geometry of sources is not restricted to points but may be distributed in nature according to the variance values. Moreover, this approach does not require prior knowledge of the number of sources and anatomical information is easily included by evaluating Va^r ( r dip ) only at physically realistic source locations.
The resolution of detail obtained by this approach depends on the filter's passband and on the SNR (signal to noise ratio defined as the ratio of source variance to noise variance) associated with the feature of interest. To minimimize the effect of low SNRs, the estimated variance is normalized by the estimated noise spectral spectrum to obtain what is called the neural activity index: Va^rN(rdip)=Va^r(rdip)/Tr{[GT(rdip)Q−1G(rdip)]−1}
where Q is the noise covariance matrix estimated from data that is known to be source free.
Sekihara et. al [ ] proposed an 'eigenspace projection' beamformer technique in order to reconstruct source activities at each instant in time. It is assumed that, for a general beamformer, the matrix W = [ w x , w y , w z ] where the column weight vectors w x , w y and w z , respectively, detect the x , y and z components of the source moment to be determined and are of the form wμ=Cm−1G(rdip)[GT(rdip)Cm−1G(rdip)]−1fμ/fμTΩfμ
where μ = x , y or z , f x = [1, 0, 0] T , f y = [0,1 0] T , f z = [0, 0, 1] T and Ω=[GT(rdip)Cm−1G(rdip)]−1GTCm−2G(rdip)[GT(rdip)Cm−1G(rdip)]−1
The weight vectors for the proposed beamformer, w˜μ , are derived by projecting the weight vectors w μ onto the signal subspace of the measurement covariance matrix: w˜μ=ESESTwμ
where E S is the matrix whose columns consist of the signal-level eigenvectors of C m . This beamformer, when tested on Magnetoencephalography (MEG) experiments, not only improved the SNR considerably but also the spatial resolution. In [ ], it is further extended to a prewhitened eigenspace projection beamformer to reduce interference arising from background brain activities.
3.2.3 Brain electric source analysis (BESA)
In a particular dipole-fit model called Brain Electric Source Analysis (BESA) [ ], a set of consecutive time points is considered in which dipoles are assumed to have fixed position and fixed or varying orientation. The method involves the minimization of a cost function that is a weighted combination of four criteria: the Residual Variance (RV) which is the amount of signal that remains unexplained by the current source model; a Source Activation Criterion which increases when the sources tend to be active outside of their a priori time interval of activation; an Energy Criterion which avoids the interaction between two sources when a large amplitude of the waveform of one source is compensated by a large amplitude on the waveform of the second source; a Separation Criterion that encourages solutions in which as few sources as possible are simultaneously active.
3.2.4 Subspace techniques
We now consider parametric methods which process the EEG data prior to performing the dipole localization. Like beamforming techniques, the number of dipoles need not be known a priori . These methods can be more robust since they can take into consideration the signal noise when performing dipole localization.
Multiple-signal Classification algorithm (MUSIC)
The multiple-signal Classification algorithm (MUSIC) [ , ] is a version of the spatio-temporal approach. The dipole model can consist of fixed orientation dipoles, rotating dipoles or a mixture of both. For the case of a model with fixed orientation dipoles, a signal subspace is first estimated from the data by finding the singular value decomposition (SVD) [ ] M = UΣV T and letting U S be the signal subspace spanned by the p first left singular vectors of U . Two other methods of estimating the signal subspace, claimed to be better because they are less affected by spatial covariance in the noise, are given in [ ]. The first method involves prewhitening of the data matrix making use of an estimate of the spatial noise covariance matrix. This means that the data matrix M is transformed so that the spatial covariance matrix of the transformed noise matrix is the identity matrix. The second method is based on an eigen decomposition of a matrix product of stochastically independent sweeps. The MUSIC algorithm then scans a single dipole model through the head volume and computes projections onto this subspace. The MUSIC cost function to be minimized is ||PS⊥g(r,e)||2/||g(r,e)||2
where PS⊥=I−(USUST) is the orthogonal projector onto the noise subspace, r and e are position and orientation vectors, respectively. This cost function is zero when g ( r , e ) corresponds to one of the true source locations and orientations, r = rdipi and e = edi , i = 1, ..., p . An advantage over least-squares estimation is that each source is found in turn, rather than searching simultaneously for all sources.
In MUSIC, errors in the estimate of the signal subspace can make localization of multiple sources difficult (subjective) as regards distinguishing between 'true' and 'false' peaks. Moreover, finding several local maxima in the MUSIC metric becomes difficult as the dimension of the source space increases. Problems also arise when the subspace correlation is computed at only a finite set of grid points.
Recursive MUSIC (R-MUSIC) [ ] automates the MUSIC search, extracting the location of the sources through a recursive use of subspace projection. It uses a modified source representation, referred to as the spatio-temporal independent topographies (IT) model, where a source is defined as one or more nonrotating dipoles with a single time course rather than an individual current dipole. It recursively builds up the IT model and compares this full model to the signal subspace.
In the recursively applied and projected MUSIC (RAP-MUSIC) extension [ , ], each source is found as a global maximizer of a different cost function. Assuming g ( r , e ) = h ( r ) e , the first source is found as the source location that maximizes the metric r^1=argmaxr(subcorr(h(r),US)1)
over the allowed source space, where r is the nonlinear location parameter. The function subcorr ( h ( r ), U S ) 1 is the cosine of the first principal angle between the subspaces spanned by the columns of h ( r ) and U S given by: subcorr(h(r),US)12=(h(r)TUS,USTh(r))/(h(r)Th(r))
The k -th recursion of RAP-MUSIC is r^k=argmaxr(subcorr(ΠG^k−1⊥h(r),ΠG^k−1⊥US)1) (13)
where G^k−1≡[g(r^1,e^1)...g(r^k−1,e^k−1)] is formed from the array manifold estimates (g(r^i,e^i)=h(r^i)e^i) of the previous k - 1 recursions and ΠG^k−1⊥≡(I−G^k−1(G^k−1TG^k−1)−1G^k−1T) is the projector onto the left-null space of G^k−1 . The recursions are stopped once the maximum of the subspace correlation in (13) drops below a minimum threshold.
A key feature of the RAP-MUSIC algorithm is the orthogonal projection operator which removes the subspace associated with previously located source activity. It uses each successively located source to form an intermediate array gain matrix and projects both the array manifold and the estimated signal subspace into its orthogonal complement, away from the subspace spanned by the sources that have already been found. The MUSIC projection to find the next source is then performed in this reduced subspace. Other sequential subspace methods besides R-MUSIC and RAP-MUSIC are S-MUSIC and IES-MUSIC [ ]. Although they all find the first source in the same way, in these latter methods the projection operator is applied just to the array manifold, rather than to both arguments as in the case of RAP-MUSIC.
FINES subspace algorithm
An alternative signal subspace algorithm [ ] is FINES (First Principal Vectors). This approach, used in order to estimate the source locations, employs projections onto a subspace spanned by a small set of particular vectors (FINES vector set) in the estimated noise-only subspace instead of the entire estimated noise-only subspace as in the case of classic MUSIC.
In FINES the principal angle between two subspaces is defined according to the closeness criterion [ ]. FINES creates a vector set for a region of the brain in order to form a projection operator and search for dipoles in this specific region.
An algorithmic description of the FINES algorithm can be found in [ ]. Simulation results in [ ] show that FINES produces more distinguishable localization results than classic MUSIC and RAP-MUSIC even when two sources are very close spatially.
3.2.5 Simulated annealing and finite elements
In [ ], an objective function based on the current-density boundary integral associated with standard finite-element formulations in two dimensions is used instead of measured potential differences, as the basis for optimization performed using the method of simulated annealing. The algorithm also enables user-defined target search regions to be incorporated. In this approach, the optimization objective is to vary the modelled dipole such that the Neumann boundary condition is satisfied, that is, the current density at each electrode approaches zero. min∑t=1NC(xp,yp,θp,dp)l=min∑l=1N(∮n^.Jlψlds)2
where C ( x p , y p , θ p , d p ) l is the objective function associated with the l th electrode resulting from p dipoles, N is the number of electrodes, J l is the current density associated with the l th electrode, ψ l represents the weighting function associated with the l th electrode and n^ is the outward-pointing normal direction to the boundary of the problem domain. This formulation allows for the single calculation of the inverse or preconditioner matrix in the case of direct or iterative matrix solvers, respectively, which is a significant reduction in the computational time associated with 3-D finite element solutions.
3.2.6 Computational intelligence algorithms
Neural networks
Since the inverse source localization problem can be considered a minimization problem – find the optimal coordinates and orientation for each dipole – the optimization can be performed with an artificial neural network (ANN) based system.
The main advantage of neural network approaches [ ] is that once trained, no further iterative process is required. In addition, although iterative methods are shown to be better in noise free environments, ANN performs best in environments with low signal to noise ratio [ ]. Therefore ANNs seem to be more noise robust. In any case, many research works [ , , , , , , , , ] claim a localization error in ANN methods of less than 5%.
A general ANN system for EEG source localization is illustrated in Figure 3 . According to [ ], the number of neurons in the input layer is equal to the number of electrodes and the features at the input can be directly the values of the measured voltage. The network also consists of one or two hidden layers of N neurons each and an output layer made up of six neurons, 3 for the coordinates and 3 for dipole components. In addition each hidden layer neuron is connected to the output layer with weights equal to one in order to permit a non-zero threshold of the activation function. Weights of inter connections are determined after the training phase where the neural network is trained with preconstructed examples from forward modeling simulations. Figure 3 General block diagram for an artificial neural network system used for inverse source localization.
Genetic algorithms
An alternative way to solve the inverse source localization problem as a minimization problem is to use genetic algorithms. In this case dipoles are modelled as a set of parameters that determine the orientation and the location of the dipole and the error between the projected potential and the measured potentials is minimized by genetic algorithm evolutionary techniques.
The minimization operation can be performed in order to localize multiple sources either in the brain [ ] or in Independent Component backprojections [ , ]. If component back-projections are used, the correlation between the projected model and the measured one will have to be minimized rather than the energy of the difference.
Figure 4 shows how the minimization approach develops. An initial population is created, this being a set of potential solutions. Every solution of the set is encoded e.g. binary code and then a new population is created with the application of three operators: selection, crossover and mutation. The procedure is repeated until convergence is reached. Figure 4 Genetic algorithm schema.
3.2.7 Estimation of initial dipoles for parametric methods
In most parametric methods, the final result is extremely dependent on the initial guess regarding the number of dipoles to estimate and their initial locations and orientations. Estimates can be obtained as explained below.
The optimal dipole
In this model, any point inside the sphere has an associated optimal dipole [ ], which fits the observed data better than any other dipole that has the same location but different orientation. The unknown parameters of an optimal dipole are the magnitude components d x , d y and d z (which is a linear least-squares problem).
There are two possible ways for finding the required optimal dipoles. The first is a minimization iteration, where a few optimal dipoles are found in an arbitrary region. The steepest slope with respect to the spatial coordinate is then found and a new search region is obtained. Optimal dipoles in that region are found, a new slope is determined and so on, until the best of all optimal dipoles is found.
The second way is to find optimal dipoles at a dense grid of points that covers the volume in which the dipolar source is expected to be. The best of all the optimal dipoles is the chosen optimal dipole.
Stagnant dipoles
Stagnant dipoles [ ] have only time varying amplitude (dipole magnitude). So the number of unknowns is p (5 + T ) where p is the number of dipoles and T is the number of time-samples. In this model, the minimum number of dipoles L (assumed to be smaller than N or T ) required to describe the observed responses adequately was determined. The resulting residual between the data matrix M and the corresponding model predictions M^ is expressed as Tr[(M−M^)(M−M^)T]
where M^ is a N × T matrix of rank L . It is found that the resulting residual will never exceed the true residual H : H≥minrank(M^)=LTr[(M−M^)(M−M^)T].
This is equivalent to H≥∑k=L+1min(N,T)λk2
where λ k are the singular values of M , arranged in decreasing order. Hence more sources haveto be included in the model till the lower bound is smaller than the noise level H .
4 Performance analysis
In this section we do a comparative review of the performance of different methods as recorded in the literature and subsequently report our own Monte-Carlo comparative experiments. Various measures have been used to determine the quality of localization obtained by a given algorithm and each measure represents some performance aspect of the algorithm such as localization error, smoother error, generalization etc. In the following we review a number of measures that capture various characteristics of localization performance.
For a single point source, localization error is the distance between the maximum of the estimated solution and the actual source location [ , , ]. An extension of this which takes into consideration the magnitudes of other sources besides the maximum is the formula ∑n=1p|D^(n)|dn
where d n = | rdipn - r dip | is the distance from the n th element to the true source [ ].
The energy error [ ], which describes the accuracy of the dipole magnitudes, is defined as Eenergy=|1−||D^max||/||D|||
where ||D^max|| is the power of the maxima in the estimated current distribution and || D || is the power of the simulated point source.
Baillet and Garnero [ ] also determine the Data Fit and Reconstruction Error to evaluate the performance of their algorithms where Data Fit is defined as ||M−GD^||/||M||
and the Reconstruction Error (in which orientation of the dipoles is taken into consideration) is defined as ||D−D^||/||D||.
Baillet [ ] also estimates the distance between the actual source location and the position of the centre of gravity of the source estimate by: |∑n=1p|D^(n)||rdipn|/∑n=1p|D^(n)|−|rdip||
where rdipn is the location of the n th source with intensity Dˆ ( n ) and r dip is the original source location.
E spurious [ ] is defined as the relative energy contained in spurious or phantom sources with regards to the original source energy.
For two dipoles [ ], the true sources are first subtracted from the reconstructions. The error is: ∑n=1p|D^(n)|(sn1dn1+sn2dn2)
where d n 1 and d n 2 are the distances from each element to the corresponding source, s n 1 and s n 2 were used to reduce the penalty due to the distance between a source and a part of the solution near the other source. This means that a large dipole magnitude solution near to one source should not give rise to an improper error estimate due to the potentially large distance to the other source. s n 1 can be chosen in the following way: sn1={βdn2 (whereβ>0),1, for dn2<some numberotherwise
and similarly for s n 2 using d n 1 .
In [ ], Yao and Dewald used three indicators to determine the accuracy of the inverse solution:
1. the error distance (ED) which is the distance between the true and estimated sources defined as 1/NI∑iNIminj{||r^dipi−rdipj||}+1/NJ∑j∈JNJmini{||rdipj−r^dipi||}. (14)
rdipi is the real dipole location of the simulated EEG data. r^dipi is the source location detected by the inverse calculation method. i and j are the indices of locations of estimated and the actual sources. N I and N J are the total numbers of estimated and undetected sources respectively. In current distributed-source reconstruction methods, a source location was defined as the location where the current strength was greater than a set threshold value. The first term in (14) calculates the mean of the distance from each estimated source to its closest real source. The corresponding real source is then marked as a detected source. All the undetected real sources made up the elements of data set J . The second term calculates the mean of the distance from each of the undetected sources to the closest estimated sources.
2. the percentage of undetected source number (PUS) defined as Nun/Nreal where N un and N real are the numbers of undetected and real sources respectively. An undetected source is defined as a real source whose location to its closest estimated source is larger than 0.6 times the unit distance of the source layer.
3. the percentage of falsely-detected source number (PFS) defined as Nfalse/Nestimated where N false and N estimated are the numbers of falsely-detected and estimated sources respectively. A falsely-detected source is defined as an estimated source whose location to its closest real source is larger than 0.6 times the unit distance of the source layer.
The accuracy with which a source can be localized is affected by a number of factors including source-modeling errors, head-modeling errors, measurement-location errors and EEG noise [ ]. Source localization errors depend also on the type of algorithm used in the inverse problem. In the case of L 1 and L 2 minimum norm approaches, the localization depends on several factors: the number of electrodes, grid density, head model, the number and depth of the sources and the noise levels.
In [ ], the effects of dipole depth and orientation on source localization with varying sets of simulated random noise were investigated in four realistic head models. It was found that if the signal-to-noise ratio is above a certain threshold, localization errors in realistic head models are, on average, the same for deep and superficial sources and no significant difference in accuracy for radial or tangential dipoles is to be expected. As the noise increases, localization errors increase, particularly for deep sources of radial orientation. Similarly, in [ ] it was found that the importance of the realistic head model over the spherical head model reduces by increasing the noise level. It has also been found that solutions for multiple-assumed sources have greater sensitivity to small changes in the recorded EEGs as compared to solutions for a single dipole [ ].
4.1 Literature review of performance results of different inverse solutions
This section provides a review of the performance results of the different inverse solutions that have been described above and cites literature works where some of these solutions have been compared.
In [ ], Pascual-Marqui compared five state-of-the-art parametric algorithms which are the minimum norm (MN), weighted minimum norm (WMN), Low resolution electromagnetic tomography (LORETA), Backus-Gilbert and Weighted Resolution Optimization (WROP). Using a three-layer spherical head model with 818 grid points (intervoxel distance of 0.133) and 148 electrodes, the results showed that on average only LORETA has an acceptable localization error of 1 grid unit when simulating a scenario with a single source. The other four inverse solutions failed to localize non-boundary sources and hence the author states that these solutions cannot be classified as tomographies as they lack depth information. When comparing MN solutions and LORETA solutions with different L p norms, Jun Yao et al . [ ] have also found out that LORETA with the L 1 norm gives the best overall estimation. In this analysis a Boundary Element Method (BEM) realistic head model was used and the simulated data consisted of three different datasets, designed to evaluate both localization ability and spatial resolution. Unlike the data in [ ], this simulated data included noise and the SNR was set to 9–10 dB in each case. The results provided were the averaged results over 10 time samples. In [ ] these current distribution methods were also compared to dipole methods where only a number of discrete generators are active. Results showed that although these methods give relatively low error distance measures, meaning that a priori knowledge of the number of dipoles could improve the inverse results, a medial and posterior shift occurred for all the three datasets. This shift was not present for current distribution methods. Jun Yao et al . have also used the percentage of undetected sources (PUS) as a measure to compare solutions. LORETA with the L 1 norm resulted in a significantly smaller and less variable PUS when compared to all other methods tested in this paper [ ]. The techniques were also applied to real data and once again the same approach gave qualitatively superior results which match those obtained with other neuroimaging techniques or cortical recordings.
Pascual-Marqui has also tested the effect on localization when the simulated data is made up of two sources [ ]. In this case the LORETA and WROP solutions were used to localize these two sources, one of which was placed very deep. LORETA identified both sources but gave a blurred result, hence its name low resolution, but WROP did not succeed in identifying the two sources. MN, WMN and Backus-Gilbert gave a similar performance. From this analysis, Pascual-Marqui concluded that LORETA has the minimum necessary condition of being a tomography, however this does not imply that any source distribution can be identified suitably with LORETA [ ].
In [ ], Pascual-Marqui developed another algorithm called sLORETA. The name itself gives the impression that this is an updated version of LORETA but in fact it is based on the MN solution. The latter is known to suffer considerably when trying to localize deep sources. sLORETA handles this limitation by standardizing the MN estimates and basing localization inference on these standardized estimates [ ]. When using a 3-layer spherical head model registered to the Talairach human brain atlas and assuming 6340 voxels with 5 mm resolution, sLORETA was found to give zero localization error for noiseless, single source simulations. In this case the solution space was restricted to the cortical gray matter and hippocampus areas. The same algorithm was tested on noisy data with noise scalp field standard deviation equal to 0.12 and 0.082 times the source with lowest scalp field standard deviation. The regularization parameter was in this case estimated using cross-validation. When compared to the Dale method, sLORETA was found to have the lowest localization errors and the lowest amount of blurring [ ].
Another inverse solution considered as a complement to LORETA is VARETA [ ]. This is a weighted minimum norm solution in which a regularization parameter that varies spatially is used. In LORETA this regularization parameter is a constant. In VARETA this parameter is altered to incorporate both concentrated and distributed sources. In [ ], this inverse solution is compared to the FOCUSS algorithm [ ]. The latter is a linear estimation method based on recursive, weighted norm minimization. When tested on noise-free simulations made up of a single or multi-source, FOCUSS achieved correct identification but the algorithm is initialization dependent. Iteratively it changes the weights based on the strength of the solution data in the last iteration and it converges to a set of concentrated sources which are equal in number to the number of electrodes. VARETA on the other hand is based on a Bayesian approach and does not necessarily converge to a set of dipoles if the simulated sources are distributed [ ].
In [ ], Hesheng Liu et al . developed another algorithm based on the foundation of LORETA and FOCUSS. This algorithm, called Shrinking LORETA FOCUSS (SLF) was tested on single and multi-source reconstruction and was compared to three other inverse solutions, mainly WMN, L1-NORM and LORETA-FOCUSS. In all scenarios considered, consisting of a number of sources organized in different arrangements and having different strengths and positions, SLF gave the closest solution to what was expected. WMN often gave a very blurred result, L1-NORM resulted in spurious sources or solutions with blurred images and incorrect amplitudes and LORETA-FOCUSS gave generally a high resolution but some sources were sometimes lost or had varying magnitude. LORETA-FOCUSS was found to have a localization error which was 3.2 times larger than that of SLF and an energy error which is 11.6 times larger. SLF is based on the assumption that the neuronal sources are both focal and sparse. If this is not the case and sources are distributed over a large area, then a low resolution solution as that offered by LORETA would be more appropriate [ ].
Hesheng Liu [ ] states that in situations where few sources are present and these are clustered, high resolution algorithms such as MUSIC can give better results. Solutions such as FOCUSS are also capable of reconstructing space sources. The performance of these algorithms degrades when the sources are large in number and extended in which case low resolution solutions such as LORETA and sLORETA are better. To achieve satisfactory results in both circumstances Hesheng Liu developed the SSLOFO algorithm [ ]. Apart from localizing the sources with relatively high spatial resolution this algorithm gives also good estimates of the time series of the individual sources. Algorithms such as LORETA, sLORETA, FOCUSS and SLF fail to recover this temporal information satisfactorily. When compared with sLORETA for single source reconstruction, the mean error for SSLOFO was found to be 0 and the mean energy error was 2.99%. The mean error for sLORETA is also 0 but the mean energy error goes up to 99.55% as sLORETA has very poor resolution and a high point spread function [ ]. In this same paper the authors have also analyzed the effect of noise. Noise levels ranging from 0 to 30 dB were considered and the mean localization error over a total of 2394 voxel positions was found. WMN and FOCUSS both resulted in large localization errors. sLORETA compared well with SSLOFO for a single source especially when the level of noise was high. When it comes to temporal resolution however, SSLOFO gave the best results. WMN mixed signals coming from nearby sources, sLORETA can only give power values and FOCUSS cannot produce a continuous waveform [ ].
Another technique similar to SSLOFO in that it can capture spatial and temporal information is the ST-MAP [ ]. If only spatial information is taken into account, the so called S-MAP succeeds in recovering most edges, preserving the global temporal shape but with possible sharp magnitude variations. The ST-MAP however gives a much smoother reconstruction of dipoles which helps stabilize the algorithm and reduce the computation time by 22% when compared to the S-MAP. These results were compared to those obtained by Quadratic Regularization (QR) and LORETA and the error measures were based on the data fit and reconstruction error. S-MAP and ST-MAP were both found to be superior to these algorithms as they give much smoother solutions and reasonably lower reconstruction errors [ ].
Since the inverse problem in itself is underdetermined, most solutions use a mathematical criteria to find the optimal result. This however leaves out any reliable biophysical and psychological constraints. LAURA takes this into consideration and incorporates biophysical laws in the minimum norm solutions (MN, WMN, LORETA and EPIFOCUS [ ]) and the simulation showed that EPIFOCUS and LAURA outperform LORETA. This comparison was done by measuring the percentage of dipole localization error less than 2 grid points.
Another solution to the inverse problem which was mentioned in Section 3.2.1 is BESA. This technique is very sensitive to the initial guess of the number of dipoles and therefore is highly dependent on the level of user expertise. In [ ] it is shown that the grand average location error of 9 subjects who were familiar with evoked potential data was 1.4 cm with a standard deviation of 1 cm.
Rather than finding all possible sources simultaneously as is the case with direct least squares methods such as MN and LORETA, another class of inverse solutions exist based on signal subspace decomposition. A well known technique falling within this class is the multiple signal Classification (MUSIC) algorithm and its variants. These algorithms were developed because generally solutions were based on fitting a multiple modeling technique to a single time sample of EEG data [ ]. Processing the whole length of data available then resulted in a large set of unknown parameters. Furthermore many techniques have the problem of getting trapped in local minima when minimizing their cost function. MUSIC and its variants were developed to overcome these problems and this is achieved by scanning a single dipole through a voxel grid placed within the 3D head model and working out the forward model at each voxel within the grid, projected against a signal subspace computed for that EEG data. Locations within this grid where the source model gave the best projections onto the signal subspace correspond to the dipole positions. In [ ] a conventional two source uniform linear array example was used to compare various versions of MUSIC. A Monte Carlo test was carried out by allowing various runs to find each individual source. For uncorrelated sources all algorithms (MUSIC, S-MUSIC, IES-MUSIC, R-MUSIC and RAP-MUSIC) gave similar results but different performances were then observed as the level of correlation increased. At a correlation coeficient of 0.7, IES-MUSIC and RAP-MUSIC were found to have an RMS error around 25% better than that of MUSIC and S-MUSIC and 50% better than R-MUSIC. As the correlation increases RAP-MUSIC was found to give the best performance but at a value of 0.975 all methods experienced comparable difficulties in estimating the sources. RAP-MUSIC has the added advantage that it provides an automatic way of terminating the search for additional sources when the signal subspace is overestimated [ ].
Another comparison with MUSIC and RAP MUSIC was done by using FINES, another signal subspace algorithm. In [ ] a two-dipole simulated dataset in both noise-free and noisy environments was used for this comparison. In the noise-free case, FINES performs better than MUSIC with 0.2 mm and 1 mm lower error for the two dipoles respectively. When noise was added, FINES was still found to be superior than both MUSIC and RAP-MUSIC. The localization error for a SNR of 14 dB was found to be 1.4 mm and 1.5 mm lower when using FINES. In [ ], He and Ding applied a similar analysis but this time using a realistic head model. The results are consistent with [ ] showing that FINES is superior in the noisy scenario.
The literature review above shows that various comparisons have been performed between groups of inverse solutions. In the following subsection we would like to contribute to this comparative study by discussing the results obtained when performing a Monte-Carlo analysis to compare four non-parametric approaches of solving the EEG inverse problem. To our knowledge, such an analysis has not yet been carried out in the literature.
4.2 Monte Carlo performance analysis of non-parametric inverse solutions
Four widely used non-parametric approaches of solving the inverse problem were compared using a Monte-Carlo analysis where at each simulated dipole position (108 positions considered in total) a total of 100 source localization trials were performed. The effects of regularization and noise on each respective inverse solution were also analyzed.
4.2.1 Inverse solutions
The four inverse solutions compared here were all implemented in MATLAB and included:
Weighted Minimum Norm (WMN)
Low Resolution Electromagnetic Tomography (LORETA)
Standardized LORETA (sLORETA)
Shrinking LORETA-FOCUSS (SLF)
These techniques were described in detail in earlier sections, thus they will not be described again here. For the SLF algorithm, however, the authors would like to point out that during the smoothing process, nodes at the boundary of the solution space were not smoothed as they have a limited amount of neighbours attributed to them. Also the recursive procedure was repeated until one of the following conditions was true: i) the number of prominent nodes in the solution space is less than the number of sensors, ii) the difference between the norms of consecutive current densities is less than 0.001, iii) the number of prominent nodes increases from one iteration to the next.
4.2.2 Simulated data
A three-layer spherical head model with the properties as shown in Table 3 was considered: Table 3 Properties of the 3-layer spherical head model Radius of scalp 8 cm Radius of skull 8/1.06 cm Radius of cortex 8/1.15 cm Conductivity of scalp 2860 mS/m Conductivity of skull 2860/80 mS/m Conductivity of cortex 2860 mS/m
Within the cortex, a grid made up of 755 voxels with inter-voxel distance of 1 cm was used. This choice was similar to that in [ ] where the assumed unit spherical head model consisted of a grid made up of 818 voxels with an inter-voxel distance of 0.133. Higher resolutions of 7 mm and 5 mm were used in [ ] and [ ] respectively but the Monte Carlo analysis performed here placed some computational constraints restricting the choice of a finer resolution. Furthermore, in this analysis singular radial dipoles were considered. These dipoles had unit magnitude and were placed at each of 108 equally distributed positions out of the available 755 positions. For a radial dipole with Cartesian coordinates ( a , b , c ) and a sphere with center at (0, 0, 0), the dipole moment e d is given by: ed=(a,b,c)/a2+b2+c2 (15)
For each simulated radial dipole, the resultant EEG at 32 electrodes, as specified by the 10–20 International electrode placement system, was calculated. Additive white Gaussian noise was then added to the noise-free data under four different signal-to-noise ratios conditions, namely 25 dB, 15 dB, 10 dB and 5 dB. To perform a Monte-Carlo analysis, for each of the 108 positions considered and for each SNR, 100 trials were simulated where the difference between trials is simply a different additive noise vector.
4.2.3 Procedure
Current density estimate
For each scalp potential recording, the current density at each of the 755 voxels within the brain was estimated using the four different inverse solutions respectively. In order to analyze the effect of regularization on the solutions, the four methods were applied both without regularization and with regularization. For the latter case, Tikhonov regularization was used and the optimal value for the regularization parameter was found using the L -curve method. The MATLAB toolbox of Christian Hansen was used in this case [ ].
Maxima
Once the current density estimates were available, the locations and normalized magnitudes of local maxima were found. A voxel was considered to hold a local maximum if the magnitude 28 of its neighbours was found to be lower than the magnitude of itself.
Error distance measures
The locations and magnitudes of the local maxima were used to find the deviations of estimated solution from the expected solution. Two different error measures were used compare the different inverse solutions. Error Distance measure ED1 was based on the distance between the location of the global maximum rdipmax to that of the actual position r dip of the simulated dipolar source. ED1=|rdipmax−rdip| (16)
The goal of using this error measure is that for the single dipolar source scenario as considered here, this is a good measure to identify whether the largest activity corresponds to the actual simulated activity. However, in a real data scenario it is unknown as to the actual number of sources being active within the brain at a particular instant in time. For this reason, a second error measure was used which penalizes each solution for the number of resulting 'ghost' maxima. A ghost maxima is one which was not actually present in the simulated scenario. This measure, ED2, sums a weighted distance measure across the resulting number of local maxima p where d n = | rdipn - r dip | and | D^ ( n )| is the magnitude of the local maxima rdipn normalized to the value of the global maximum of | D^ ( n )|. ED2=∑n=1pdn.|D^(n)| (17)
Statistical analysis
The error distance measures ED1 and ED2 were used as the cost functions to compare the different inverse solutions, their response in different noise conditions and the effect of regularization on the solution. Rather than analyzing the differences at each of the 108 considered dipole locations, the simulated sources were grouped into three regions made up of:
Surface sources
Mid-depth sources
Deep sources
Figure 5 shows the individual layers in which the considered sources lie and the way in which these sources are grouped. Red crosses represent the surface sources, black crosses the mid-depth sources and blue crosses the deep sources. Layers are stacked onto each other at a distance of 2 cm. Figure 5 Individual Layers in which the simulated dipoles lie . Red crosses represent sources lying close to the surface (57 in total), black crosses represent sources lying in the middle of the spherical cortex model (37 in total) and blue crosses represent sources lying deep within the cortex (14 in total).
The error distance measures for sources within each region were then averaged giving an average error value per region. These were then used to compare the different solutions. Statistical analysis of the data was then carried out through SPSS [ ]. To identify whether there are significant differences between the four implemented solutions, ANOVA which is based on the following set of assumptions was used:
1. Observations within each population must be normally distributed
2. Variances between populations must be homogeneous
3. The populations represent independent random samples
Since the data being analyzed was coming from four different solutions, assumption 3 was automatically validated. If assumptions 1 and 2 were found to be true, ANOVA was then used to find whether there are significant differences between the four solutions and if such differences were found, post-hoc tests were used to identify which pairs of solutions are causing these differences. If all assumptions 1 to 3 were true, Tukey's test was used for post-hoc analysis and if the homogeneity assumption 2 was violated, Games-Howell test was used instead. If on the other hand both normality and homogeneity of variance tests failed, violating assumptions 1 and 2, then the equivalent non-parametric approach to ANOVA was used – the Kruskal-Wallis test. In this case post hoc tests were carried out using the Mann-Whitney test with Bonferroni correction [ ].
4.2.4 Discussion of results
Tables 4 – 5 and 6 – 7 show the averaged error distance measures, ED1 and ED2 respectively, for surface, mid-depth and deep sources, for each of the four implemented inverse algorithms. Table 4 Error measure ED1 for the four inverse algorithms, without regularization, under four different noise levels: 25 dB, 15 dB, 10 dB and 5 dB. Each cell value gives the mean and standard deviation. ED1 Unregularised SNR/dB 5 10 15 25 Layer WMN Surface 5.71 ± 0.49 3.75 ± 0.36 2.36 ± 0.27 1.18 ± 0.04 Middle 7.21 ± 0.42 6.58 ± 0.52 5.11 ± 0.37 2.74 ± 0.18 Deep 6.76 ± 0.39 6.72 ± 0.35 6.46 ± 0.39 4.98 ± 0.33 sLORETA Surface 4.47 ± 0.43 2.05 ± 0.31 0.81 ± 0.13 0.04 ± 0.03 Middle 6.46 ± 0.42 4.76 ± 0.43 2.12 ± 0.34 0.11 ± 0.05 Deep 6.48 ± 0.37 6.01 ± 0.50 3.68 ± 0.64 0.15 ± 0.11 LORETA Surface 5.49 ± 0.46 3.59 ± 0.39 2.03 ± 0.25 1.32 ± 0.02 Middle 6.23 ± 0.41 5.54 ± 0.48 3.64 ± 0.44 1.14 ± 0.09 Deep 5.78 ± 0.37 5.64 ± 0.37 5.30 ± 0.41 2.69 ± 0.39 SLF Surface 6.38 ± 0.39 5.17 ± 0.36 3.65 ± 0.36 2.17 ± 0.14 Middle 5.91 ± 0.45 5.35 ± 0.44 3.92 ± 0.41 1.92 ± 0.17 Deep 5.31 ± 0.49 5.08 ± 0.43 4.46 ± 0.55 1.95 ± 0.46 Table 5 Error measure ED1 for the four inverse algorithms, with regularization, under four different noise levels: 25 dB, 15 dB, 10 dB and 5 dB. Each cell value gives the mean and standard deviation. ED1 Regularised SNR/dB 5 10 15 25 Layer WMN Surface 3.46 ± 0.42 2.10 ± 0.28 1.34 ± 0.11 1.13 ± 0.03 Middle 5.08 ± 0.50 3.94 ± 0.38 2.95 ± 0.21 2.40 ± 0.03 Deep 5.91 ± 0.39 5.31 ± 0.36 4.61 ± 0.24 3.89 ± 0.15 sLORETA Surface 0.99 ± 0.1 0.49 ± 0.08 0.11 ± 0.04 0.00 ± 0.00 Middle 1.61 ± 0.13 0.84 ± 0.11 0.25 ± 0.07 0.00 ± 0.00 Deep 1.79 ± 0.25 0.95 ± 0.16 0.39 ± 0.13 0.00 ± 0.00 LORETA Surface 2.32 ± 0.08 2.18 ± 0.04 2.16 ± 0.03 2.21 ± 0.02 Middle 1.51 ± 0.13 1.15 ± 0.08 0.95 ± 0.07 1.05 ± 0.06 Deep 2.30 ± 0.21 1.81 ± 0.13 1.59 ± 0.11 1.53 ± 0.09 SLF Surface 5.27 ± 0.30 4.50 ± 0.28 3.81 ± 0.20 2.98 ± 0.13 Middle 4.53 ± 0.39 4.09 ± 0.35 3.50 ± 0.31 2.51 ± 0.15 Deep 3.89 ± 0.55 3.70 ± 0.45 3.27 ± 0.48 1.73 ± 0.30 Table 6 Error measure ED2 for the four inverse algorithms, without regularization, under four different noise levels: 25 dB, 15 dB, 10 dB and 5 dB. Each cell value gives the mean and standard deviation. ED2 Unregularised SNR/dB Layer 5 10 15 25 WMN Surface 38.49 ± 1.70 30.92 ± 1.34 19.32 ± 0.94 9.91 ± 0.40 Middle 39.39 ± 2.04 37.90 ± .81 29.13 ± 1.39 18.28 ± 0.92 Deep 37.65 ± 3.18 37.16 ± 3.11 31.80 ± 2.71 28.79 ± 2.21 sLORETA Surface 21.35 ± 1.25 12.13 ± 0.81 4.85 ± 0.41 0.44 ± 0.05 Middle 25.50 ± 1.59 21.06 ± 1.51 11.15 ± 0.83 0.83 ± 0.15 Deep 24.90 ± 2.60 23.22 ± 2.31 15.57 ± 1.90 0.65 ± 0.31 LORETA Surface 33.45 ± 1.16 27.10 ± 1.05 19.31 ± 0.80 8.56 ± 0.29 Middle 32.17 ± 1.23 30.22 ± 1.31 25.43 ± 1.18 10.10 ± 0.56 Deep 29.88 ± 1.92 29.20 ± 1.85 27.32 ± 1.71 13.95 ± 1.53 SLF Surface 8.82 ± 0.66 7.19 ± 0.64 4.93 ± 0.48 2.56 ± 0.16 Middle 8.17 ± 0.72 7.30 ± 0.64 5.27 ± 0.60 2.23 ± 0.23 Deep 7.36 ± 0.77 6.86 ± 0.74 5.99 ± 0.83 2.56 ± 0.62 Table 7 Error measure ED2 for the four inverse algorithms, with regularization, under four different noise levels: 25 dB, 15 dB, 10 dB and 5 dB. Each cell value gives the mean and standard deviation. ED2 Regularised SNR/dB 5 10 15 25 Layer WMN Surface 34.79 ± 1.74 25.88 ± 1.02 17.14 ± 0.71 6.91 ± 0.23 Middle 35.74 ± 1.75 31.41 ± 1.87 25.6 ± 1.30 12.04 ± 0.57 Deep 34.72 ± 2.50 31.14 ± 2.29 25.86 ± 2.32 16.75 ± 1.70 sLORETA Surface 1.02 ± 0.10 0.49 ± 0.08 0.11 ± 0.04 0.00 ± 0.00 Middle 1.62 ± 0.13 0.84 ± 0.11 0.25 ± 0.07 0.00 ± 0.00 Deep 1.80 ± 0.25 0.95 ± 0.16 0.39 ± 0.13 0.00 ± 0.00 LORETA Surface 6.33 ± 0.57 4.56 ± 0.25 3.97 ± 0.16 3.66 ± 0.07 Middle 4.30 ± 0.46 3.16 ± 0.28 2.63 ± 0.20 1.79 ± 0.13 Deep 4.20 ± 0.53 2.71 ± 0.36 2.42 ± 0.33 1.67 ± 0.14 SLF Surface 6.85 ± 0.46 5.79 ± 0.44 4.82 ± 0.31 3.52 ± 0.20 Middle 5.92 ± 0.65 5.38 ± 0.58 4.58 ± 0.46 3.01 ± 0.22 Deep 5.25 ± 0.84 5.03 ± 0.75 4.44 ± 0.75 2.27 ± 0.42
Regularized sLORETA is shown to have the lowest errors both in terms of localization error (ED1) and ghost sources (ED2) (see Figure 6b ). This is consistent with [ ] where sLORETA was proven to have zero localization error for a single source in all noise-free simulations. Furthermore, it can be observed that the error measures and ghost maxima of sLORETA solutions can be reduced considerably when regularization is used – this improvement is particularly marked at large noise levels for ghost sources – see Figure 6 where the results for ED2 for the 5 dB scenario are displayed. Figure 6 Box-whisker diagrams . These show the median (horizontal line within each box), the interquartile range (between the bottom and top of each box) and the range of scores (shown by the whiskers). Circles represent outliers. Plots (a) and (b) show the results for each of the four inverse solutions (horizontal axis) for error measure ED2 with a SNR of 5 dB. (a) shows the results without regularization and (b) shows the results with regularization.
In contrast with the other algorithms studied here, SLF is an iterative method and consequently much more computationally intensive. Table 6 shows that SLF solutions without regularization have the lowest number of ghost sources; this emerges since during the iterative process voxels having a large current density are retained whereas the current density in most other voxels is set to zero. Although unregularized SLF performed better than unreg-ularized sLORETA in terms of ghost sources, unlike SLF, sLORETA benefited greatly from regularization (Table 7 ), reducing its ghost sources to well below those found by regularized SLF.
It is also observed that unregularized LORETA performs badly in terms of ghost sources. However, regularized LORETA is shown to reduce ghost sources considerably and to a level below regularized SLF. Furthermore, Table 5 shows that regularized LORETA solutions also have a lower localization error better than for regularized SLF. Whereas LORETA localization error and ghost sources improve greatly with regularization, WMN and SLF do not seem to benefit appreciably from regularization; in fact, SLF may be slightly worsened with regularization for low noise levels. A notable exception to the improvement of localization error of regularised LORETA occurs for surface sources with low noise levels, namely, 15 dB and 25 dB, in which case a lower error is obtained with unregularized LORETA.
Greater noise levels are expected to result in larger localization errors and ghost sources. All methods studied here have in fact followed this trend with ED1 and ED2 decreasing with higher SNRs.
For WMN and sLORETA, with and without regularization, and the unregularized LORETA, deeper sources tend to have larger localization errors and more ghost sources. Conversely, regularizing the LORETA solution resulted in higher localization errors and more ghost sources for the surface layer. Localization errors and ghost sources of SLF solutions, with or without regularization, do not appear to have a definite trend with source depth – this may be due to border artefacts involved in the SLF iterations which will affect most seriously the surface sources possibly resulting in elevated artefactual errors for the surface sources.
In summary, it can be stated that for single source localization, regularized sLORETA does indeed produce solutions with the lower localization errors and least number of ghost sources; regularization has a marked effect on these results. These statistical results also showed that regularized LORETA is the second best performing algorithm in terms of both performance measures with the exception of surface sources at low noise levels. Therefore, for single source localization, the computational cost of SLF does not yield any additional benefits over the direct methods of sLORETA and LORETA. It should also be recalled that in addition to source localization, LORETA provides source orientation estimates, which are unavailable in sLORETA solutions.
5 Discussion and conclusion
In EEG source analysis, the inverse problem estimates the sources within the brain giving rise to a scalp potential recording. Throughout the years various techniques have been developed to solve the inverse problem for EEG source localization and these techniques fall mainly in two categories: parametric and non parametric. The former estimates the dipole parameters of an a priori determined number of dipoles and the latter estimates the dipole magnitude and orientation of a number of dipoles at fixed positions distributed in the brain volume. Since in non parametric techniques the dipole location is not estimated, such techniques present a linear problem which can be solved by various methods. The non-parametric methods reviewed in this paper include MNE, LORETA, sLORETA, VARETA, S-MAP, ST-MAP, Backus-Gilbert, LAURA, Shrinking LORETA FOCUSS (SLF), SSLOFO and ALF. A series of regularization methods to approximate an ill-posed problem with a family of well-posed problems have also been discussed. On the other hand, the complexity of parametric models varies depending on the a priori chosen number of dipoles. Since in this case a search is made for dipole position, orientation and magnitude which appear non-linearly in the equations, parametric approaches present a non-linear problem. Parametric techniques reviewed in this paper include Beamforming techniques, BESA, subspace techniques such as MUSIC and other methods derived from it, FINES, simulated annealing and computational intelligence algorithms.
Apart from the technical details of the individual algorithms, this paper also provided a performance review of a large number of these algorithms as reported in the literature. From the non parametric techniques, LORETA was shown to give satisfactory results in most cases. However, taking into account reliable biophysical and psychological constraints as done by LAURA for example, was shown to give less localization error than solutions like LORETA. Algorithms such as SSLOFO and ST-MAP have also been developed to capture the temporal information of the individual estimated sources. In environments where there are few sources which are clustered, parametric higher resolution algorithms such as MUSIC give superior performance. Comparative analysis of parametric techniques based on signal subspace decomposition, such as MUSIC, its variants and FINES have been reported in the literature with results showing that FINES is superior in both the noise-free and noisy scenarios.
In addition to this literature review, this paper presented a Monte Carlo analysis of four widely used non parametric inverse solutions: WMN, LORETA, sLORETA and SLF. These solutions were compared at different noise levels and for simulated dipoles at different depths within the brain. Using a three-layer spherical head model, results show that for a single source, regularized sLORETA gives the best performance both in terms of localization error and ghost sources, followed by regularized LORETA. From this one could conclude that for single source localization, the computational cost of SLF does not give any additional benefits over direct methods such as LORETA and sLORETA.
The use of these techniques for EEG (and MEG) source localization in fundamental brain research and direct clinical application is today rapidly evolving. It is used not only in clinical neuroscience, i.e. neurology, psychiatry and psychopharmacology but also in cognitive neuro science research. The analyses for clinical settings differ from those used for research in the developmental neurosciences, as they are concerned largely with the identification and localization of abnormalities in the EEG [ ], and the utilization of this information for neurosurgical interventions in the most severe cases [ , ].
In cognitive neuroscience such techniques have been used to localize the sources of the different frequency bands, to assess the dynamics of different mental states, such as perception, motor preparation and higher cognitive functions [ , ]. In clinical neuroscience source imaging allows the analysis of EEG changes in psychiatric and neurological patients [ , , ] and is extensively used to test and characterize effects of various psychopharmacological agents [ , ].
However, the main clinical application concerns pre-surgical mapping in patients undergoing resection of tumors by allowing for better pre-surgical planning and the localization of epileptic foci as a non-invasive procedure to provide significant source of information for guiding surgical decisions. More specifically, it has been validated for the presurgical evaluation of adult patients suffering from refractory epilepsy [ , , ] and in children with Landau-Kleffner syndrome [ ]. Source localization is even feasible in neonates [ ]. It allows the epileptogenic area to be located and comparisons to be made with clinical information, magnetic resonance imaging (MRI) anatomical data, and the results of metabolic imaging techniques. Finally, another application is in the localization of invariant quantitative EEG (QEEG) correlates of the loss and return of consciousness during anesthesia [ ].
It should be noted that even though source localization has been used in many different domains, it is difficult to validate the accuracy of the results. However, when such validation was attempted on epileptic patients, even though there were some inherent limitations in localization of deep temporal structures, the results have been quite encouraging [ , ].
Appendix
1. The minimization of F α ( x ) = || Kx - y δ || 2 + α || x || 2 leads to xα(δ)δ=(K∗K+αI)−1K∗yδ.
Proof . Taking the derivative of F α and setting to zero to solve for x gives: □ 0=2K∗Kx−2K∗yδ−2αx⇒(K∗K+αI))x=K∗yδ⇒xα(δ)δ=(K∗K+αI)−1K∗yδ.
2. The inverse operators ( K*K + α I ) -1 K* and K* ( KK* + α I ) -1 are equal.
Proof . Assume K is a N × p linear operator. Then □ K∗KK∗+αK∗IN=K∗KK∗+αIpK∗⇒(K∗KK∗+αIN)=(K∗K+αIp)K∗⇒(K∗K+αIp)−1K∗(KK∗+αIN)(KK∗+αIN)−1=(K∗K+αIp)−1(K∗K+αIp)K∗(KK∗+αIN)−1⇒(K∗K+αIp)−1K∗IN=IpK∗(KK∗+αIN)−1⇒(K∗K+αIp)−1K∗=K∗(KK∗+αIN)−1.
3. The solution of the LCMV problem minWTTr{WTCmW} subject to WTG(rdip)=I
is W(rdip)=[G(rdip)TCm−1G(rdip)]−1G(rdip)TCm−1 .
Proof . Let 2 L be a 3 × 3 matrix of Lagrange multipliers. The cost function is added with the inner product of the Lagrange multipliers and the constraint to obtain the Lagrangian L ( W , L ):
L ( W , L ) = Tr { W T C m W + ( W T G - I )2 L }.
Noting that Tr { A } = Tr { A T } for any square matrix A , the above equation can be rewritten as: L(W,L)=Tr{WTCmW+(WTG−I)L+LT(GTW−I)}=Tr{(WT+LTGTCm−1)Cm(W+Cm−1GL)−L−LT−LTGTCm−1GL}.
Only the first term in the brackets is a function of W . The matrix C m is positive definite so the minimum of L ( W , L ) is attained by setting the first term to zero, that is: W=−Cm−1GL. (18)
The Lagrange multiplier matrix L is now obtained by substituting W in the constraint W T G = I to obtain: −LTGTCm−1G=I
or LT=−(GTCm−1G)−1. (19)
Substituting Equation ( 19 ) in Equation ( 18 ) yields the solution: □ W(rdip)=[G(rdip)TCm−1G(rdip)]−1G(rdip)TCm−1.