Introduction
The pharmaceutical industry lags the chemical and petrochemical industries in the use of advanced control and monitoring processes, in part due to the perceived impact of the regulations of manufacturing processes by the Food and Drug Administration and the difficulties associated with processing solid particulate systems [ ]. However, the need for process control and optimization in pharmaceutical manufacturing is clear; the use of effective process management improves process efficiency by reducing downtime and processing costs and increasing product quality and reliability, making the use of extensive online monitoring and optimized process parameters [ ]. With the implementation of initiatives such as Process Analytical Technology (PAT) and Quality by Design (QbD), the pharmaceutical industry is shifting focus to manufacturing processes that can be more closely managed in real time with more advanced process control [ , , ]. These innovative new processes are often small-scale continuous processes, as opposed to the traditional large-scale batch pharmaceutical manufacturing processes that featured very little in terms of automation or control. Continuous processes offer efficient processing rates, reduction in waste, and improving product quality and process reliability. Small-scale processes offer similar benefits, as well as allow for quick product changeover and potential of creating dosage forms of varying dosage amount.
One such small-scale manufacturing process is Dropwise Additive Manufacturing of Pharmaceutical Products (DAMPP), a mini-manufacturing method that deposits active pharmaceutical ingredients (API) directly onto edible substrates using drop-on-demand (DoD) inkjet printing technology [ , ]. The use of DoD technology has many benefits: ease of use, high throughput capability, precise determination of drop size and thus dosage amount, flexibility in terms of printing material and substrate, and safety in dealing with hazardous or potent APIs [ , ]. DAMPP paves the way to the production of individualized medicine, in which the dose is tailored for each individual patient, and could also be used on a larger scale to deposit small amounts of high-potency or hazardous API onto placebo tablets or into capsules.
To address the challenges associated with producing high-quality pharmaceutical products, the DAMPP process allows the application of process control, online monitoring, and fault diagnosis systems. Since the process is small scale, consists of simple unit operations, and involves fluid processing, as opposed to the solid processing used in conventional processes for pharmaceutical solid oral dosage products, the implementation of automation and low-level control for DoD systems is comparatively simpler [ , ]. There are some complexities involved with controlling drop dynamics which require attention and a unique control and monitoring strategy. The formation and behavior of drops are affected greatly by material properties; the surface tension and viscosity of the fluid, in particular, are important to consider in relation to the pressure that is applied to the nozzle [ ]. The viscosity of the drop should be low enough to ensure that a drop will actually eject from the nozzle but high enough that the fluid does not splash out of the nozzle [ ]. The surface tension must be high enough so the fluid does not leak from the nozzle at rest and to ensure the drops form uniformly [ ]. It has been said that the “only way to check the quality of a printing process is by checking the result, as the process itself does not give any direct feedback” [ ]; so in addition to traditional process control, there must be a careful automation strategy and sufficient online monitoring to ensure a quality product. Therefore, DAMPP necessitates an advanced real-time process management (RTPM) strategy, encompassing automation of each unit operation, careful control of process parameters, monitoring of the process and product quality, and an exceptional event management system that detects and diagnoses process faults that are outside of regulatory control.
This paper presents the RTPM strategy developed for the DAMPP system. An automation program makes the unit operations run synchronously, while maintaining the control of equipment and recording the various monitored parameters. The printing material and process temperatures are carefully controlled to maintain consistent material properties and thus predictable drop dynamics, while the process temperature is manipulated to control the product’s final dosage form morphology. Each drop is monitored with a vision system, allowing for the calculation of drop size, storage of the process parameters, drop images, and drop characteristics for each deposited drop. Image capture of each drop also allows for the management of exceptional events. With careful selection of process parameters and printing materials and a successful RTPM strategy, DAMPP allows for precise and accurate control of the dosage amount, composition, phase, morphology, and release profile of the drug, all through monitoring and controlling critical process parameters and critical product quality attributes. Moreover, since each dosage is tracked as it is formed, deviations can be identified and eliminated as they are produced, providing real-time release functionality.
Development of a Real-Time Process Management Strategy
Before implementing an RTPM strategy, it was first necessary to define the Critical Process Parameters (CPPs) and Critical Quality Attributes (CQAs) of the process [ ].
CPPs and CQAs of the process were identified as shown in Table 1 . The two major CQAs of the dosage form are the dosage form morphology and the dosage amount. The CQAs were determined by identifying the key characteristics of a quality dosage form: the API should be deposited in the proper amount for the patient (dosage amount) and in the desired form: amorphous or crystalline (dosage form morphology). For a given formulation, the dosage form morphology can be ensured by controlling the process temperature and the temperature of the product after the drops have been deposited. Temperature control of the process maintains material properties and ensures printability of the fluid, while temperature control of the product affects rate of solidification of melts or evaporation of solvents and thus control over crystallization phenomena. The dosage form morphology and drug’s solid-state behavior can be monitored online using a spectroscopic method such as near-infrared (NIR) or Raman [ ]. By knowing the concentration of the API in the printing fluid, the dosage amount can be determined from the drop volume. It is important to monitor the drop via imaging, not only to calculate the drop volume but also to track the drop’s trajectory and detect any possible faults in the drop formation system. Online Raman or NIR measurements can also be used to confirm API concentration in the solid dosage. Table 1 CQAs and CPPs of DAMPP Critical quality attributes Critical process parameters Dosage form morphology Process temperature Product temperature Dosage amount Drop volume
The RTPM strategy for DAMPP was built around its CPPs and CQAs as shown in Fig. 1 . Fig. 1 RTPM strategy for DAMPP 1. Automation consists of logic programming to drive synchronous execution of all unit operations, including controllers and instruments, and to ensure automatic completion of the entire drop deposition process. 2. Regulatory control is used to maintain the CPPs within a normal operating regime in the presence of common cause variations. 3. A monitoring strategy is needed to ensure that the CQAs of the product are within specifications. It consists of various sensors, online spectroscopy, and imaging equipment. 4. Exceptional events management (EEM) helps to detect and mitigate infrequent failures that may arise during process operations due to special causes. In the context of pharmaceutical dosage manufacturing, this capability insures that production of noncompliant dosage is minimized and any such production immediately isolated.
The components of this RTPM strategy are discussed in the following sections.
Dropwise Additive Manufacturing Process
Manufacturing Equipment
The DAMPP system consists of a drop-on-demand positive displacement pump, xy staging, a camera with a backlight and photosensors, and a hot-air-based heating system. The setup, along with the corresponding controllers, heating apparatuses, and CPU, is shown in Fig. 2 . The system is automated and controlled using LabVIEW 2012. Fig. 2 The entire DAMPP setup
The DAMPP process can print either solvent-based or melt-based pharmaceutical formulations [ , ]. Solvent-based systems include a solvent, polymer, and API while melt-based systems include only polymer and API. Polymers are added to the printing material to help control drug morphology and maintain material rheological properties and the formulation composition [ ].
The drug material is stored in the reservoir and then pumped through an IVEK Digispense 10 single-channel positive displacement pump. The pump is connected to a custom controller that allows for variation in volume strokes and RPM. This controller allows for automatic operation via LabVIEW or manual operation. The size of each drop can be adjusted by using a thumb screw on the pump to change the displacement of the piston within the cylinder in pump. The tubing connected to the inlet and outlet of the pump is Teflon tubing with 1/8″ O.D. and 1/16″ I.D. with corresponding Teflon ferrules and fittings. After passing through the pump and the tubing, the drug material ejects through a nozzle. Teflon or stainless steel nozzles with different diameters (13, 14, 15, 17, 19, or 20 AWG) can be attached to the nozzle holder. The ejected drops are monitored using a Manta G-146B camera-based imaging system with a Banner D10 photoelectric sensor and an XS40-WHI backlight from Spectrum Illumination. The nozzle is positioned over the substrate, which is located on a Newport xy stage that is controlled by a motion controller. The use of the xy staging allows for printing of the material in any desired pattern, including a regular grid. The DAMPP setup is attached to a Newport breadboard with various Newport mounting accessories and plates.
RTPM Equipment
The control and communication system for DAMPP, shown in Fig. 3 , consists of various heating devices and an imaging system to track and control the CPPs and monitor the CQAs. Fig. 3 Control schematic of the DAMPP process. TC temperature controller, TT temperature transmitter, VT vision transmitter, ST spectra transmitter
Temperature control is implemented at several different points within the process. A camera monitors the drop as it is released from the nozzle, allowing for calculation of the drop volume. Although earlier work was done using NIR monitoring of the deposit, work in progress uses Raman spectroscopy for monitoring the solid state and composition of the final dosage product. Each of the CPPs is displayed on the LabVIEW interface and controlled with the LabVIEW automation program.
Maintaining ambient temperature during the process can be sufficient for solvent-based systems, whereas for melt-based systems, the complete system must be maintained at an elevated temperature. Therefore, temperature can be controlled on each process component, including the reservoir, pump, tubing, and nozzle. The reservoir is heated by means of an OMEGALUX heating tape controlled by an Omega iSeries proportional-integral-derivative (PID) controller. The pump can be heated with a pump heating element supplied by IVEK, connected to its own temperature controller. The set point for this temperature controller must be set manually and cannot be controlled via LabVIEW. The temperature of the tubing and the nozzle is controlled via a concentric tube heat exchanger designed for the process. Air is heated by a custom heater connected to an Omega iSeries PID controller. Hot air flows in the shell side, i.e., around the tubing and through the nozzle holder, countercurrent to the fluid flow inside the tubing. This structure maintains the system temperature in order to prevent the melt-based systems from solidifying inside the tubing and on the nozzle.
Both solvent-based systems and melt-based systems utilize substrate temperature control to control the temperature of the deposited drops. The substrate temperature is controlled with two Peltier devices that are placed underneath the substrate, with their own PID controller from TE Technology. An aluminum plate is located on top of the Peltier devices for even heat transfer between the Peltier devices and substrate. The Peltier devices are located on top of two Cooler Master Technology Inc. X Dream 4 CPU air cooler fans in order to allow heat rejection from the Peltier. The cross-shaped heat sink design centralizes the airflow for heat dissipation and allows hot air to exit the cooler in the horizontal direction without interfering with the drop deposition process. For deposit on tablets, a metal tray with precise well dimensions must be used, possibly supplemented with convective cooling using an impinging temperature-controlled air stream.
Automation
A LabVIEW program has been developed for synchronous execution of the pump, staging, and camera and also incorporates the control and monitoring methods discussed previously. This section describes the automation program in detail, including the input variables the user must define, the steps that the program executes, and the outputs of the program. We also present the performance of the automation program, specifically, what manufacturing throughput can be achieved with the use of the program.
Program Inputs
Before starting the DAMPP program, the user must define the inputs as shown in Fig. 4 , which is a screenshot of the program’s user interface after the drop process has begun. Fig. 4 The user interface of the DAMPP LabVIEW program File path—this refers to the file name where the comma-separated values (CSV) output file containing each of the program outputs will be saved. Drop Settings Home position—the starting position of the drop grid pattern. This is variable depending on the substrate’s position on the staging and where the grid pattern will be deposited over the substrate. Number of columns (x)—the program executes a grid pattern of drops. This parameter refers to the number of columns or number of drops in the x direction. Number of rows (y)—similarly, this parameter is the number of rows or the number of drops that deposits in the y direction. Distance between drops—the distance, in millimeters, between each drop space on the grid. The distance must be sufficient so that drops do not coalesce together. Temperature Settings Temperature control—this switch turns the temperature control on or off. For solvent systems, the temperature control may be turned off, and then the process will proceed at ambient conditions. For melt systems, the temperature control should be turned on so that the reservoir, tubing, and substrate temperatures are controlled. Substrate control—this turns the substrate control off or on. Substrate mode—this switches the Peltier devices from being used as either a heating device or a cooling device. Reservoir temperature set point—the temperature, in degree celsius, of the material within the reservoir. This is important for melt systems so the polymer solid will liquefy and become printable. Tubing temperature set point—the temperature, in degree celsius, of the tubing and nozzle. Substrate temperature set point—the temperature, in degree celsius, of the substrate during the drop deposition pattern. Image Settings Image folder—the folder where the drop images will be saved.
Program Description
After the user defines each program parameter and starts the program, it proceeds as shown in Fig. 5 . Fig. 5 The automation process of DAMPP
Program Outputs
Various process parameters, a drop image and image analysis, are saved for each drop. The drop data and image analysis data are written to two separate CSV files. The image analysis methods are discussed in a following section. At the conclusion of the drop deposition process, the output files are merged into one data file. This section details the data that is saved for each drop. Drop data Drop number, calculated by 1 + xi + j where i is the row the drop is located (in the y direction) and j is the column (in the x direction). Time at which the drop deposited. The location of the drop on the stage in the x direction (millimeter). The location of the drop on the stage in the y direction (millimeter). The status of the temperature controller. If the temperature control is turned off, a “0” is saved and if it is on, a “1” is saved. The temperature of the reservoir (degree celsius) at the time of deposition. If the temperature control is turned off, the temperature is recorded as the absolute zero “−273.” The temperature of the tubing (degree celsius) at the time of deposition. If the temperature control is turned off, the temperature is recorded as the absolute zero “−273.” The temperature of the substrate (degree celsius) at the time of deposition. If the temperature control is turned off, the temperature is recorded as the absolute zero “−273.” The power output of the substrate heating devices (as a percentage) Image analysis data Drop volume (microliter) X coordinate of the center of the drop in the image (pixels). Y coordinate of the center of the drop in the image (pixels). File path of the drop image.
An example of the written CSV file is shown below in Fig. 6 . Fig. 6 Screenshot of the DAMPP CSV output file
System Performance
The automation code is designed to reach an optimal production rate with the current equipment. The fastest possible communication with the temperature, pump, and staging controllers is established by operating with the minimum communication times required by the individual controllers.
In order to eliminate the first drop effect in the beginning of each row, the time spent between the deposition of each drop is fixed [ ]. After printing a row in the positive x direction, the staging moves, so the nozzle is positioned over the next row and the system continues printing in the negative x direction. This boustrophedonic movement allows minimizing the time required for the stage movement.
The performance of DAMPP using the LabVIEW automation system is summarized in Table 2 . The time required to initialize the process refers to the time spent before the ejection of the first drop communicating with the controllers and setting the process input parameters by the user. The time is longer for melt-based systems than that for the solvent-based systems due to the added communication time with the temperature controllers. The time spent for the deposition of one drop and recording the data is also shorter for solvent-based systems, which do not require as much temperature control. Table 2 Process performance for different materials Time spent Solvent-based drop deposition Melt-based drop deposition For initialization 5.74 s 9.55 s Per drop 2.24 s per drop 2.64 s per drop
Feedback Control
Although regulatory control is relatively simple to implement on drop-on-demand systems like DAMPP, there are nonetheless challenges that arise [ , ]. Feedback control is based on applying a correction that depends on the deviation between the current measurement of a critical attribute and the desired or set point value of that attribute. Given the fast dynamics of drop formation, the control system is unable to correct for the deviations observed during the drop formation but instead can only apply those corrections to the next drop to be generated. However, by carefully tuning of process parameters to achieve robust operation, it is possible to limit feedback control action to maintain critical attributes within acceptable ranges and reduce the possibility of off-specification product. One aspect of the process that is readily controllable is the environment of the printing process, specifically, the temperature at each point in the process.
In DAMPP, we are controlling the temperature at four locations. We can control the temperature of the process at three points: (1) in the printing material reservoir, (2) in the pump, and (3) throughout the tubing and nozzle in order to control the temperature of the printing material during deposition. We control the temperature of the product at point (4) underneath the substrate to control the product after it has been deposited. Figure 7 shows the points of temperature control in the system. Fig. 7 Points of temperature control in the DAMPP process
Controlling the temperature at points (1)–(3) allows for control of the process temperature while controlling the temperature at point (4) allows for direct control of the resulting dosage form product, by controlling the temperature of the substrate during and after the drops have been deposited.
Process Temperature Control
While depositing solvent-based systems, temperature control is not necessary, but it can be beneficial to minimize temperature effects on fluid properties. It is best to maintain the process at ambient or lower temperatures in order to control solvent evaporation. However, when depositing melts, controlling the temperature of the process is essential for three reasons. First, the polymer must be melted and liquefied, so it is printable. Second, since material properties (specifically, surface tension and viscosity) affect the drop dynamics so greatly, it is important to ensure that the predicted material properties are maintained throughout the process [ ]. Third, temperature of the material needs to be regulated throughout the process to maintain the concentration (mass per volume) of drug within the fluid, as the calculation of the amount of API per drop volume uses this parameter.
The process temperature is currently controlled at three points: the reservoir, the pump, and the tubing. 1. Reservoir temperature control It is important to have a heated fluid reservoir when depositing melt systems in order to melt and hold the polymer system as a liquid. The temperature must be controlled carefully to maintain constant fluid properties and thus have predictable drop dynamics. The temperature of the reservoir at point (1) is controlled using heating tape and a PID controller. The LabVIEW program allows the user to input the temperature set point, and then the program calculates and sets the high and low alarms for the controller based on a user-specified range of acceptable temperatures around the set point. The PID controller can be tuned automatically; this involves the controller cycling the output, measuring the process response, and then calculating and storing the optimal PID values. 2. Pump temperature control It is most important to control the temperature in the pump in order to maintain the printing fluid’s material properties and to ensure that no polymer melt solidifies in the pump. The temperature of the pump at point (2) is controlled via an IVEK-assembled PID controller. This PID controller is also tuned automatically. The temperature set point of this controller is entered manually and is not currently adjusted from LabVIEW. 3. Tubing and Nozzle Temperature Control The temperature of the tubing and nozzle must be controlled in order to maintain material properties and also to prevent the material from solidifying and causing clogging within the tubing. The temperature of the tubing and nozzle at point (3) is controlled using a custom air heater and a PID controller. The control of the tubing is similar to that of the reservoir: the LabVIEW program allows the user to input the temperature set point, and then the program calculates and sets the alarms for the controller. This PID controller is also tuned automatically.
Product Temperature Control
As discussed previously, the printing material, drop size, and substrate all have an effect over the dosage form morphology. Controlling the substrate conditions during and after deposition at point (4) is an additional way to affect the solid’s crystallization and thus ultimately dissolution behavior after it is deposited onto the substrate [ ]. As in traditional crystallization processes, temperature directly influences the crystallization of the API, by affecting both the nucleation rate and crystal growth rate [ ]. When printing solvent formulations, the cooling or heating rate of the dosage form after deposition also affects the evaporation of the solvent. The evaporation of the solvent then affects the liquid composition and thus the nucleation and crystallization rates as well. Therefore, the crystallization behavior of the drug is dependent not only on the melting temperature and glass transition temperature of the API but also on the solvent formulation properties as well, more specifically, the concentration, temperature, and solubility properties of the API in the solvent [ ]. When printing melt formulations, it may be preferable to cool the substrate in order to solidify the drops more rapidly, but the morphology may need to be controlled by reheating the dosage form, possibly in heating/cooling cycle. Therefore, when depositing either solvent-based formulations or melt-based formulations, the temperature of the substrate must be optimized to balance the needs to decrease production time by cooling or heating of the substrate to affect evaporation rate or solidification rate and also heating the substrate to control the drug morphology.
Monitoring Strategy
As mentioned previously, feedback control on a given drop is not possible given the fast dynamics of the printing process. Feedback control can only be applied to subsequent drops. Therefore, it is important to have several methods of monitoring in order to ensure product quality. One way to monitor drops is with imaging.
Imaging each drop that is formed via LabVIEW allows for the monitoring of several aspects of the process. First, it allows the user to closely see each drop throughout the process. Second, it is possible to make several conclusions about the process or product just from an analysis of the drop image. Using the LabVIEW program, the drop volume, and thus amount of drug per drop, can be calculated. The program also calculates the center of the drop within the image, so it is possible to track the drop trajectory. Although this information cannot be used to remedy anything that happened within that drop, the information can then be used in a form of feedback control to adjust future drops to return the process to within desired operating bounds.
The automation program, discussed previously, includes an imaging strategy. First, the image is acquired and saved. Using the acquired image, the volume of the drop is calculated to determine the amount of API depositing onto the substrate. The image can then be analyzed to detect certain process faults, or exceptional events, that may be occurring.
Image Acquisition
A photosensor is used to trigger the camera, so the camera captures an image at the same point in the trajectory for each drop. This allows for a consistent view of the drop and also for comparison between sequential drop images. The triggering of the camera via the photosensors also allows for the camera code to be incorporated into the overall LabVIEW code, but to still run independently of the drop deposition and control codes.
After LabVIEW acquires an image, it displays the image on the program interface and also saves each image file to a user-defined folder. The image is saved with the file name imageX.jpg, where X corresponds to the number iteration of the loop that contains the camera capture code.
Volume Calculation
By calculating each drop volume and knowing the concentration of the printing solution, we can calculate the amount of API in each drop. The volume is found using an “arbitrary rotational symmetric shape model” [ ]. This method generally works well for calculating volumes of drops in flight, as we cannot assume that the drop is a sphere but we can normally assume axial symmetry, as seen in Fig. 8 . However, this method may be inaccurate if the drop is not circular around its axis but is of a different shape, such as ellipsoidal, instead. This can arise with certain types of process faults, such as irregular material deposits at the nozzle tip. Fig. 8 Images of nonuniform drops
This method is based on calculating the diameter in each row or column of pixels in the image and then integrating over the entire drop length to find the volume of the drop in voxels. Essentially, the method assumes that the drop is a stack of several cylinders with different diameters and adds the volume of these cylinders together to find the volume of the whole drop. Then, using a ratio of voxels to volume units, such as microliters or picoliters, for the specific camera system, it is possible to calculate the actual volume of the drop.
Method
After an image is acquired in the LabVIEW program, the program converts the image to an array in order to analyze the contrast of the image on a pixel-by-pixel basis [ ]. Since the image is in grayscale, each pixel is assigned a value 0–255 that represents the darkness of the pixel. The use of the high-intensity backlight creates a high contrast between the drop and the image background, so the drop is mostly dark (low pixel values) and the background is mostly light (high pixel values). If the pixel value is less than a threshold brightness value (typically 80), this denotes a dark pixel that is part of the droplet. An array of Boolean values is created by converting all pixel values less than the threshold to “1” and all other values to “0.”
The program then analyzes each row of pixels to find the diameter of the drop. It finds the index of the first and last instances of a “1” to detect the drop edges. Subtracting these two values gives the diameter of the drop at that row. It is necessary to calculate the diameter this way, rather than just summing the “1” values in the image array, to account for the bright white spot in the center of the image that refracts the backlight. This method essentially “fills in” that spot in the image and then includes it as part of the drop volume.
After finding the diameter of one specific row, the program calculates the cross-sectional area at that row, assuming that the drop is symmetric around the axis and thus the area around the axis is a circle. It then calculates the volume of this slice of the drop in assuming that it is a cylinder with a height of one pixel. It repeats this for each row of the image before summing all of the cylinders’ volumes and calculating the volume of the entire drop in voxels. The volume in voxels is then converted into microliters using the pixel width and pixel height of the camera’s sensor (4.65 μm for the Manta G-146B).
The volume calculated for each drop is recorded in the comma-separated values (CSV) file and also displayed to the user. Besides being able to use the volume calculations to analyze the consistency of drops throughout the process, it is also possible to keep a running total of the total volume deposited. For melt-based formulations, this is equivalent to knowing the total amount of solids deposited on the dosage form, and thus, with the known concentration, it is possible to keep a running total of the amount of drug on the form. However, for solvent-based formulations, it is also necessary to know the density of the printing material in order to deduce the mass of each drop and thus the mass of the solids within the drop.
Validation
To confirm that the volume calculation code was accurate, it was tested on calibration slides provided by GlaxoSmithKline. The calibration slide contains four drops of known volumes. Images were acquired of each drop, shown in Fig. 9 . Fig. 9 An image of a drop on the calibration slide
Then, the image was analyzed using the volume calculation code. As shown in the results in Table 3 , the volume calculation code was extremely accurate, calculating within 0.33 % for three of the four drops. Table 3 Validation of volume calculation code using calibration slides Drop volume on slide (μL) Calculated volume (μL) Percent difference (%) 1.502 1.450 −3.43 3.001 3.011 0.32 2.994 3.003 0.33 6.024 6.044 0.33
The code was also validated gravimetrically with actual drops. A water drop was deposited onto a petri dish and weighed immediately. The mass of the drop was then converted into the volume using the density of the water which was found to be 0.9109 mg per milliliter. This was repeated ten times. The results are shown in Table 4 . Table 4 Validation of volume calculation code using real drops Calculated volume (μL) Actual volume (μL) Percent difference (%) 12.802 13.613 5.96 12.806 13.284 3.60 12.394 12.735 2.68 13.167 12.954 −1.64 12.867 12.844 −0.18 13.381 13.942 4.03 12.939 12.735 −1.60 12.986 13.393 3.04 12.937 13.064 0.97 13.075 12.844 −1.80
The volume calculation code proved to be relatively accurate in calculating the drop volume of real drops as well. Save for the first drop, the code consistently calculated a volume within 4 % of the measured volume. Since the calculation code was extremely precise with the calibration drops, the larger error in these results is attributable to error with weighing. The balance used was only precise within 0.1 mg which is relatively large compared to the mass of a single drop. With both the weighing of the drops and with the density calculation, it is possible that weighing error propagated. It is also important to note that the first few drops deposited can be off-specification due to the “first drop” problem that occurs in drop-on-demand printing [ ].
Exceptional Events Management
Imaging is also beneficial in detecting exceptional events, or process faults that occur as a result of special causes and are separate from expected random deviations in process variables and parameters. Although the automation and control methods mentioned are designed to keep the process within normal operating conditions the majority of the time, if an exceptional event occurs and cannot be quickly mitigated, off-specification product will be produced and thus must be identified, tracked, and isolated. Therefore, it is important to implement an exceptional events management (EEM) framework that can detect, diagnose, and then mitigate these abnormal events, ideally in real time. The EEM framework currently in place on DAMPP detects a set of exceptional events and provides the user with potential diagnoses.
Potential Exceptional Events
Exceptional events generally arise due to three different aspects of the process: deviations in the drop dynamics, malfunctions of the drop-on-demand equipment, or failures of the monitoring or control equipment. The following sections detail each exceptional event, including: Event: How is the process failing? Cause: What caused the failure to occur? Detection: How is the failure noticeable by the user or how could it be recognized automatically? Mitigation strategy: How can the failure be remedied, either automatically or by the user?
This section also contains discussion of how some of the events could be prevented through design, or, if they cannot be prevented completely, how the frequency of occurrence can be diminished. In the prototype, exceptional events are not mitigated automatically; rather, the “mitigation strategies” are displayed as advisory messages to the operator. Some of these automatic alerts associated with specific exceptional events and their potential mitigation are described in the subsequent section.
Drop Dynamics Faults
Ideally, the printing formulation will be chosen carefully, considering not only the final drug product but also the material’s fluid properties. The drop dynamics, including drop generation and the drop deposition onto the surface, can cause failures if the printing fluid is not within the printable range. It is also important to select process parameters before an experiment to ensure predictable drop dynamics. However, if the fluid is not printable or if the process parameters are not chosen correctly, the faults in Table 5 may occur. Table 5 Exceptional events that occur due to drop dynamics Event Cause Detection Mitigation strategy Splashing Printing fluid’s material properties are not within printable range Flow regime is turbulent Tiny droplets emit after drop impacts surface Decrease fluid flow rate Spraying Viscosity is too low Tiny droplets form as opposed to one uniform drop Increase viscosity of fluid Formation of satellite drop Primary drop separates into two visible drops No pinch-off Viscosity is too high Drop elongates from nozzle but does not fall Decrease viscosity of fluid Drops fall while system is at rest Surface tension is too low Drop falls without trigger Increase surface tension of fluid Inconsistent drop generation Improper nozzle size No drop falls with trigger sporadically Switch nozzle size Two drops fall per trigger sporadically
Fortunately, these events are easy to prevent. As long as the user creates a printable fluid formulation and selects the proper process operating conditions, drop dynamics should be predictable and the failures above can be avoided.
Drop-on-Demand System Faults
Even with a printable fluid and proper parameter settings, there can still be failures within the process equipment, either from problems accumulating throughout the process or from the equipment being set up improperly. These faults are summarized in Table 6 . Table 6 Exceptional events that occur due to problems with the drop-on-demand system Event Cause Detection Mitigation strategy Nozzle wetting Solvent evaporation from nozzle tip causing accumulation of solids at tip Drops do not pinch-off Wipe off or switch to new nozzle Fouling at nozzle tip Change in drop trajectory Fouling in tubing Accumulation of solids in system due to improperly mixed solvent-based system Reduction of flow or drop size Adjust printing formulation and reprime system Clogging in tubing Melt solidification in tubing Stopping of flow Ensure all of pump and tubing is heated to the correct temperature Air entrapment Leak in tubing Inconsistent drop size Tighten tubing connections, Low material in reservoir Refill reservoir, prime system Empty printhead reservoir Low or no printing material in reservoir No drop formation Refill reservoir, prime system
While these faults cannot be prevented completely, the probability of occurrence can be reduced through design or proper operating procedure. One easy way to prevent fouling or clogging at the nozzle tip with solvent-based systems is to implement a vapor sheath, which saturates the air surrounding the nozzle with vapor and thus discourages solvent evaporation from the tip [ ]. The occurrence of other events can be minimized by properly mixing the printing fluid, ensuring that the system is heated completely to the right temperature, or assembling the process equipment carefully to insure no air is trapped in the tubing.
Monitoring or Control Equipment Faults
Although the deviations in material properties and drop dynamics can give rise to a number of potential faults, we have found that problems with control equipment generally lead to the highest proportion of faults (57 %) [ ]. Table 7 details the events caused by failures in the control or monitoring equipment. Table 7 Exceptional events that occur due to failures with monitoring and control Event Cause Detection Mitigation strategy Photosensor failure Incorrect distance between sensors No image is taken when drop falls Recalibrate sensors Sensor beam is interrupted Clean sensor surfaces Asynchronous unit operations Program does not have enough delay incorporated for stage movement Drops do not fall in grid pattern Decrease distance between drops Increase delays in program Communication failure with temperature control Program does not have enough delay to allow for sending/receiving data to controllers Set points, alarms, or other setting does not properly set Camera failure Connection issue Black images Check cable connections Lack of communication with any unit operation A unit operation does not run during automatic deposition process Lack of communication with several unit operations LabVIEW issue Communication failure with multiple, or all, unit operations Restart LabVIEW
Detection of Exceptional Events
Using the image of each drop that is acquired by LabVIEW, it is possible to implement various image analysis methods in order to detect exceptional events.
Center of Drop Calculation
One image analysis method that can be used to detect exceptional events is to calculate the center of the drop. Deviations in the center from expected values helps to detect faults that cause a change in trajectory in the drop, such as fouling or clogging at the nozzle tip.
The center of the drop in the y direction is calculated using information from the volume calculation code. The center of each column of pixels is found by averaging the indices of each edge of the drop, or the first and last instance of a “1” in the column of pixels. The center of the entire drop is then found by averaging these centers of each column. The entire array of the grayscale drop image is then transposed, and the process is repeated to find the center of the drop in the x direction.
After the center of the drop is calculated, it is recorded in the output file, displayed to the user on the interface, and shown as a crosshair over the drop image, as seen in Fig. 10 . Fig. 10 A drop image with the crosshair located at the center of the drop
Displaying the center of each drop gives a visual cue to the user on if (and how) the drop trajectory is changing throughout the process.
Comparing Drop Number and Image Number
A second image analysis method is to determine if a drop image does not match up with a triggered drop by comparing the drop number and image number. The LabVIEW program calculates the drop number for each drop that is triggered. For each image captured, a number is assigned to that image before it is saved. However, in certain cases, these numbers may not be the same. By comparing the two numbers, it is possible to detect if there is a mismatch between how many drops have been triggered and how many drops have been imaged.
This can occur when a drop is not triggered but a drop falls, which can indicate inconsistent drop generation. Or, it can occur when a drop is triggered but an image is not taken, which can indicate several potential faults: nozzle wetting, no pinch-off from the nozzle, inconsistent drop generation, clogging in the tubing, an empty reservoir, or a photosensor failure.
If the drop number is less than the image number, this indicates that an additional image has been taken, or a drop has fallen without being triggered by the program. This occurs in faults such as a drop falling while the system is at rest or inconsistent drop generation. If this occurs while the automation program is running, a warning is shown to the user, as seen in Fig. 11 , and the program stops execution. Fig. 11 The warning message shown when a drop falls without being triggered
If the image number is less than the drop number, this means that some fault has occurred to cause an image not being taken of a drop even though it has been triggered. This can happen if the camera is failing somehow, such as in the event of a photosensor failure or camera failure. It can also happen if a drop has triggered but not fallen, such as when there is a clogging in tubing or an empty printhead reservoir. When this event occurs, the program shows the warning message below in Fig. 12 . Fig. 12 The warning message shown when a drop image is not acquired
In the case of a drop image not being acquired, as this could be due to many possible faults, this method can be used to detect the fault but not necessarily diagnose it. Stain detection, an image analysis method that detects potential flaws, can help to further diagnose which event is occurring [ ].
It bears reemphasizing that the additional benefit of the real-time process monitoring system is that not only can deviations be observed, but also, they can be directly associated with individual dosages through the LabVIEW data recording system. Consequently, tablets deviating from required specifications can be tracked, isolated, and rejected, providing a form of real-time release.
Conclusion
Dropwise Additive Manufacturing for Pharmaceutical Products (DAMPP) is a viable system for flexible, on-demand production of dosage forms. The flexibility in adjusting dosage amount makes it attractive as a mini-manufacturing platform for producing dosage for early clinical trials. As a tool for compounding pharmacies, DAMPP could produce individualized doses of drugs with high inter-patient therapeutic variability. The simple unit operations and small scale of the prototype allow for more extensive online monitoring and real-time control than can be provided by the traditional large-scale batch pharmaceutical manufacturing methods. However, the drop-on-demand technology does require the engineering of specific control strategies to ensure a quality product. The real-time process management strategy as described in this paper encompasses temperature control on the reservoir, tubing, pump and substrate, and an image monitoring strategy that allows for imaging of each drop, calculation of drop volume, and determination of the center of drop within the image. The entire process is controlled and automated via LabVIEW, allowing for the recording of the complete set of data that corresponds to each drop deposited. In this manner, the system provides the full provenance of each discrete deposit, and allows for creation of a precise final dosage form by controlling and monitoring each drop. Future additions to the DAMPP RTPM system include addition of online spectroscopic monitoring of the final dosage form in order to further ensure quality of the final product.