Introduction
The production of pharmaceutical tablets involves rigorous specifications concerning the quality of the end product [ ]. It is therefore highly desirable to implement processes that allow for precise control over process specifications in order to produce a high-quality product in an efficient manner. Continuous manufacturing techniques allow for the real-time monitoring of process variables and thus enable stringent process control compliant with quality by design [ ]. Due to the inherent variability in manufacturing pharmaceutical tablets, control strategies are needed. Currently, in pharmaceutical industry, real-time control is gaining increasing interest as it offers advances in product quality and reduction of waste. Advanced control algorithms are not widely used in many cases and with the advent of PC-based software, further exploration of the benefits of advanced control is attractive. The tablet press unit operation is present in all tableting processes; therefore, its ubiquity mandates the development of an effective advanced control strategy.
In process units involved in continuous pharmaceutical manufacturing, proportional integral derivative (PID) control and its variants are the standard methods for process control. While this type of control is fairly robust and can take unmeasured as well as measured disturbances into account, it has several shortcomings. A PID controller may struggle regulating systems with constant perturbations and system constraints if not tuned properly. The tuning of the PIDs directly determines their performance and the tuning factors depend on the underlying system behavior including process parameters. A setup of a robust PID-based strategy requires profound control system designs and process knowledge. Furthermore, manually tuning a PID can be labor intensive and time consuming [ ]. Auto-tuning procedures can help with this process and continue to optimize the controller performance. Models of PID controllers can be generated in both the time and frequency domains. The algorithms for controller design and tuning are varied and take into account integral absolute error (IAE), integral square error (ISE), or integral absolute time error (ITAE) [ ].
Model predictive control (MPC) is a more advanced control strategy that is able to regulate more complex process dynamics, due to its ability to handle complex processes, process interactions, multi-input-multi-output (MIMO) system, and process delay more efficiently. The MPC has been employed widely in the last 30 years in areas such as the petroleum industry and bulk chemical production and has been very successful [ ]. Using an optimization function, the controller determines the magnitude of the measured variable that needs to be sent to the plant, based on all process variables and not solely on a single control loop. The typical MPC has four parameters, the first of which is the control horizon. When an output is determined, the MPC analyzes a set number of the previous output signals and the system response to each output. When the MPC determines the next output, the horizon shifts over by one previous output signal. Depending on the process, a linear or nonlinear MPC can be used. In the case of a linear MPC, a linear time invariant (LTI) model is used to make the prediction of future process response. A LTI model is both linear (the summed and scaled inputs to a system result in corresponding summed and scaled outputs) and time invariant (the output at a time t seconds into the future will be the same as the current output shifted by t seconds). The prediction horizon refers to the number of samples into the future over which the MPC computes the measured variable. The move suppression factor determines the tradeoff between deviation from the set point and movement in the process variables that is the response of the system to a change in the specified set point. The weighing matrix assigns each of the process variables a weight that impacts to what extent they affect the output [ ]. The MPC has several benefits: it can regulate nonlinear systems, account for interactions between process variables, and can deal with significant dead time [ ]. Model identification is often automated in the commercial algorithms and hence implementation can be relatively straight forward. In this work, the performance of an MPC-based control algorithm and PID-based variants shall be investigated.
There are certain scenarios where a PID controller is sufficient and a MPC may not be necessary. Processes that implement PID controllers that have high proportional and derivative constants are generally not rendered more effective under MPC control. If the process dynamics are relatively simple, then the PID controller may have a smaller execution time than the MPC, and is therefore favored. The use of the MPC can be avoided by implementing an advanced version of PID control, such as an adaptive PID controller. Finally, a PID controller is preferable when a process exhibits open-loop instability, such as an exothermic reaction. However, the MPC is more effective than PID control in complex processes where multiple disturbances occur and the signals for process variables need to be decoupled [ ]. The MPC is preferred in the case of MIMO, highly interactive, and dead-time-dominant systems.
In order to further improve the efficacy of a process regulated by the MPC, a combined feedforward/feedback system of regulation can be employed. While feedback control adjusts process variables after they have deviated from the set point, feedforward (FF) control takes corrective actions proactively before disturbances affect the process. It is thus advantageous to implement it in conjunction with the MPC, but it can be implemented with PID-based control strategies as well.
In recent years, the field of advanced control of continuous pharmaceutical processes has seen significant progress. Different levels of control systems suggested for continuous pharmaceutical manufacturing have been proposed in Lee et al. [ ]. Mascia et al. have suggested a control system for an end-to-end continuous pharmaceutical manufacturing process [ ]. Icten et al. have proposed a control system for a continuous pharmaceutical manufacturing involving drop-on-demand (DoD) technology [ ]. The control of a continuous pharmaceutical manufacturing involving a twin-screw hot melt extrusion has been proposed by Baronsky-Probst et al. [ ]. Hsu et al. proposed a feedback control strategy for the roller compactor of a tablet press [ , ]. Myerson et al. stated that feedforward/feedback control is characteristic of continuous manufacturing processes and improves efficacy [ ]. Singh et al. have also demonstrated the benefits of using the combined feedforward/feedback control over feedback control in a process with a tablet press regulated by PID algorithm [ , ]. Jolliffe et al. have modeled and simulated the continuous manufacturing of ibuprofen [ ]. Shi et al. reported using infrared spectroscopy to monitor blend uniformity [ ]. Razavi et al. implemented ultrasound to measure tablet hardness, an important measurement for feedback control [ ]. Singh et al. demonstrated the real-time monitoring of powder bulk density, an important variable for the implementation of a feedforward controller in a continuous tablet manufacturing process [ ].
There has been notable work done to apply advanced MPC to unit operations in tablet production, as well as to processes as a whole. Godoy et al. implemented a constrained latent variable model predictive control technique for trajectory tracking and economic optimization in batch processes [ ]. Sanders et al. showed that MPC control results in a more effective control of a wet-granulation process than PID control [ ]. Mesbah et al. implemented a nonlinear model-based approach to control industrial crystallizers [ ]. Kwon et al. reported using MPC to control the crystallization of proteins [ ]. Dejardin et al. studied the use of a MPC in chromatography to control a moving bed, a counter-current continuous process [ ]. The application of control theory to drying technology has also been studied [ , ]. Sen et al. demonstrated the efficacy of a hybrid MPC-PID simulation over a PID simulation in the processing and purification of active pharmaceutical ingredients [ ]. Rehrl et al. reported the use of a MPC to control a blending unit operation [ ]. Singh et al. demonstrated the efficacy of a hybrid MPC-PID simulation over a PID-regulated simulation in the case of tablet compaction for a tablet press [ ]. Hattou et al. implemented and tested a model gradient predictive controller in real-time application on various chemical reactors in a chemical development plant [ ]. Lauri et al. demonstrated a MPC control strategy with hard constraints on model validity to improve prediction accuracy [ ]. Studies have also focused on the use of a multi-dimensional MPC. Jingyi et al. reported a stable two-time dimensional model predictive controller with zero terminal state constraints for constrained batch processes [ ].
Certain factors make the development of an effective control strategy for a tablet press complicated. Typically, solid pharmaceutical processes reach only 60% of their maximum efficiency and require significantly longer start-up time than liquid processes. The tablet press, among other pharmaceutical unit operations, is not standardized in terms of process control. Therefore, the integration of control hardware, software, and sensors is time consuming. Real-time monitoring of process variables is difficult for a tablet press unit operation. Finally, the ideal control strategy for a tablet press has not been thoroughly evaluated. Because of this, a systematic advanced control strategy for the tablet press has not yet been developed [ ].
A previous work in the field of control strategies for the continuous manufacturing of pharmaceutical products has validated the effectiveness of the discrete components (hybrid MPC-PID control and feedforward control) of the overall control strategy proposed in this work. However, no research has been done on the efficacy of these elements working in an integrated way. The hybrid MPC-PID control strategy has been shown to be superior over other combinations of PID control and MPC. Also, feedforward control has been shown to improve process performance when implemented in conjunction with feedback control. Combining these control strategies should result in a process that is more effective at both proactively (through the feedforward control loop) and retroactively (through the hybrid MPC-PID control strategy) regulating process disturbances than the previous control strategies that have been reported in the literature. The focus of this manuscript is on evaluating the performance of a combined hybrid MPC-PID feedforward/feedback control strategy for a tablet press.
Control Design
Three levels of hierarchical control system have been developed for a tablet press involved in continuous pharmaceutical manufacturing. Level 0 includes the inbuilt control system by manufacturer in unit operation level. Level 1 includes the supervisory PID-based feedback loops and feedforward loops to regulate CQAs. Level 2 includes the advanced supervisory control such as the model predictive control. Level 0 control loops are often operating in a cascade mode with levels 1 and 2 control loops. The implementation of level 2 control loops normally need a distributed control system (e.g., PCS7 (Siemens), DeltaV (Emerson)) while level 0 control loops are normally implemented in programmable logic controller (PLC) panel [ ].
The flowsheet describing the tablet press in Simulink consists of a cascade control system, where two master loops control the variable tablet hardness and tablet weight. These master loops work together to provide the set point for the slave feedback loop, which controls the main compression force applied to the powder blend in the tablet press. In order to accomplish this, actuator values of punch displacement and fill depth are manipulated to control tablet hardness and tablet weight, respectively. In addition, a feedforward loop that monitors powder density contributes to the slave feedback loop. Singh et al. [ ] and Román-Ospino et al. [ ] have previously demonstrated the use of a near-infrared sensor (NIR) to measure bulk powder density. It has been demonstrated in the pilot plant that despite the variations in this input, the sensor is able to return an accurate measurement [ , ]. The transfer functions implemented in the model and their inputs and outputs are presented in the following table.
This manuscript investigates the various control strategies in silico. The aim of this work is to develop an advanced hybrid MPC-PID algorithm based on a combined feedforward/feedback control strategy for a continuous tablet press. The possible control architectures of the tablet press described in the following sections have been compared and evaluated in terms of set-point tracking and disturbance rejection. The first comparison is between a feedback PID control strategy and a hybrid MPC-PID feedback control strategy. The second and main comparison is between a hybrid MPC-PID feedback control strategy and a hybrid MPC-PID feedforward/feedback control strategy (Table 1 ). Table 1 A description of the transfer function models of the process Control loop Input Output Transfer function model Hardness feedback loop Punch displacement Main compression force \( \frac{0.01097}{s^2+0.04563\ast s+0.0009375} \) Hardness feedback loop Main compression force Hardness \( \frac{2.141\ast s+0.1099}{s+0.07601} \) Weight feedback loop Main compression force Tablet weight \( \frac{0.242\ast s+0.9327}{s^2+0.0006876\ast s+0.09156} \) Main compression force feedback loop Fill depth Main compression force \( \frac{0.6706\ast \mathrm{s}+0.008673}{{\mathrm{s}}^2+0.5855\ast \mathrm{s}+0.02293} \) Powder density feedforward loop Powder density Fill depth \( \frac{-18.89\ast {\mathrm{s}}^3-11.14\ast {s}^2-0.48\ast s-0.00175}{0.6706\ast {s}^3+0.136\ast {s}^2+0.00313\ast s+0.00191} \) Powder density feedforward loop Powder density Main compression force \( \frac{18.89\ast s+0.07644}{s^2+0.1906\ast s+0.002205} \)
Classical PID-Based Combined Feedback Control Strategy
The PID controllers coupled with a feedforward controller have been used in this control strategy as shown in Fig. 1 . A master feedback PID loop controls the tablet weight, while another feedback PID loop controls the tablet hardness. These three loops provide the set point for the main compression force, which is controlled by a fourth slave PID feedback loop. The actuator, fill depth, is manipulated by the slave feedback loop to adjust the main compression force. The output, the “main compression force” is inputted to a transfer function model that provides the tablet weight. The tablet hardness has been controlled by manipulating the punch displacement. These loops are highly interactive, and the parameters for each controller were tuned using the built-in toolbox in Simulink. The algorithm employed in Matlab is designed to achieve a balance between controller performance and robustness. An initial controller is designed using a bandwith (output to the process) that achieves this balance, calculated from the open-loop frequency response of the model. The frequency response is the gain and phase of the process for all input frequencies. The frequency response allows the gain and phase margins to be determined, which measure the increase in gain and phase that will cause the process to become unstable. The response time, bandwith, and transient response can then be tuned interactively through the user interface. The inbuilt tuning methodology uses rise time, settling time, overshoot, gain and phase margin, and closed-loop stability to assess the effectiveness of a model. An anti-windup algorithm is also included in the auto-tuning methodology. If the controller output exceeds the upper or lower bound imposed on it, the time derivative of the integral error is set to zero. Once the output is within the bounds, the integral error will be allowed to change once again. The parameters for all PID controllers can be found in the following table. The constants are reported in the following format \( K+ I\ast \frac{1}{s}+ D\ast s \) , which is the same format used in the inbuilt tuning methodology in Simulink (Table 2 ). Fig. 1 Layout of classical PID-based combined feedforward/feedback control strategy Table 2 The parameters for the PID controllers implemented in the classical PID-based control strategy Controller tuning parameters Controller for hardness Controller for weight Controller for main compression force Proportional constant ( K ) 0.00001 mm/kN 0.00622 kN/g 0.0100 mm/kN Integral constant ( I ) 0.00034 s 0.01724 s 0.00786 s Derivative constant ( D ) 0 s 0.3000 s 0.100 s
Advanced Hybrid MPC-PID-Based Combined Feedforward/Feedback Control Strategy
The advanced hybrid MPC-PID feedback control strategy is shown in Fig. 2 . In this control strategy, the two master PID controllers were replaced with a single MPC with two inputs (tablet weight and tablet hardness) and two outputs (main compression force set point and punch displacement). Additionally, the white noise (which models fluctuations in powder density) present in the original simulation has been accounted for as measured disturbances. The MPC block was programmed using the inbuilt process linearization toolbox in Matlab (Mathworks). The first step of this process is to generate a LTI model of the process. To accomplish this, an output error (OE) model was implemented, which bases the MPC design on minimizing the total error for all process variables. This model was then exported to the MPC toolbox of Matlab. The MPC employs a receding horizon control strategy. The sampling time was set at 1 s, the prediction horizon was set at 10 s, and the control horizon was set at 2 s. These are the default parameters in Matlab, which were used after experimentation with the values produced no improvement in controller performance. The state estimation was calculated using the Kalman gain [ ]. The advantage of using a Kalman filter to approximate the controller parameters is that the estimation is based on a series of measurements over time, rather than a single data point. The second step of the process involves tuning the MPC. For this, the inbuilt tuning methodology of the MPC toolbox was used. This methodology implements the ITAE criteria in order to determine the input weights, output weights, and rate weights of the process. The optimization function used consists of the sum of three terms: the weighted sum of the squared deviations in process variables, the weighted sum of the squared changes in controller output, and the weighted sum of the squared deviations in manipulated variables. If there is a large deviation in a process variable, the corresponding output weight is large, which causes the controller to minimize deviations for that variable. Increasing the weight associated with changes in controller output (the weight rate) causes the controller to make smaller, more gradual adjustments. The input weight minimizes deviation from the nominal values of the actuators of the process. The output signals for weight and hardness were combined into a single signal and fed into the MPC block using the mux function block available in Simulink. The mux block combines separate signals into a single signal; the identities of the constituent signals remain separate. The demux function block was applied to the output of the MPC block to separate the signals for weight and hardness, which were then reconnected to their respective feedback loops. The main compression force was controlled using a slave PID controller. Therefore, the proposed control architecture is a hybrid MPC-PID. The remaining PID controller was tuned via the inbuilt tuning methodology in Simulink; for a complete explanation of the tuning process, see “ Classical PID-Based Combined Feedback Control Strategy .” The parameters for this controller are given in Table 3 . Factors such as the response time of the controller were then tuned interactively to achieve the desired responses in the system. Figure 3 shows the hybrid MPC-PID control strategy with the feedforward loop in place. As shown in the figure, the feedforward controller is designed to correct the effect of powder density variation proactively. Fig. 2 Layout of the hybrid MPC-PID feedback control strategy Table 3 PID control parameters under the hybrid MPC-PID-based feedforward/feedback control strategy Controller tuning parameters Controller for main compression force Proportional constant ( P ) 0.00822 mm/kN Integral constant ( I ) 0.01924 s Derivative constant ( D ) 0.30000 s Fig. 3 Layout of the hybrid MPC-PID feedforward/feedback control strategy
Performance Evaluation of the Different Control Strategies
With the emphasis placed on continuous manufacturing of pharmaceuticals by regulatory organizations (e.g., FDA), it is necessary to adapt standards by which to measure the effectiveness of a control strategy for a given process. What follows is an overview of the pertinent criteria to accomplish this.
Root mean square error (RMSE) is based on the square of the error term between set point and output and provides an average value of the deviation from the set point. A smaller value signifies less deviation from the set point and is more desirable than a larger value. An ISE is obtained by integrating the square of the error function. The system eliminates large errors quickly and has a faster response time. However, small errors may persist for a longer time. An IAE is obtained by integrating the absolute value of the error function. Minimizing IAE results not only in a more sluggish response to changes in set point but also less sustained oscillation. ITAE is obtained by integrating the product of time and the error function over time. When this error measurement is applied to tuning a controller, the output settles more quickly and fewer oscillations are observed. However, the initial response of the controller is comparatively slow [ ].
The standards of controller performance discussed above are based on the overall error of the process. There are other measurements that quantify other aspects of the system response, which will now be discussed. Response time measures the rate at which the output of a process responds to a change in the set point of an input. A low response time means that the controller responds quickly to changes in the set point. Decay ratio is a measure of the ratio of the height of successive peaks of the process response. It quantifies how fast the process can reach a steady state, as well as the stability of the process. The lower the decay ratio, the faster the oscillations are decreasing and the more effective the process is at responding to changes in set point and minimizing the impact of disturbances on the output. Settling time quantifies the time needed for the process output to fall within a 2% band of the set point and remain within this band. A small settling time means that the oscillations in the output diminish quickly and steady state is reached rapidly [ ].
The standards described in the previous paragraphs quantify the system response to disturbances and changes in set point. Another critical measurement of controller performance is stability, defined as the tendency to reach a steady state. One method used to evaluate the inherent stability of a system is a root locus plot. The poles and zeros of the closed-loop transfer function of a process are plotted in the complex plane as a function of process gain. For the gain values that render the process unstable, the poles are located in the right half plane. The Nyquist plot is another means of assessing the stability of systems that contain negative feedback loops with respect to frequency. The real and imaginary parts of the transfer function are plotted parametrically as a function of frequency, and analysis of the resulting graph shows the relative number of poles and zeros of the closed-loop transfer function that are in the right half of the s-plane. Since the number of zeros for this function is usually known, the number of poles in the right half plane can be readily calculated. The Bode plot shows the phase and gain of a process as a function of frequency. This allows for the determination of gain and phase margins. These quantities indicate the amount by which gain and phase can be increased so that the process remains stable [ ].
Results and Discussions
Stability Analysis of Control Strategies
The stability of the feedforward/feedback control strategy was ascertained. To accomplish this, Bode plot, root locus plot, and Nyquist plot were constructed for the slave feedback loop. The root locus plot is depicted in Fig. 4a The mathematical transfer function model of this controller indicates three poles and three zeros, therefore the closed-loop transfer function is of third order. One of the poles is observed to be close to zero; therefore, the controller closely exhibits a second-order response. All poles and zeros are in the left-hand side of the grid, indicating that the slave feedback loop is stable. The presence of a conjugate pair of complex zeros indicates oscillations are present. However, these oscillations decay towards the set point instead of being unbounded. Fig. 4 Stability analysis of control strategies. a A root locus plot for the slave feedback loop. b A Bode plot for the slave feedback loop. c A Nyquist plot for the slave feedback loop
The Bode plot (Fig. 4b ) of the closed-loop response of the controller reveals that an increase in frequency causes a decrease in amplitude until the gain is approximately 2 dB. As the frequency increases beyond this point, the gain increases until it reaches an asymptote at 23 dB. This is consistent with the presence of multiple stable poles in the transfer function for the slave feedback loop. The phase response shows values in between −80° and −110° until a frequency of 0.2 rad/s is reached. At this frequency, the phase rapidly increases to 50°, before reaching an asymptote of approximately 5°. The gain and phase margins for this plot have also been analyzed. Since the phase curve is asymptotic to 0°, there is no frequency that corresponds to −180°, the gain margin is infinite. The phase margin is also infinite, since the gain is never 0 dB. Since an acceptable phase margin is 30° and an acceptable gain margin is 2.5 dB, both the gain and phase margins for the controller are good. The Nyquist plot in Fig. 5c encircles negative one on the real axis zero times. Since the open-loop transfer function has no zeros in the right half plane, the closed-loop transfer function has no poles in the right half plane. Therefore, the slave feedback loop is stable. The Nyquist plot also confirms the existence of a pole at the origin, since the plot shows that the contour contains the entire right half plane. This is consistent with the observations made from the root locus plot. Fig. 5 A graph of the set point and output for hardness for the classical PID-based control strategy and the hybrid MPC-PID control strategy
Comparison of the Hybrid MPC-PID Feedback Control Strategy with the Classical PID-Based Feedback Control Strategy
Figure 5 shows the set point for the parameter hardness, as well as the output for hardness of the hybrid MPC-PID feedback control strategy, and the output for hardness of the PID feedback control strategy. In terms of set-point tracking, the output for the hybrid MPC-PID feedback control strategy reaches the set point in less time than the PID feedback control strategy. This effect is especially pronounced when the set point for hardness is increased. This can be accounted for by the effectiveness of both controllers at responding to changes in inputs to the process. In order to measure the disturbance rejection of each control strategy, random white noise was introduced into the signal for powder density. These disturbances manifest themselves as oscillations in the output for process variables and are not due to the design of the controller. For all metrics of deviation (see Table 4 ), the oscillations around the set point are smaller under the hybrid MPC-PID feedback control strategy. The maximum oscillation at steady state for the outputs is approximately 0.3 kp. The open-loop experimental data shows oscillations at steady state of approximately 0.6 kp. Therefore, the oscillation in closed-loop simulation is realistic. The hybrid PID-MPC control strategy is more effective at reducing process disturbances than the PID-only control strategy, where the oscillations are still prevalent. Table 4 Comparison of performance of PID-based feedback control strategy and hybrid MPC-PID feedback control strategy with respect to tablet hardness Control strategy RMSE (kp) ISE (kp 2 s) IAE (kp s) ITAE (kp s 2 ) T2P (s) D2R (s) M2P (kp) PID feedback control strategy 6.5458 85,687 1077.50 535,640 5.00 158.8 1.06 MPC feedback control strategy 0.1461 33.7672 75.5315 51,880 5.00 40.88 0.24
In addition to measurements of error, the time to product (T2P), disturbance to reject (D2R), and magnitude to product (M2P) were calculated. T2P describes the amount of time the disturbance takes to propagate from its source to the product and is detected as a deviation in one or more CQAs. T2P is of practical importance to determine when to divert the nonconforming product if disturbances are detected in CPP upstream in a continuous manufacturing line. D2R gives the length of time for the control system to smooth out the process disturbance or to reach a new set point of CQA. A smaller D2R is expected so that when a process disturbance comes into the system, a smaller amount of nonconforming product will be generated. M2P describes the maximum deviation in the CQAs from the target set point when the process is under manipulation. It is important to restrict the control actions to avoid a large M2P such that the CQAs are within the design space. For numerical values of these measurements, see Table 4 . The D2R of both control strategies is minimal and approximately equal. The larger D2R and M2P for the PID-only control strategy indicate that the hybrid MPC-PID control is superior in minimizing both the duration of a disturbance and its impact on the process.
Comparison of the Hybrid MPC-PID Feedforward/Feedback Control Strategy with the Hybrid MPC-PID Feedback Control Strategy
Figures 6 , 7 , 8 , 9 , and 10 and Tables 5 , 6 , and 7 compare the output for the hybrid MPC-PID feedback-only control strategy with the output for the hybrid MPC-PID feedforward/feedback control strategy. All performance metrics indicates that the feedforward/feedback control strategy outperforms the feedback control strategy in terms of disturbance rejection. This is due to the feedforward control loop proactively mitigating disturbances, in addition to the retroactive corrective action taken by the feedback control loops. Comparing the M2P and D2R for both control strategies confirms that the feedforward/feedback has oscillations that are of smaller magnitude and shorter duration than the feedback-only control strategy. The decay ratio and maximum overshoot for the feedforward/feedback control strategy are also smaller than those of the feedback-only control strategy, indicating a faster response time and settling time. Fig. 6 A graph of the set point for hardness, as well as the outputs for hardness for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy Fig. 7 A graph of the set point for weight, as well as the outputs for main compression force for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy Fig. 8 A graph of the set point for main compression force, as well as the outputs for main compression force for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy Fig. 9 A graph of the outputs for punch displacement for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy Fig. 10 A graph of the outputs for fill depth for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy Table 5 Comparison of performance of hybrid MPC-PID feedback control strategy and hybrid MPC-PID feedforward/feedback control strategy with respect to tablet hardness Control strategy RMSE (kp) ISE (kp 2 s) IAE (kp s) ITAE (kp s 2 ) T2P (s) D2R (s) M2P (kp) Feedback control strategy 0.1461 33.7672 75.5315 51,880 5.00 53.0 0.31 Feedforward/feedback control strategy 0.1447 32.9783 54.2471 29,139 5.00 40.8 0.24 Table 6 Comparison of performance of hybrid MPC-PID feedback control strategy and hybrid MPC-PID feedforward/feedback control strategy with respect to tablet weight Control strategy RMSE (g) ISE (g 2 s) IAE (g s) ITAE (g s 2 ) T2P (s) D2R (s) M2P (g) Feedback control strategy 0.0825 13.5505 65.6850 44,757 5.00 66.5 0.18 Feedforward/feedback control strategy 0.0815 13.2150 51.7782 29,946 5.00 46.3 0.15 Table 7 Comparison of performance of hybrid MPC-PID feedback control strategy and hybrid MPC-PID feedforward/feedback control strategy with respect to main compression force Control strategy RMSE (kN) ISE (kN 2 s) IAE (kN s) ITAE (kN s 2 ) T2P (s) D2R (s) M2P (kN) Feedback control strategy 0.0598 7.0495 31.7606 17,561 4.97 104.1 15.5 Feedforward/feedback control strategy 0.0597 7.0449 30.5315 16,096 5.01 54.3 14.6
It is necessary to examine the dynamics of each process variable in order to evaluate the control strategies. In the case of tablet hardness (see Fig. 6 ), both the output for the feedback-only and feedforward/feedback control strategies react to a change in set-point tracking in the similarly. There is a brief, initial overshoot, followed by a rapid decrease in output, and finally, a gradual rise until the set point is attained. The transient response to the initial step up at time 0 shows greater oscillations than those produced by subsequent changes in set point. Also, while the output of the feedforward/feedback control strategy eventually reaches a constant output, the oscillations in the output of the feedback control strategy persist after decaying for a time. Overall, the oscillations in the output for hardness are much smaller than those that occur in the outputs for weight and main compression force, suggesting that this process variable is less susceptible to disturbances. The maximum closed-loop oscillation at steady state for hardness is approximately 0.1 kp, which is less than the experimental maximum open-loop oscillation in tablet hardness of 0.6 kp. The values of control performance indicators are given in Table 5 that shows that combined control strategy performs better.
In the output for weight (see Fig. 7 ), the feedback-only and feedforward/feedback control strategies differ in the patterns of their oscillations. The output of the feedforward/feedback control strategy shows steady decay of oscillations until the set point is reached. The oscillations in the output for the feedback-only control strategy do not tend towards the set point. Rather, after a period of initial decay, they remain constant. For all set points, the oscillations increase slightly with time after steady state has first been reached. Therefore, the presence of the feedforward loop ensures that nearly all disturbances are eliminated from the process, including the oscillations present at steady state. The response of both outputs to changes in set point is more sluggish than the corresponding response time for hardness, although the overshoot observed follows the same pattern as the overshoot observed for hardness. The maximum magnitude of oscillation for weight at steady state is approximately 0.04 g, which is within the experimental maximum open-loop oscillation of 0.09 g. This means that the simulated oscillations for weight are in agreement with experimental data.
For main compression force (see Fig. 8 ), the oscillations and initial overshoot for both outputs are higher than those for hardness and weight. This is to be expected, since this loop is the actuator for the master feedback loops. Main compression force controls fill depth, and fill depth controls weight. A change in weight indirectly leads to a change in the main compression force. The overshot for the feedforward/feedback control strategy is slightly less than the overshoot for the feedback-only control strategy. When the set point for the main compression force is increased, the output first quickly increases and then decreases in an overshoot and undershoot of equal magnitude. The output then gradually increases to match the set point. In the case of a decrease in the set point, the opposite behavior is observed; undershoot is followed by undershoot, then the output gradually decreases until the set point is attained. As is the case with the previous process variables, oscillations are observed in the steady-state output of the feedback-only control strategy; the disturbances do not propagate to the steady-state output of the feedforward/feedback control strategy. The simulated steady-state closed-loop oscillations for the main compression force are approximately 2.0 kN, while the experimental open-loop oscillations for this process variable are approximately 4.0 kN. The simulated output is therefore realistic and feasible.
Figure 9 shows the output for the actuator punch displacement for the hybrid MPC-PID feedforward/feedback control strategy and the hybrid MPC-PID feedback control strategy. All actuator values are within reasonable ranges. The feedback hybrid MPC-PID control strategy exhibits oscillations of approximately 3.0 mm in punch displacement, while the feedforward/feedback control strategy exhibits oscillations of negligible magnitude. Punch displacement is the actuator that controls tablet hardness. The effect of a disturbance in powder density on hardness output is not as pronounced as the effect on weight and main compression force. Therefore, the presence of the feedforward loop results in smaller oscillations in the punch displacement actuator. Figure 10 displays the output for fill depth for both control strategies. The large intermittent spikes indicate that both control strategies have a high level of sensitivity to disturbances. Overall, the magnitude of the oscillations about the set point is smaller for the feedback control strategy than for the feedforward/feedback control strategy. It is because more changes in fill depth are needed to mitigate the effect of variations in powder bulk density.
Conclusions
The critical role that pharmaceutical products play in society mandates the use of proper control strategies in their production. Accurate control of process variables is necessary to consistently obtain a high-quality product in continuous manufacturing. In this work, control strategies of increasing complexity have been systematically compared based on simulations using a flowsheet that models the control loops of a tablet press.
Currently in industry, control strategies for continuous manufacturing processes are based on various strategies of increasing complexity, some based on empirical functions, some on P, PI, or PID controllers, and few on advanced controls. In the case of tablet production, the most common control strategy is based on cascade controls of the main compression force and tablet weight, together with the hardness control. A hybrid MPC-PID control strategy has been compared with a PID-based control strategy. The results indicate that the hybrid MPC-PID control strategy has a smaller deviation from the set point than the PID-based control strategy. The hybrid MPC-PID control strategy is more effective in regulating disturbances in powder bulk density; therefore, the deviation from the set point for all process variables is smaller than that of the PID-based control strategy.
The results also indicate that a feedforward/feedback hybrid MPC-PID control strategy is superior to a feedback hybrid MPC-PID control strategy. When disturbances were introduced in powder density, the feedback hybrid MPC-PID control strategy showed a higher overall deviation from the set point than the feedforward/feedback hybrid MPC-PID control strategy. The ability of the feedforward/feedback hybrid MPC-PID control strategy to regulate disturbances in powder density makes it more favorable than a feedback hybrid MPC-PID control strategy. Of the control strategies explored, it is the most effective in reducing deviations from the set point for all process variables.
In real-world processes, the decision to implement a particular control strategy over another should not be based solely on the error calculations used in this work. In processes involving only a single control loop, the use of an MPC is often unnecessary unless the process is dead-time dominant, since there are no interactions between multiple process variables that need to be taken into account. Also, if the tolerance for error in a process is large, then a simpler PID controller could be sufficient and a more advanced control strategy such as MPC may not be necessary. MPC requires a mathematical model of a process, which is often difficult and time consuming to generate. On the other hand, the use of a PID controller does not require a process model and optimization tool but it requires more effort to tune it. The implementation of feedforward control is predicated upon being able to accurately measure the input to the process, which can be challenging for some systems. When it is difficult to accurately measure the input, the use of a feedforward loop will not improve process control and a feedback-only control strategy should be implemented.
Simulation of the control strategies in silico allows for the most effective control strategy to be determined. It also provides the appropriate controller tuning parameters needed for implementation into the pilot plant. It gives insight into the possible behavior of the real-world process when the control strategy is used. Therefore, the process simulation is a very important tool for virtual experimentation and to optimize time and resources. Future work will entail implementing this control strategy in the pilot plant and validating the results experimentally.